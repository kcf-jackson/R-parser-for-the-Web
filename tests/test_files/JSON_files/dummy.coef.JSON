[[],["<-","dummy.coef",["function",[{"object":"","...":""}],["UseMethod","\"dummy.coef\""]]],["<-","dummy.coef.lm",["function",[{"object":"","use.na":"FALSE","...":""}],["{",["<-","xl",["$","object","xlevels"]],["if",["!",["length","xl"]],["return",["as.list",["coef","object"]]]],["<-","Terms",["terms","object"]],["<-","tl",["attr","Terms","\"term.labels\""]],["<-","int",["attr","Terms","\"intercept\""]],["<-","facs",["[",["attr","Terms","\"factors\""],["-","1"],{},{"drop":"FALSE"}]],["<-","Terms",["delete.response","Terms"]],["<-","mf",["$","object","model"]],["if",["is.null","mf"],["<-","mf",["model.frame","object"]]],["<-","vars",["[[",["dimnames","facs"],"1"]],["<-","xtlv",["lapply",["[","mf",{},"vars",{"drop":"FALSE"}],"levels"]],["<-","nxl",["pmax",["lengths","xtlv"],"1L"]],["<-","lterms",["apply","facs","2L",["function",[{"x":""}],["prod",["[","nxl",[">","x","0"]]]]]],["<-","nl",["sum","lterms"]],["<-","args",["sapply","vars",["function",[{"i":""}],["if",["==",["[","nxl","i"],"1"],["rep.int","1","nl"],["factor",["rep.int",["[",["[[","xtlv","i"],"1L"],"nl"],{"levels":["[[","xtlv","i"]}]]],{"simplify":"FALSE"}]],["<-","dummy",["do.call","data.frame","args"]],["<-",["names","dummy"],"vars"],["<-","pos","0L"],["<-","rn",["rep.int","tl","lterms"]],["<-","rnn",["character","nl"]],["for","j","tl",["{",["<-","i",["[","vars",[">",["[","facs",{},"j"],"0"]]],["<-","ifac",["[","i",[">",["[","nxl","i"],"1"]]],["<-","lt.j",["[[","lterms","j"]],["if",["==",["length","ifac"],"0L"],["{",["<-",["[","rnn",["+","pos","1L"]],"j"]],["{",["<-","p.j",["+","pos",["seq_len","lt.j"]]],["if",["==",["length","ifac"],"1L"],["{",["<-",["[","dummy","p.j","ifac"],["<-","x.i",["[[","xtlv","ifac"]]],["<-",["[","rnn","p.j"],["as.character","x.i"]]],["{",["<-","tmp",["expand.grid",["[","xtlv","ifac"],{"KEEP.OUT.ATTRS":"FALSE"}]],["<-",["[","dummy","p.j","ifac"],"tmp"],["<-",["[","rnn","p.j"],["apply",["as.matrix","tmp"],"1L","paste",{"collapse":"\":\""}]]]]]],["<-","pos",["+","pos","lt.j"]]]],["<-",["attr","dummy","\"terms\""],["attr","mf","\"terms\""]],["<-","lcontr",["$","object","contrasts"]],["<-","lci",["vapply","dummy","is.factor","NA"]],["<-","lcontr",["[","lcontr",["[",["names","lci"],"lci"]]],["<-","mm",["model.matrix","Terms","dummy","lcontr","xl"]],["if",["anyNA","mm"],["{",["warning","\"some terms will have NAs due to the limits of the method\""],["<-",["[","mm",["is.na","mm"]],"NA"]]],["<-","coef",["$","object","coefficients"]],["if",["!","use.na"],["<-",["[","coef",["is.na","coef"]],"0"]],["<-","asgn",["attr","mm","\"assign\""]],["<-","res",["setNames",["vector","\"list\"",["length","tl"]],"tl"]],["if",["<-","isM",["is.matrix","coef"]],["{",["for","j",["seq_along","tl"],["{",["<-","keep",["which",["==","asgn","j"]]],["<-","cf",["[","coef","keep",{},{"drop":"FALSE"}]],["<-","ij",["==","rn",["[","tl","j"]]],["<-","cf",["if",["any",["<-","na",["is.na","cf"]]],["{",["if",[">=",["ncol","cf"],"2"],["stop","\"multivariate case with missing coefficients is not yet implemented\""]],["<-","rj",["t",["%*%",["[","mm","ij",["[","keep",["!","na"]],{"drop":"FALSE"}],["[","cf",["!","na"]]]]],["<-",["[","rj",["apply",["!=",["[","mm","ij",["[","keep","na"],{"drop":"FALSE"}],"0"],"1L","any"]],"NA"],"rj"],["t",["%*%",["[","mm","ij","keep",{"drop":"FALSE"}],"cf"]]]],["<-",["dimnames","cf"],["list",["colnames","coef"],["[","rnn","ij"]]],["<-",["[[","res","j"],"cf"]]]],["{",["for","j",["seq_along","tl"],["{",["<-","keep",["which",["==","asgn","j"]]],["<-","cf",["[","coef","keep"]],["<-","ij",["==","rn",["[","tl","j"]]],["<-",["[[","res","j"],["if",["any",["<-","na",["is.na","cf"]]],["{",["<-","rj",["setNames",["drop",["%*%",["[","mm","ij",["[","keep",["!","na"]],{"drop":"FALSE"}],["[","cf",["!","na"]]]],["[","rnn","ij"]]],["<-",["[","rj",["apply",["!=",["[","mm","ij",["[","keep","na"],{"drop":"FALSE"}],"0"],"1L","any"]],"NA"],"rj"],["setNames",["drop",["%*%",["[","mm","ij","keep",{"drop":"FALSE"}],"cf"]],["[","rnn","ij"]]]]]]]],["if",[">","int","0"],["<-","res",["c",["list",{"\"(Intercept)\"":["if","isM",["[","coef","int",{}],["[","coef","int"]]}],"res"]]],["structure","res",{"class":"\"dummy_coef\""},{"matrix":"isM"}]]]],["<-","dummy.coef.aovlist",["function",[{"object":"","use.na":"FALSE","...":""}],["{",["<-","xl",["attr","object","\"xlevels\""]],["if",["!",["length","xl"]],["return",["as.list",["coef","object"]]]],["<-","Terms",["terms","object",{"specials":"\"Error\""}]],["<-","err",["-",["$",["attr","Terms","\"specials\""],"Error"],"1"]],["<-","tl",["[",["attr","Terms","\"term.labels\""],["-","err"]]],["<-","int",["attr","Terms","\"intercept\""]],["<-","facs",["[",["attr","Terms","\"factors\""],["-",["c","1",["+","1","err"]]],["-","err"],{"drop":"FALSE"}]],["stopifnot",["==",["length",["names","object"]],["(",["<-","N",["length","object"]]]]],["<-","mf",["$","object","model"]],["if",["is.null","mf"],["<-","mf",["model.frame","object"]]],["<-","vars",["[[",["dimnames","facs"],"1"]],["<-","xtlv",["lapply",["[","mf",{},"vars",{"drop":"FALSE"}],"levels"]],["<-","nxl",["pmax",["lengths","xtlv"],"1L"]],["<-","lterms",["apply","facs","2L",["function",[{"x":""}],["prod",["[","nxl",[">","x","0"]]]]]],["<-","nl",["sum","lterms"]],["<-","args",["setNames",["vector","\"list\"",["length","vars"]],"vars"]],["for","i","vars",["<-",["[[","args","i"],["if",["==",["[[","nxl","i"],"1"],["rep.int","1","nl"],["factor",["rep.int",["[",["[[","xl","i"],"1L"],"nl"],{"levels":["[[","xl","i"]}]]]],["<-","dummy",["do.call","data.frame","args"]],["<-",["names","dummy"],"vars"],["<-","pos","0L"],["<-","rn",["rep.int","tl","lterms"]],["<-","rnn",["character","nl"]],["for","j","tl",["{",["<-","i",["[","vars",[">",["[","facs",{},"j"],"0"]]],["<-","ifac",["[","i",[">",["[","nxl","i"],"1"]]],["<-","lt.j",["[[","lterms","j"]],["if",["==",["length","ifac"],"0L"],["{",["<-",["[","rnn",["+","pos","1L"]],"j"]],["{",["<-","p.j",["+","pos",["seq_len","lt.j"]]],["if",["==",["length","ifac"],"1L"],["{",["<-",["[","dummy","p.j","ifac"],["<-","x.i",["[[","xtlv","ifac"]]],["<-",["[","rnn","p.j"],["as.character","x.i"]]],["{",["<-","tmp",["expand.grid",["[","xtlv","ifac"],{"KEEP.OUT.ATTRS":"FALSE"}]],["<-",["[","dummy","p.j","ifac"],"tmp"],["<-",["[","rnn","p.j"],["apply",["as.matrix","tmp"],"1L","paste",{"collapse":"\":\""}]]]]]],["<-","pos",["+","pos","lt.j"]]]],["<-","form",["paste0","\"~\"",["paste0","tl",{"collapse":"\" + \""}],["if",["!","int"],"\"- 1\""]]],["<-","lcontr",["$","object","contrasts"]],["<-","lci",["vapply","dummy","is.factor","NA"]],["<-","lcontr",["[","lcontr",["[",["names","lci"],"lci"]]],["<-","mm",["model.matrix",["terms",["formula","form"]],"dummy","lcontr","xl"]],["<-","tl",["c","\"(Intercept)\"","tl"]],["<-","res",["setNames",["vector","\"list\"","N"],["names","object"]]],["<-","allasgn",["attr","mm","\"assign\""]],["for","i",["names","object"],["{",["<-","coef",["$",["[[","object","i"],"coefficients"]],["if",["!","use.na"],["<-",["[","coef",["is.na","coef"]],"0"]],["<-","asgn",["$",["[[","object","i"],"assign"]],["<-","uasgn",["unique","asgn"]],["<-","tll",["[","tl",["+","1L","uasgn"]]],["<-","mod",["setNames",["vector","\"list\"",["length","tll"]],"tll"]],["if",["(",["<-","isM",["is.matrix","coef"]]],["{",["for","j","uasgn",["{",["<-","keep",["which",["==","asgn","j"]]],["<-","cf",["[","coef","keep",{},{"drop":"FALSE"}]],["<-","ij",["==","rn",["[","tl","j"]]],["<-","cf",["if",["any",["<-","na",["is.na","cf"]]],["{",["if",[">=",["ncol","cf"],"2"],["stop","\"multivariate case with missing coefficients is not yet implemented\""]],["if",["==","j","0"],["{",["structure",["[","cf",["!","na"]],{"names":"\"(Intercept)\""}]],["{",["<-","rj",["t",["%*%",["[","mm","ij",["[","keep",["!","na"]],{"drop":"FALSE"}],["[","cf",["!","na"]]]]],["<-",["[","rj",["apply",["!=",["[","mm","ij",["[","keep","na"],{"drop":"FALSE"}],"0"],"1L","any"]],"NA"],"rj"]]],["{",["if",["==","j","0"],["structure","cf",{"names":"\"(Intercept)\""}],["t",["%*%",["[","mm","ij","keep",{"drop":"FALSE"}],"cf"]]]]]],["<-",["dimnames","cf"],["list",["colnames","coef"],["[","rnn","ij"]]],["<-",["[[","mod",["[","tl",["+","j","1L"]]],"cf"]]]],["{",["for","j","uasgn",["{",["<-","keep",["which",["==","asgn","j"]]],["<-","cf",["[","coef","keep"]],["<-",["[[","mod",["[","tl",["+","j","1L"]]],["if",["==","j","0"],["{",["structure","cf",{"names":"\"(Intercept)\""}]],["{",["<-","ij",["==","rn",["[","tl",["+","j","1L"]]]],["if",["any",["<-","na",["is.na","cf"]]],["{",["<-","rj",["setNames",["drop",["%*%",["[","mm","ij",["[","keep",["!","na"]],{"drop":"FALSE"}],["[","cf",["!","na"]]]],["[","rnn","ij"]]],["<-",["[","rj",["apply",["!=",["[","mm","ij",["[","keep","na"],{"drop":"FALSE"}],"0"],"1L","any"]],"NA"],"rj"],["setNames",["drop",["%*%",["[","mm","ij",["==","allasgn","j"],{"drop":"FALSE"}],"cf"]],["[","rnn","ij"]]]]]]]]]],["<-",["[[","res","i"],["structure","mod",{"matrix":"isM"}]]]],["structure","res",{"class":"\"dummy_coef_list\""}]]]],["<-","print.dummy_coef",["function",[{"x":"","...":"","title":""}],["{",["<-","terms",["names","x"]],["<-","n",["length","x"]],["<-","isM",["attr","x","\"matrix\""]],["<-","nr.x",["if","isM",["vapply","x","NROW","1L"],["lengths","x"]]],["<-","line","0L"],["if","isM",["{",["<-","ansnrow",["sum",["+","1L","nr.x"]]],["<-","addcol",["-",["max","nr.x"],"1L"]],["<-","nm",["+","addcol",["if","isM",["max",["vapply","x","NCOL","1L"]],"1L"]]],["<-","ans",["matrix","\"\"","ansnrow","nm"]],["<-","rn",["character","ansnrow"]],["for","j",["seq_len","n"],["{",["<-","this",["as.matrix",["[[","x","j"]]],["<-","nr1",["nrow","this"]],["<-","nc1",["ncol","this"]],["<-","dn",["dimnames","this"]],["<-",["dimnames","this"],["list",["if",["is.null",["[[","dn","1"]],["character","nr1"],["[[","dn","1"]],["if",["is.null",["[[","dn","2"]],["character","nc1"],["[[","dn","2"]]]],["if",[">","nc1","1L"],["{",["<-","lin0",["+","line","2L"]],["<-","line",["+",["+","line","nr1"],"1L"]],["<-",["[","ans",["-","lin0","1L"],["+","addcol",["(",[":","1L","nc1"]]]],["colnames","this"]],["<-",["[","ans",[":","lin0","line"],["+","addcol",["(",[":","1L","nc1"]]]],["format","this","..."]],["<-",["[","rn",["-","lin0","1L"]],["paste0",["[","terms","j"],"\":   \""]]],["{",["<-","lin0",["+","line","1L"]],["<-","line",["+","line","nr1"]],["<-",["[","ans",[":","lin0","line"],["+","addcol","1L"]],["format","this","..."]],["<-",["[","rn","lin0"],["paste0",["[","terms","j"],"\":   \""]]]],["if",[">","addcol","0"],["<-",["[","ans",[":","lin0","line"],"addcol"],["rownames","this"]]]]]],["{",["<-","nm",["max","nr.x"]],["<-","ans",["matrix","\"\"",["*","2L","n"],"nm"]],["<-","rn",["character",["*","2L","n"]]],["for","j",["seq_len","n"],["{",["<-","this",["[[","x","j"]],["<-","n1",["length","this"]],["if",[">","n1","1"],["{",["<-","line",["+","line","2L"]],["<-",["[","ans",["-","line","1L"],[":","1L","n1"]],["names","this"]],["<-",["[","ans","line",[":","1L","n1"]],["format","this","..."]],["<-",["[","rn",["-","line","1L"]],["paste0",["[","terms","j"],"\":   \""]]],["{",["<-","line",["+","line","1L"]],["<-",["[","ans","line",[":","1L","n1"]],["format","this","..."]],["<-",["[","rn","line"],["paste0",["[","terms","j"],"\":   \""]]]]]]]],["<-",["dimnames","ans"],["list","rn",["character","nm"]]],["cat",["if",["missing","title"],"\"Full coefficients are\"","title"],"\"\\n\""],["print",["[","ans",[":","1L","line"],{},{"drop":"FALSE"}],{"quote":"FALSE"},{"right":"TRUE"}],["invisible","x"]]]],["<-","print.dummy_coef_list",["function",[{"x":"","...":""}],["{",["for","strata",["names","x"],["print.dummy_coef",["[[","x","strata"],"...",{"title":["paste","\"\\n     Error:\"","strata"]}]],["invisible","x"]]]]]
