[[],["<-","available.packages",["function",[{"contriburl":["contrib.url","repos","type"],"method":"","fields":"NULL","type":["getOption","\"pkgType\""],"filters":"NULL","repos":["getOption","\"repos\""],"ignore_repo_cache":"FALSE","max_repo_cache_age":"","...":""}],["{",["<-","requiredFields",["c",[[":::","tools",".get_standard_repository_db_fields"],{}],"\"File\""]],["if",["is.null","fields"],["<-","fields","requiredFields"],["{",["stopifnot",["is.character","fields"]],["<-","fields",["unique",["c","requiredFields","fields"]]]]],["if",["missing","max_repo_cache_age"],["<-","max_repo_cache_age",["as.numeric",["Sys.getenv","\"R_AVAILABLE_PACKAGES_CACHE_CONTROL_MAX_AGE\"","\"3600\""]]]],["<-","timestamp",["Sys.time",{}]],["<-","res",["matrix","NA_character_","0L",["+",["length","fields"],"1L"],{"dimnames":["list","NULL",["c","fields","\"Repository\""]]}]],["for","repos","contriburl",["{",["<-","localcran",["startsWith","repos","\"file:\""]],["if","localcran",["{",["if",["startsWith","repos","\"file:///\""],["{",["<-","tmpf",["paste0",["substring","repos","8L"],"\"/PACKAGES\""]],["if",["==",["$",".Platform","OS.type"],"\"windows\""],["{",["if",["length",["grep","\"^/[A-Za-z]:\"","tmpf"]],["<-","tmpf",["substring","tmpf","2L"]]]]]],["{",["<-","tmpf",["paste0",["substring","repos","6L"],"\"/PACKAGES\""]]]],["<-","res0",["if",["file.exists",["<-","dest",["paste0","tmpf","\".rds\""]]],["readRDS","dest"],["read.dcf",{"file":"tmpf"}]]],["if",["length","res0"],["<-",["rownames","res0"],["[","res0",{},"\"Package\""]]]],["{",["<-","used_dest","FALSE"],["if","ignore_repo_cache",["{",["<-","dest",["tempfile",{}]]],["{",["<-","dest",["file.path",["tempdir",{}],["paste0","\"repos_\"",["URLencode","repos","TRUE"],"\".rds\""]]],["if",["file.exists","dest"],["{",["<-","age",["difftime","timestamp",["file.mtime","dest"],{"units":"\"secs\""}]],["if",["isTRUE",["<","age","max_repo_cache_age"]],["{",["<-","res0",["readRDS","dest"]],["<-","used_dest","TRUE"],["if",["length","res0"],["<-",["rownames","res0"],["[","res0",{},"\"Package\""]]]],["unlink","dest"]]]]]],["if",["!","used_dest"],["{",["<-","need_dest","FALSE"],["<-","op",["options",{"warn":["-","1L"]}]],["<-","z",["tryCatch",["{",["download.file",{"url":["paste0","repos","\"/PACKAGES.rds\""]},{"destfile":"dest"},{"method":"method"},{"cacheOK":"FALSE"},{"quiet":"TRUE"},{"mode":"\"wb\""}]],{"error":"identity"}]],["options","op"],["if",["!",["inherits","z","\"error\""]],["{",["<-","z",["<-","res0",["tryCatch",["readRDS","dest"],{"error":"identity"}]]],["if","ignore_repo_cache",["unlink","dest"]]]],["if",["inherits","z","\"error\""],["{",["if",["!","ignore_repo_cache"],["<-","need_dest","TRUE"]],["<-","tmpf",["tempfile",{}]],["on.exit",["unlink","tmpf"]],["<-","op",["options",{"warn":["-","1L"]}]],["<-","z",["tryCatch",["{",["download.file",{"url":["paste0","repos","\"/PACKAGES.gz\""]},{"destfile":"tmpf"},{"method":"method"},{"cacheOK":"FALSE"},{"quiet":"TRUE"},{"mode":"\"wb\""}]],{"error":"identity"}]],["if",["inherits","z","\"error\""],["<-","z",["tryCatch",["{",["download.file",{"url":["paste0","repos","\"/PACKAGES\""]},{"destfile":"tmpf"},{"method":"method"},{"cacheOK":"FALSE"},{"quiet":"TRUE"},{"mode":"\"wb\""}]],{"error":"identity"}]]],["options","op"],["if",["!",["inherits","z","\"error\""]],["<-","z",["<-","res0",["tryCatch",["read.dcf",{"file":"tmpf"}],{"error":"identity"}]]]],["unlink","tmpf"],["on.exit",{}]]],["if",["inherits","z","\"error\""],["{",["warning",["gettextf","\"unable to access index for repository %s\"","repos"],"\":\\n  \"",["conditionMessage","z"],{"call.":"FALSE"},{"immediate.":"TRUE"},{"domain":"NA"}],["next"]]],["if",["length","res0"],["{",["<-",["rownames","res0"],["[","res0",{},"\"Package\""]],["if","need_dest",["saveRDS","res0","dest",{"compress":"TRUE"}]]],["if",["!","need_dest"],["{",["unlink","dest"]]]]]]]],["if",["length","res0"],["{",["<-","missingFields",["[","fields",["!",["(",["%in%","fields",["colnames","res0"]]]]]],["if",["length","missingFields"],["{",["<-","toadd",["matrix","NA_character_",{"nrow":["nrow","res0"]},{"ncol":["length","missingFields"]},{"dimnames":["list","NULL","missingFields"]}]],["<-","res0",["cbind","res0","toadd"]]]],["if",["%in%","\"Path\"",["colnames","res0"]],["{",["<-","rp",["rep.int","repos",["nrow","res0"]]],["<-","path",["[","res0",{},"\"Path\""]],["<-",["[","rp",["!",["is.na","path"]]],["paste","repos",["[","path",["!",["is.na","path"]]],{"sep":"\"/\""}]]],["<-","rp","repos"]],["<-","res0",["cbind",["[","res0",{},"fields",{"drop":"FALSE"}],{"Repository":"rp"}]],["<-","res",["rbind","res","res0",{"deparse.level":"0L"}]]]]]],["if",["!",["length","res"]],["return","res"]],["if",["is.null","filters"],["{",["<-","filters",["getOption","\"available_packages_filters\""]],["if",["is.null","filters"],["<-","filters","available_packages_filters_default"]]]],["if",["is.list","filters"],["{",["if",["isTRUE",["$","filters","add"]],["{",["<-",["$","filters","add"],"NULL"],["<-","filters",["c","available_packages_filters_default","filters"]]]]]],["for","f","filters",["{",["if",["!",["length","res"]],["break"]],["if",["is.character","f"],["{",["<-","f",["[[","available_packages_filters_db",["[","f","1L"]]]]],["if",["!",["is.function","f"]],["stop","\"invalid 'filters' argument.\""]],["<-","res",["f","res"]]]],"res"]]],["<-","available_packages_filters_default",["c","\"R_version\"","\"OS_type\"","\"subarch\"","\"duplicates\""]],["<-","available_packages_filters_db",["new.env",{"hash":"FALSE"}]],["<-",["$","available_packages_filters_db","R_version"],["function",[{"db":""}],["{",["<-","depends",["[","db",{},"\"Depends\""]],["<-",["[","depends",["is.na","depends"]],"\"\""],["<-","x",["lapply",["strsplit",["sub","\"^[[:space:]]*\"","\"\"","depends"],"\"[[:space:]]*,[[:space:]]*\""],["function",[{"s":""}],["[","s",["grepl","\"^R[[:space:]]*\\\\(\"","s"]]]]],["<-","lens",["lengths","x"]],["<-","pos",["which",[">","lens","0L"]]],["if",["!",["length","pos"]],["return","db"]],["<-","lens",["[","lens","pos"]],["<-","x",["unlist","x"]],["<-","pat","\"^R[[:space:]]*\\\\(([[<>=!]+)[[:space:]]+(.*)\\\\)[[:space:]]*\""],["<-","ops",["sub","pat","\"\\\\1\"","x"]],["<-","v_t",["split",["sub","pat","\"\\\\2\"","x"],"ops"]],["<-","v_c",["getRversion",{}]],["<-","res",["logical",["length","x"]]],["for","op",["names","v_t"],["<-",["[","res",["==","ops","op"]],["do.call","op",["list","v_c",["[[","v_t","op"]]]]],["<-","ind",["rep.int","TRUE",["NROW","db"]]],["<-",["[","ind","pos"],["sapply",["split","res",["rep.int",["seq_along","lens"],"lens"]],"all"]],["[","db","ind",{},{"drop":"FALSE"}]]]],["<-",["$","available_packages_filters_db","OS_type"],["function",[{"db":""}],["{",["<-","OS_type",["[","db",{},"\"OS_type\""]],["[","db",["|",["is.na","OS_type"],["(",["==","OS_type",["$",".Platform","OS.type"]]]],{},{"drop":"FALSE"}]]]],["<-",["$","available_packages_filters_db","subarch"],["function",[{"db":""}],["{",["<-","current",["$",".Platform","r_arch"]],["if",["!",["nzchar","current"]],["return","db"]],["<-","archs",["[","db",{},"\"Archs\""]],["if",["all",["is.na","archs"]],["return","db"]],["<-","OK",["unlist",["lapply","archs",["function",[{"x":""}],["{",["if",["is.na","x"],["return","TRUE"]],["<-","this",["[[",["strsplit","x","\"[[:space:]]*,[[:space:]]*\""],"1L"]],["%in%","current","this"]]]]]],["[","db","OK",{},{"drop":"FALSE"}]]]],["<-",["$","available_packages_filters_db","duplicates"],["function",[{"db":""}],[[":::","tools",".remove_stale_dups"],"db"]]],["<-","filter_packages_by_depends_predicates",["function",[{"db":"","predicate":"","recursive":"TRUE"}],["{",["<-","db1",["data.frame",{"Package":["[","db",{},"\"Package\""]},{"stringsAsFactors":"FALSE"}]],["<-","fields",["c","\"Depends\"","\"Imports\"","\"LinkingTo\""]],["for","f","fields",["<-",["[[","db1","f"],["lapply",["[","db",{},"f"],[":::","tools",".extract_dependency_package_names"]]]],["<-","all_packages",["unique",["unlist",["[","db1","fields"],{"use.names":"FALSE"}]]],["<-","bad_packages",["[","all_packages",["is.na",["match","all_packages",["$","db1","Package"]]]]],["<-","bad_packages",["setdiff","bad_packages",["unlist",[[":::","tools",".get_standard_package_names"],{}]]]],["<-","ind",["!",["predicate","db"]]],["<-","rdepends",[["::","tools","package_dependencies"],["[",["$","db1","Package"],"ind"],{"db":"db1"},{"reverse":"TRUE"},{"recursive":"recursive"}]],["<-","rdepends",["unique",["unlist","rdepends"]]],["<-",["[","ind",["match","rdepends",["$","db1","Package"],{"nomatch":"0L"}]],"TRUE"],["[","db",["!","ind"],{},{"drop":"FALSE"}]]]],["<-",["$","available_packages_filters_db","`license/FOSS`"],["function",[{"db":""}],["{",["<-","predicate",["function",[{"db":""}],["$",[[":::","tools","analyze_licenses"],["[","db",{},"\"License\""],"db"],"is_verified"]]],["filter_packages_by_depends_predicates","db","predicate"]]]],["<-",["$","available_packages_filters_db","`license/restricts_use`"],["function",[{"db":""}],["{",["<-","predicate",["function",[{"db":""}],["{",["<-","ru",["$",[[":::","tools","analyze_licenses"],["[","db",{},"\"License\""],"db"],"restricts_use"]],["&",["!",["is.na","ru"]],["!","ru"]]]]],["filter_packages_by_depends_predicates","db","predicate"]]]],["<-",["$","available_packages_filters_db","CRAN"],["function",[{"db":""}],["{",["<-","packages",["[","db",{},"\"Package\""]],["<-","dups",["[","packages",["duplicated","packages"]]],["<-","drop",["integer",{}]],["<-","CRAN",["[",["getOption","\"repos\""],"\"CRAN\""]],["if",["is.na","CRAN"],["return","db"]],["for","d","dups",["{",["<-","pos",["which",["==","packages","d"]]],["<-","ind",["!",["startsWith",["[","db","pos","\"Repository\""],"CRAN"]]],["if",["!",["all","ind"]],["<-","drop",["c","drop",["[","pos","ind"]]]]]],["if",["length","drop"],["[","db",["-","drop"],{},{"drop":"FALSE"}],"db"]]]],["<-","simplifyRepos",["function",[{"repos":"","type":""}],["{",["<-","tail",["substring",["contrib.url","\"---\"","type"],"4L"]],["<-","ind",["regexpr","tail","repos",{"fixed":"TRUE"}]],["<-","ind",["ifelse",[">","ind","0L"],["-","ind","1L"],["nchar","repos",{"type":"\"c\""}]]],["substr","repos","1L","ind"]]]],["<-","update.packages",["function",[{"lib.loc":"NULL","repos":["getOption","\"repos\""],"contriburl":["contrib.url","repos","type"],"method":"","instlib":"NULL","ask":"TRUE","available":"NULL","oldPkgs":"NULL","...":"","checkBuilt":"FALSE","type":["getOption","\"pkgType\""]}],["{",["force","ask"],["<-","text.select",["function",[{"old":""}],["{",["<-","update","NULL"],["for","k",["seq_len",["nrow","old"]],["{",["cat",["[","old","k","\"Package\""],"\":\\n\"","\"Version\"",["[","old","k","\"Installed\""],"\"installed in\"",["[","old","k","\"LibPath\""],["if","checkBuilt",["paste","\"built under R\"",["[","old","k","\"Built\""]]],"\"\\n\"","\"Version\"",["[","old","k","\"ReposVer\""],"\"available at\"",["simplifyRepos",["[","old","k","\"Repository\""],"type"]],["cat","\"\\n\""],["<-","answer",["askYesNo","\"Update?\""]],["if",["is.na","answer"],["{",["cat","\"cancelled by user\\n\""],["return",["invisible",{}]]]],["if",["isTRUE","answer"],["<-","update",["rbind","update",["[","old","k",{}]]]]]],"update"]]],["if",["is.null","lib.loc"],["<-","lib.loc",[".libPaths",{}]]],["if",["&&",["==","type","\"both\""],["(",["||",["!",["missing","contriburl"]],["!",["is.null","available"]]]]],["{",["stop","\"specifying 'contriburl' or 'available' requires a single type, not type = \\\"both\\\"\""]]],["if",["is.null","available"],["{",["<-","available",["available.packages",{"contriburl":"contriburl"},{"method":"method"},"..."]],["if",["missing","repos"],["<-","repos",["getOption","\"repos\""]]]]],["if",["&&",["!",["is.matrix","oldPkgs"]],["is.character","oldPkgs"]],["{",["<-","subset","oldPkgs"],["<-","oldPkgs","NULL"]],["<-","subset","NULL"]],["if",["is.null","oldPkgs"],["{",["<-","oldPkgs",["old.packages",{"lib.loc":"lib.loc"},{"contriburl":"contriburl"},{"method":"method"},{"available":"available"},{"checkBuilt":"checkBuilt"}]],["if",["missing","repos"],["<-","repos",["getOption","\"repos\""]]],["if",["!",["is.null","oldPkgs"]],["{",["<-","pkg","0L"],["while",["<","pkg",["nrow","oldPkgs"]],["{",["<-","pkg",["+","pkg","1L"]],["if",["!=",["find.package",["[","oldPkgs","pkg"],{"lib.loc":"lib.loc"}],["find.package",["[","oldPkgs","pkg"],{"lib.loc":["[","oldPkgs","pkg","2"]}]],["{",["warning",["sprintf","\"package '%s' in library '%s' will not be updated\"",["[","oldPkgs","pkg"],["[","oldPkgs","pkg","2"]],{"call.":"FALSE"},{"immediate.":"TRUE"}],["<-","oldPkgs",["[","oldPkgs",["-","pkg"],{},{"drop":"FALSE"}]],["<-","pkg",["-","pkg","1L"]]]]]]]],["if",["is.null","oldPkgs"],["return",["invisible",{}]]]],["if",["!",["(",["&&",["is.matrix","oldPkgs"],["is.character","oldPkgs"]]]],["stop","\"invalid 'oldPkgs'; must be a character vector or a result from old.packages()\""]]],["if",["!",["is.null","subset"]],["{",["<-","oldPkgs",["[","oldPkgs",["%in%",["rownames","oldPkgs"],"subset"],{},{"drop":"FALSE"}]],["if",["==",["nrow","oldPkgs"],"0"],["return",["invisible",{}]]]]],["<-","update",["if",["&&",["is.character","ask"],["==","ask","\"graphics\""]],["{",["if",["||",["||",["==",["$",".Platform","OS.type"],"\"windows\""],["==",["$",".Platform","GUI"],"\"AQUA\""]],["(",["&&",["capabilities","\"tcltk\""],["capabilities","\"X11\""]]]],["{",["<-","k",["select.list",["[","oldPkgs",{},"1L"],["[","oldPkgs",{},"1L"],{"multiple":"TRUE"},{"title":"\"Packages to be updated\""},{"graphics":"TRUE"}]],["[","oldPkgs",["match","k",["[","oldPkgs",{},"1L"]],{},{"drop":"FALSE"}]],["text.select","oldPkgs"]]],["if",["isTRUE","ask"],["text.select","oldPkgs"],"oldPkgs"]]],["if",["length","update"],["{",["if",["is.null","instlib"],["<-","instlib",["[","update",{},"\"LibPath\""]]],["<-","libs",["unique","instlib"]],["for","l","libs",["if",["==","type","'both'"],["install.packages",["[","update",["==","instlib","l"],"\"Package\""],"l",{"repos":"repos"},{"method":"method"},"...",{"type":"type"}],["install.packages",["[","update",["==","instlib","l"],"\"Package\""],"l",{"contriburl":"contriburl"},{"method":"method"},{"available":"available"},"...",{"type":"type"}]]]]]]]],["<-","old.packages",["function",[{"lib.loc":"NULL","repos":["getOption","\"repos\""],"contriburl":["contrib.url","repos","type"],"instPkgs":["installed.packages",{"lib.loc":"lib.loc"},"..."],"method":"","available":"NULL","checkBuilt":"FALSE","...":"","type":["getOption","\"pkgType\""]}],["{",["if",["is.null","lib.loc"],["<-","lib.loc",[".libPaths",{}]]],["if",["!",["missing","instPkgs"]],["{",["if",["||",["!",["is.matrix","instPkgs"]],["!",["is.character",["[","instPkgs",{},"\"Package\""]]]],["stop","\"ill-formed 'instPkgs' matrix\""]]]],["if",["==",["NROW","instPkgs"],"0L"],["return","NULL"]],["<-","available",["if",["is.null","available"],["available.packages",{"contriburl":"contriburl"},{"method":"method"},"..."],[[":::","tools",".remove_stale_dups"],"available"]]],["<-","update","NULL"],["<-","currentR",["<-","minorR",["getRversion",{}]]],["<-",["[[","minorR",["c","1L","3L"]],"0L"],["for","k",[":","1L",["nrow","instPkgs"]],["{",["if",["%in%",["[","instPkgs","k","\"Priority\""],"\"base\""],["next"]],["<-","z",["match",["[","instPkgs","k","\"Package\""],["[","available",{},"\"Package\""]]],["if",["is.na","z"],["next"]],["<-","onRepos",["[","available","z",{}]],["if",["&&",["(",["||",["!","checkBuilt"],[">=",["package_version",["[","instPkgs","k","\"Built\""]],"minorR"]]],["<=",["package_version",["[","onRepos","\"Version\""]],["package_version",["[","instPkgs","k","\"Version\""]]]],["next"]],["<-","deps",["[","onRepos","\"Depends\""]],["if",["!",["is.na","deps"]],["{",["<-","Rdeps",["[[",[[":::","tools",".split_dependencies"],"deps"],"\"R\"",{"exact":"TRUE"}]],["if",[">",["length","Rdeps"],"1L"],["{",["<-","target",["$","Rdeps","version"]],["<-","res",["do.call",["$","Rdeps","op"],["list","currentR","target"]]],["if",["!","res"],["next"]]]]]],["<-","update",["rbind","update",["c",["[","instPkgs","k",["c","\"Package\"","\"LibPath\"","\"Version\"","\"Built\""]],["[","onRepos","\"Version\""],["[","onRepos","\"Repository\""]]]]]],["if",["!",["is.null","update"]],["<-",["colnames","update"],["c","\"Package\"","\"LibPath\"","\"Installed\"","\"Built\"","\"ReposVer\"","\"Repository\""]]],["<-",["rownames","update"],["[","update",{},"\"Package\""]],["[","update",["!",["duplicated","update"]],{},{"drop":"FALSE"}]]]],["<-","new.packages",["function",[{"lib.loc":"NULL","repos":["getOption","\"repos\""],"contriburl":["contrib.url","repos","type"],"instPkgs":["installed.packages",{"lib.loc":"lib.loc"},"..."],"method":"","available":"NULL","ask":"FALSE","...":"","type":["getOption","\"pkgType\""]}],["{","ask",["if",["&&",["==","type","\"both\""],["(",["||",["!",["missing","contriburl"]],["!",["is.null","available"]]]]],["{",["stop","\"specifying 'contriburl' or 'available' requires a single type, not type = \\\"both\\\"\""]]],["if",["is.null","lib.loc"],["<-","lib.loc",[".libPaths",{}]]],["if",["!",["is.matrix","instPkgs"]],["stop",["gettextf","\"no installed packages for (invalid?) 'lib.loc=%s'\"","lib.loc"],{"domain":"NA"}]],["if",["is.null","available"],["<-","available",["available.packages",{"contriburl":"contriburl"},{"method":"method"},"..."]]],["<-","installed",["unique",["[","instPkgs",{},"\"Package\""]]],["<-","poss",["sort",["unique",["[","available",{},"\"Package\""]]]],["<-","res",["setdiff","poss","installed"]],["<-","update",["character",{}]],["<-","graphics","FALSE"],["if",["&&",["is.character","ask"],["==","ask","\"graphics\""]],["{",["<-","ask","TRUE"],["if",["||",["||",["==",["$",".Platform","OS.type"],"\"windows\""],["==",["$",".Platform","GUI"],"\"AQUA\""]],["(",["&&",["capabilities","\"tcltk\""],["capabilities","\"X11\""]]]],["<-","graphics","TRUE"]]]],["if",["isTRUE","ask"],["{",["if",["length","res"],["<-","update",["[","res",["match",["select.list","res",{"multiple":"TRUE"},{"title":"\"New packages to be installed\""},{"graphics":"graphics"}],"res"]]],["message","\"no new packages are available\""]]]],["if",["length","update"],["{",["if",["==","type","\"both\""],["install.packages","update",{"lib":["[","lib.loc","1L"]},{"method":"method"},{"type":"type"},"..."],["install.packages","update",{"lib":["[","lib.loc","1L"]},{"contriburl":"contriburl"},{"method":"method"},{"available":"available"},{"type":"type"},"..."]],["<-","dirs",["list.files",["[","lib.loc","1L"]]],["<-","updated",["[","update",["%in%","update","dirs"]]],["<-","res",["[","res",["!",["%in%","res","updated"]]]]]],"res"]]],["<-",".instPkgFields",["function",[{"fields":""}],["{",["<-","requiredFields",["c",[[":::","tools",".get_standard_repository_db_fields"],{}],"\"Built\""]],["if",["is.null","fields"],["<-","fields","requiredFields"],["{",["stopifnot",["is.character","fields"]],["<-","fields",["unique",["c","requiredFields","fields"]]]]],["[","fields",["!",["%in%","fields",["c","\"Package\"","\"LibPath\""]]]]]]],["<-",".readPkgDesc",["function",[{"lib":"","fields":"","pkgs":["list.files","lib"]}],["{",["<-","ret",["matrix","NA_character_",["length","pkgs"],["+","2L",["length","fields"]]]],["for","i",["seq_along","pkgs"],["{",["<-","pkgpath",["file.path","lib",["[","pkgs","i"]]],["if",["file.access","pkgpath","5L"],["next"]],["if",["file.exists",["<-","file",["file.path","pkgpath","\"Meta\"","\"package.rds\""]]],["{",["<-","md",["try",["readRDS","file"]]],["if",["inherits","md","\"try-error\""],["next"]],["<-","desc",["[",["$","md","DESCRIPTION"],"fields"]],["if",["!",["length","desc"]],["{",["warning",["gettextf","\"metadata of %s is corrupt\"",["sQuote","pkgpath"]],{"domain":"NA"}],["next"]]],["if",["%in%","\"Built\"","fields"],["{",["if",["||",["is.null",["$",["$","md","Built"],"R"]],["!",["(",["%in%","\"Built\"",["names","desc"]]]]],["{",["warning",["gettextf","\"metadata of %s is corrupt\"",["sQuote","pkgpath"]],{"domain":"NA"}],["next"]]],["<-",["[","desc","\"Built\""],["as.character",["$",["$","md","Built"],"R"]]]]],["<-",["[","ret","i",{}],["c",["[","pkgs","i"],"lib","desc"]]]]]],["[","ret",["!",["is.na",["[","ret",{},"1L"]]],{}]]]],["<-","installed.packages",["function",[{"lib.loc":"NULL","priority":"NULL","noCache":"FALSE","fields":"NULL","subarch":["$",".Platform","r_arch"],"...":""}],["{",["if",["is.null","lib.loc"],["<-","lib.loc",[".libPaths",{}]]],["if",["!",["is.null","priority"]],["{",["if",["!",["is.character","priority"]],["stop","\"'priority' must be character or NULL\""]],["if",["any",["<-","b",["%in%","priority","\"high\""]]],["<-","priority",["c",["[","priority",["!","b"]],"\"recommended\"","\"base\""]]]]],["<-","fields",[".instPkgFields","fields"]],["<-","retval",["matrix",["character",{}],"0L",["+","2L",["length","fields"]]]],["for","lib","lib.loc",["{",["if","noCache",["{",["<-","ret0",[".readPkgDesc","lib","fields"]],["if",["length","ret0"],["<-","retval",["rbind","retval","ret0",{"deparse.level":"0L"}]]]],["{",["<-","base",["paste",["c","lib","fields"],{"collapse":"\",\""}]],["<-","enc",["sprintf","\"%d_%s\"",["nchar","base"],[".Call","C_crc64","base"]]],["<-","dest",["file.path",["tempdir",{}],["paste0","\"libloc_\"","enc","\".rds\""]]],["<-","test",["&&",["&&",["file.exists","dest"],[">",["file.mtime","dest"],["file.mtime","lib"]]],["==",["$",["(",["<-","val",["readRDS","dest"]]],"base"],"base"]]],["if",["isTRUE",["as.vector","test"]],["<-","retval",["rbind","retval",["$","val","value"]]],["{",["<-","ret0",[".readPkgDesc","lib","fields"]],["if",["length","ret0"],["{",["<-","retval",["rbind","retval","ret0",{"deparse.level":"0L"}]],["saveRDS",["list",{"base":"base"},{"value":"ret0"}],"dest"]],["unlink","dest"]]]]]]]],[".fixupPkgMat","retval","fields","priority","subarch"]]]],["<-",".fixupPkgMat",["function",[{"mat":"","fields":"","priority":"","subarch":"NULL"}],["{",["<-",["colnames","mat"],["c","\"Package\"","\"LibPath\"","fields"]],["if",["&&",["length","mat"],["!",["is.null","priority"]]],["{",["<-","keep",["!",["is.na",["pmatch",["[","mat",{},"\"Priority\""],"priority",{"duplicates.ok":"TRUE"}]]]],["<-","mat",["[","mat","keep",{},{"drop":"FALSE"}]]]],["if",["&&",["&&",["length","mat"],["!",["is.null","subarch"]]],["nzchar","subarch"]],["{",["<-","archs",["strsplit",["[","mat",{},"\"Archs\""],"\", \"",{"fixed":"TRUE"}]],["<-","keep",["unlist",["lapply","archs",["function",[{"x":""}],["||",["is.na",["[","x","1L"]],["%in%","subarch","x"]]]]]],["<-","mat",["[","mat","keep",{},{"drop":"FALSE"}]]]],["if",["length","mat"],["<-","mat",["[","mat",{},["!=",["colnames","mat"],"\"Archs\""],{"drop":"FALSE"}]]],["if",["length","mat"],["<-",["rownames","mat"],["[","mat",{},"\"Package\""]]],"mat"]]],["<-","remove.packages",["function",[{"pkgs":"","lib":""}],["{",["<-","updateIndices",["function",[{"lib":""}],["{",["if",["&&",["==","lib",".Library"],["==",["$",".Platform","OS.type"],"\"unix\""]],["{",["message","\"Updating HTML index of packages in '.Library'\""],["make.packages.html",".Library"]]],["<-","Rcss",["file.path","lib","\"R.css\""]],["if",["file.exists","Rcss"],["{",["<-","pkgs",["Sys.glob",["file.path","lib","\"*\"","\"Meta\"","\"package.rds\""]]],["if",["!",["length","pkgs"]],["unlink","Rcss"]]]]]]],["if",["!",["length","pkgs"]],["return",["invisible",{}]]],["if",["||",["missing","lib"],["is.null","lib"]],["{",["<-","lib",["[",[".libPaths",{}],"1L"]],["message",["sprintf",["ngettext",["length","pkgs"],"\"Removing package from %s\\n(as %s is unspecified)\"","\"Removing packages from %s\\n(as %s is unspecified)\""],["sQuote","lib"],["sQuote","\"lib\""]],{"domain":"NA"}]]],["<-","paths",["find.package","pkgs","lib"]],["if",["length","paths"],["{",["unlink","paths","TRUE"],["for","lib",["unique",["dirname","paths"]],["updateIndices","lib"]]]],["invisible",{}]]]],["<-","download.packages",["function",[{"pkgs":"","destdir":"","available":"NULL","repos":["getOption","\"repos\""],"contriburl":["contrib.url","repos","type"],"method":"","type":["getOption","\"pkgType\""],"...":""}],["{",["<-","nonlocalcran",["!",["all",["startsWith","contriburl","\"file:\""]]]],["if",["&&","nonlocalcran",["!",["dir.exists","destdir"]]],["stop","\"'destdir' is not a directory\""]],["<-","type",["resolvePkgType","type"]],["if",["is.null","available"],["<-","available",["available.packages",{"contriburl":"contriburl"},{"method":"method"},"..."]]],["<-","retval",["matrix",["character",{}],"0L","2L"]],["for","p",["unique","pkgs"],["{",["<-","ok",["(",["==",["[","available",{},"\"Package\""],"p"]]],["<-","ok",["&","ok",["!",["is.na","ok"]]]],["if",["!",["any","ok"]],["warning",["gettextf","\"no package %s at the repositories\"",["sQuote","p"]],{"domain":"NA"},{"immediate.":"TRUE"}],["{",["if",[">",["sum","ok"],"1L"],["{",["<-","vers",["package_version",["[","available","ok","\"Version\""]]],["<-","keep",["==","vers",["max","vers"]]],["<-",["[","keep",["duplicated","keep"]],"FALSE"],["<-",["[",["[","ok","ok"],["!","keep"]],"FALSE"]]],["if",["startsWith","type","\"mac.binary\""],["<-","type","\"mac.binary\""]],["<-","File",["[","available","ok","\"File\""]],["<-","fn",["paste0","p","\"_\"",["[","available","ok","\"Version\""],["switch","type",{"\"source\"":"\".tar.gz\""},{"\"mac.binary\"":"\".tgz\""},{"\"win.binary\"":"\".zip\""}]]],["<-","have_fn",["!",["is.na","File"]]],["<-",["[","fn","have_fn"],["[","File","have_fn"]],["<-","repos",["[","available","ok","\"Repository\""]],["if",["startsWith","repos","\"file:\""],["{",["if",["startsWith","repos","\"file:///\""],["{",["<-","fn",["paste",["substring","repos","8L"],"fn",{"sep":"\"/\""}]],["if",["==",["$",".Platform","OS.type"],"\"windows\""],["{",["if",["length",["grep","\"^/[A-Za-z]:\"","fn"]],["<-","fn",["substring","fn","2L"]]]]]],["{",["<-","fn",["paste",["substring","repos","6L"],"fn",{"sep":"\"/\""}]]]],["if",["file.exists","fn"],["<-","retval",["rbind","retval",["c","p","fn"]]],["warning",["gettextf","\"package %s does not exist on the local repository\"",["sQuote","p"]],{"domain":"NA"},{"immediate.":"TRUE"}]]],["{",["<-","url",["paste","repos","fn",{"sep":"\"/\""}]],["<-","destfile",["file.path","destdir","fn"]],["<-","res",["try",["download.file","url","destfile","method",{"mode":"\"wb\""},"..."]]],["if",["&&",["!",["inherits","res","\"try-error\""]],["==","res","0L"]],["<-","retval",["rbind","retval",["c","p","destfile"]]],["warning",["gettextf","\"download of package %s failed\"",["sQuote","p"]],{"domain":"NA"},{"immediate.":"TRUE"}]]]]]]]],"retval"]]],["<-","resolvePkgType",["function",[{"type":""}],["{",["if",["==","type","\"both\""],["<-","type","\"source\""],["if",["==","type","\"binary\""],["<-","type",["$",".Platform","pkgType"]]]],"type"]]],["<-","contrib.url",["function",[{"repos":"","type":["getOption","\"pkgType\""]}],["{",["<-","type",["resolvePkgType","type"]],["if",["is.null","repos"],["return","NULL"]],["if",["&&",["%in%","\"@CRAN@\"","repos"],["interactive",{}]],["{",["cat",["gettext","\"--- Please select a CRAN mirror for use in this session ---\""],"\"\\n\"",{"sep":"\"\""}],["flush.console",{}],["chooseCRANmirror",{}],["<-","m",["match","\"@CRAN@\"","repos"]],["<-","nm",["names","repos"]],["<-",["[","repos","m"],["[",["getOption","\"repos\""],"\"CRAN\""]],["if",["is.null","nm"],["<-","nm",["rep.int","\"\"",["length","repos"]]]],["<-",["[","nm","m"],"\"CRAN\""],["<-",["names","repos"],"nm"]]],["if",["%in%","\"@CRAN@\"","repos"],["stop","\"trying to use CRAN without setting a mirror\""]],["<-","ver",["paste",["$","R.version","major"],["[",["[[",["strsplit",["$","R.version","minor"],"\".\"",{"fixed":"TRUE"}],"1L"],"1L"],{"sep":"\".\""}]],["<-","mac.path","\"macosx\""],["if",["==",["substr","type","1L","11L"],"\"mac.binary.\""],["{",["<-","mac.path",["paste","mac.path",["substring","type","12L"],{"sep":"\"/\""}]],["<-","type","\"mac.binary\""]]],["<-","res",["switch","type",{"\"source\"":["paste",["gsub","\"/$\"","\"\"","repos"],"\"src\"","\"contrib\"",{"sep":"\"/\""}]},{"\"mac.binary\"":["paste",["gsub","\"/$\"","\"\"","repos"],"\"bin\"","mac.path","\"contrib\"","ver",{"sep":"\"/\""}]},{"\"win.binary\"":["paste",["gsub","\"/$\"","\"\"","repos"],"\"bin\"","\"windows\"","\"contrib\"","ver",{"sep":"\"/\""}]}]],"res"]]],["<-",".getMirrors",["function",[{"url":"","local.file":"","all":"","local.only":""}],["{",["<-","m","NULL"],["if",["!","local.only"],["{",["<-","f",["tempfile",{}]],["on.exit",["unlink","f"]],["<-","m",["tryCatch",["{",["<-","m",["download.file","url",{"destfile":"f"},{"quiet":"TRUE"}]],["if",["!=","m","0L"],["stop",["gettextf","\"'download.file()' error code '%d'\"","m"]]],["read.csv","f",{"as.is":"TRUE"},{"encoding":"\"UTF-8\""}]],{"error":["function",[{"err":""}],["{",["warning",["gettextf","\"failed to download mirrors file (%s); using local file '%s'\"",["conditionMessage","err"],"local.file"],{"call.":"FALSE"},{"immediate.":"TRUE"}],"NULL"]]}]]]],["if",["is.null","m"],["<-","m",["read.csv","local.file",{"as.is":"TRUE"},{"encoding":"\"UTF-8\""}]]],["if",["!","all"],["<-","m",["[","m",["as.logical",["$","m","OK"]],{}]]],"m"]]],["<-","getCRANmirrors",["function",[{"all":"FALSE","local.only":"FALSE"}],["{",[".getMirrors","\"https://cran.r-project.org/CRAN_mirrors.csv\"",["file.path",["R.home","\"doc\""],"\"CRAN_mirrors.csv\""],{"all":"all"},{"local.only":"local.only"}]]]],["<-",".chooseMirror",["function",[{"m":"","label":"","graphics":"","ind":""}],["{",["if",["&&",["is.null","ind"],["!",["interactive",{}]]],["stop","\"cannot choose a \"","label","\" mirror non-interactively\""]],["if",["length","ind"],["<-","res",["[",["as.integer","ind"],"1L"]],["{",["<-","isHTTPS",["(",["&",["startsWith",["[","m",{},"\"URL\""],"\"https\""],["grepl","\"secure_mirror_from_master\"",["[","m",{},"\"Comment\""],{"fixed":"TRUE"}]]]],["<-","mHTTPS",["[","m","isHTTPS",{}]],["<-","mHTTP",["[","m",["!","isHTTPS"],{}]],["<-","httpsLabel",["paste","\"Secure\"","label","\"mirrors\""]],["<-","httpLabel",["paste","\"Other\"","label","\"mirrors\""]],["<-","m","mHTTPS"],["<-","res",["menu",["c",["[","m",{},"1L"],"\"(other mirrors)\""],"graphics","httpsLabel"]],["if",[">","res",["nrow","m"]],["{",["<-","m","mHTTP"],["<-","res",["menu",["[","m",{},"1L"],"graphics","httpLabel"]]]]]],["if",[">","res","0L"],["{",["<-","URL",["[","m","res","\"URL\""]],["<-",["names","URL"],["[","m","res","\"Name\""]],["sub","\"/$\"","\"\"",["[","URL","1L"]]],["character",{}]]]]],["<-","chooseCRANmirror",["function",[{"graphics":["getOption","\"menu.graphics\""],"ind":"NULL","local.only":"FALSE"}],["{",["<-","m",["getCRANmirrors",{"all":"FALSE"},{"local.only":"local.only"}]],["<-","url",[".chooseMirror","m","\"CRAN\"","graphics","ind"]],["if",["length","url"],["{",["<-","repos",["getOption","\"repos\""]],["<-",["[","repos","\"CRAN\""],"url"],["options",{"repos":"repos"}]]],["invisible",{}]]]],["<-","chooseBioCmirror",["function",[{"graphics":["getOption","\"menu.graphics\""],"ind":"NULL","local.only":"FALSE"}],["{",["<-","m",[".getMirrors","\"https://bioconductor.org/BioC_mirrors.csv\"",["file.path",["R.home","\"doc\""],"\"BioC_mirrors.csv\""],{"all":"FALSE"},{"local.only":"local.only"}]],["<-","url",[".chooseMirror","m","\"BioC\"","graphics","ind"]],["if",["length","url"],["options",{"BioC_mirror":"url"}]],["invisible",{}]]]],["<-","setRepositories",["function",[{"graphics":["getOption","\"menu.graphics\""],"ind":"NULL","addURLs":["character",{}]}],["{",["if",["&&",["is.null","ind"],["!",["interactive",{}]]],["stop","\"cannot set repositories non-interactively\""]],["<-","a",[[":::","tools",".get_repositories"],{}]],["<-","pkgType",["getOption","\"pkgType\""]],["if",["==","pkgType","\"both\""],["<-","pkgType","\"source\""]],["if",["==","pkgType","\"binary\""],["<-","pkgType",["$",".Platform","pkgType"]]],["if",["startsWith","pkgType","\"mac.binary\""],["<-","pkgType","\"mac.binary\""]],["<-","thisType",["[[","a","pkgType"]],["<-","a",["[","a","thisType",[":","1L","3L"]]],["<-","repos",["getOption","\"repos\""]],["if",["&&",["%in%","\"CRAN\"",["row.names","a"]],["!",["is.na",["<-","CRAN",["[","repos","\"CRAN\""]]]]],["<-",["[","a","\"CRAN\"","\"URL\""],"CRAN"]],["<-",["[","a",["(",["%in%",["[[","a","\"URL\""],"repos"]],"\"default\""],"TRUE"],["<-","new",["!",["(",["%in%","repos",["[[","a","\"URL\""]]]]],["if",["any","new"],["{",["<-","aa",["names",["[","repos","new"]]],["if",["is.null","aa"],["<-","aa",["rep.int","\"\"",["length",["[","repos","new"]]]]],["<-",["[","aa",["==","aa","\"\""]],["[",["[","repos","new"],["==","aa","\"\""]]],["<-","newa",["data.frame",{"menu_name":"aa"},{"URL":["[","repos","new"]},{"default":"TRUE"}]],["<-",["row.names","newa"],"aa"],["<-","a",["rbind","a","newa",{"deparse.level":"0L"}]]]],["<-","default",["[[","a","\"default\""]],["<-","res",["if",["length","ind"],["as.integer","ind"],["{",["<-","title",["if","graphics","\"Repositories\"",["gettext","\"--- Please select repositories for use in this session ---\\n\""]]],["match",["select.list",["[","a",{},"1L"],["[","a","default","1L"],{"multiple":"TRUE"},"title",{"graphics":"graphics"}],["[","a",{},"1L"]]]]],["if",["||",["length","res"],["length","addURLs"]],["{",["<-","repos",["[[","a","\"URL\""]],["<-",["names","repos"],["row.names","a"]],["<-","repos",["c",["[","repos","res"],"addURLs"]],["options",{"repos":"repos"}]]]]]],["<-","compareVersion",["function",[{"a":"","b":""}],["{",["if",["is.na","a"],["return",["-","1L"]]],["if",["is.na","b"],["return","1L"]],["<-","a",["as.integer",["[[",["strsplit","a","\"[.-]\""],"1L"]]],["<-","b",["as.integer",["[[",["strsplit","b","\"[.-]\""],"1L"]]],["for","k",["seq_along","a"],["if",["<=","k",["length","b"]],["{",["if",[">",["[","a","k"],["[","b","k"]],["return","1"],["if",["<",["[","a","k"],["[","b","k"]],["return",["-","1L"]]]]],["return","1L"]]],["if",[">",["length","b"],["length","a"]],["return",["-","1L"]],["return","0L"]]]]],["<-",".clean_up_dependencies",["function",[{"x":"","available":"NULL"}],["{",["<-","x",["[","x",["!",["is.na","x"]]]],["if",["!",["length","x"]],["return","x"]],["<-","x",["unlist",["strsplit","x","\",\""]]],["unique",["sub","\"^[[:space:]]*([[:alnum:].]+).*$\"","\"\\\\1\"","x"]]]]],["<-",".clean_up_dependencies2",["function",[{"x":"","installed":"","available":""}],["{",["<-",".split_dependencies",["function",[{"x":""}],["{",["<-",".split2",["function",[{"x":""}],["{",["<-","x",["sub","'[[:space:]]+$'","''","x"]],["<-","x",["unique",["sub","\"^[[:space:]]*(.*)\"","\"\\\\1\"","x"]]],["<-",["names","x"],["sub","\"^([[:alnum:].]+).*$\"","\"\\\\1\"","x"]],["<-","x",["[","x",["!=",["names","x"],"\"R\""]]],["<-","x",["[","x",["nzchar","x"]]],["<-","x",["[","x",["!",["duplicated",["names","x"]]]]],["lapply","x",[":::","tools",".split_op_version"]]]]],["if",["!",["any",["nzchar","x"]]],["return",["list",{}]]],["unlist",["lapply",["strsplit","x","\",\""],".split2"],"FALSE","FALSE"]]]],["<-","x",["[","x",["!",["is.na","x"]]]],["if",["!",["length","x"]],["return",["list",["character",{}],["character",{}]]]],["<-","xx",[".split_dependencies","x"]],["if",["!",["length","xx"]],["return",["list",["character",{}],["character",{}]]]],["<-","pkgs",["[","installed",{},"\"Package\""]],["<-","have",["sapply","xx",["function",[{"x":""}],["{",["if",["==",["length","x"],"3L"],["{",["if",["!",["%in%",["[[","x","1L"],"pkgs"]],["return","FALSE"]],["if",["!=",["[[","x","2L"],"\">=\""],["return","TRUE"]],["<-","current",["as.package_version",["[","installed",["==","pkgs",["[[","x","1L"]],"\"Version\""]]],["<-","target",["as.package_version",["[[","x","3L"]]],["any",["do.call",["$","x","op"],["list","current","target"]]]],["%in%",["[[","x","1L"],"pkgs"]]]]]],["<-","xx",["[","xx",["!","have"]]],["if",["!",["length","xx"]],["return",["list",["character",{}],["character",{}]]]],["<-","pkgs",["row.names","available"]],["<-","canget",["<-","miss",["character",{}]]],["for","i",["seq_along","xx"],["{",["<-","x",["[[","xx","i"]],["if",["==",["length","x"],"3L"],["{",["if",["!",["%in%",["[[","x","1L"],"pkgs"]],["{",["<-","miss",["c","miss",["[[","x","1L"]]],["next"]]],["if",["!=",["[[","x","2L"],"\">=\""],["{",["<-","canget",["c","canget",["[[","x","1L"]]],["next"]]],["<-","current",["as.package_version",["[","available",["==","pkgs",["[[","x","1L"]],"\"Version\""]]],["<-","target",["as.package_version",["[[","x","3L"]]],["<-","res",["any",["do.call",["$","x","op"],["list","current","target"]]]],["if","res",["<-","canget",["c","canget",["[[","x","1L"]]],["<-","miss",["c","miss",["paste0",["[[","x","1L"],"\" (>= \"",["[[","x","3L"],"\")\""]]]]],["if",["%in%",["[[","x","1L"],"pkgs"],["<-","canget",["c","canget",["[[","x","1L"]]],["<-","miss",["c","miss",["[[","x","1L"]]]]]]],["list","canget","miss"]]]],["<-",".make_dependency_list",["function",[{"pkgs":"","available":"","dependencies":["c","\"Depends\"","\"Imports\"","\"LinkingTo\""],"recursive":"FALSE"}],["{",["if",["!",["length","pkgs"]],["return","NULL"]],["if",["is.null","available"],["stop",["gettextf","\"%s must be supplied\"",["sQuote","\"available\""]],{"domain":"NA"}]],["<-","info",["[","available","pkgs","dependencies",{"drop":"FALSE"}]],["<-","x",["vector","\"list\"",["length","pkgs"]]],["<-",["names","x"],"pkgs"],["if","recursive",["{",["<-","known",["row.names","available"]],["<-","xx",["vector","\"list\"",["length","known"]]],["<-",["names","xx"],"known"],["<-","info2",["[","available",{},"dependencies",{"drop":"FALSE"}]],["for","i",["seq_along","known"],["<-",["[[","xx","i"],[".clean_up_dependencies",["[","info2","i",{}]]]],["for","i","pkgs",["{",["<-","p",["[[","xx","i"]],["<-","p",["[","p",["%in%","p","known"]]],["<-","p1","p"],["repeat",["{",["<-","extra",["unlist",["[","xx","p1"]]],["<-","extra",["[","extra",["!=","extra","i"]]],["<-","extra",["[","extra",["%in%","extra","known"]]],["<-","deps",["unique",["c","p","extra"]]],["if",["<=",["length","deps"],["length","p"]],["break"]],["<-","p1",["[","deps",["!",["%in%","deps","p"]]]],["<-","p","deps"]]],["<-",["[[","x","i"],"p"]]]],["{",["for","i",["seq_along","pkgs"],["<-",["[[","x","i"],[".clean_up_dependencies",["[","info","i",{}]]]]]],"x"]]],["<-",".find_install_order",["function",[{"pkgs":"","dependencyList":""}],["{",["<-","DL",["[","dependencyList","pkgs"]],["<-","DL",["lapply","DL",["function",[{"x":""}],["[","x",["%in%","x","pkgs"]]]]],["<-","lens",["lengths","DL"]],["if",["all",[">","lens","0L"]],["{",["warning","\"every package depends on at least one other\""],["return","pkgs"]]],["<-","done",["names",["[","DL",["==","lens","0L"]]]],["<-","DL",["[","DL",[">","lens","0L"]]],["while",["length","DL"],["{",["<-","OK",["vapply","DL",["function",[{"x":""}],["all",["%in%","x","done"]]],"NA"]],["if",["!",["any","OK"]],["{",["warning",["gettextf","\"packages %s are mutually dependent\"",["paste",["sQuote",["names","DL"]],{"collapse":"\", \""}]],{"domain":"NA"}],["return",["c","done",["names","DL"]]]]],["<-","done",["c","done",["names",["[","DL","OK"]]]],["<-","DL",["[","DL",["!","OK"]]]]],"done"]]]]
