[[],["<-","read.dcf",["function",[{"file":"","fields":"NULL","all":"FALSE","keep.white":"NULL"}],["{",["if",["is.character","file"],["{",["<-","file",["gzfile","file"]],["on.exit",["close","file"]]]],["if",["!",["inherits","file","\"connection\""]],["stop","\"'file' must be a character string or connection\""]],["if",["!","all"],["return",[".Internal",["readDCF","file","fields","keep.white"]]]],["<-",".assemble_things_into_a_data_frame",["function",[{"tags":"","vals":"","nums":""}],["{",["<-","tf",["factor","tags",{"levels":["unique","tags"]}]],["<-","cnts",["table","nums","tf"]],["<-","out",["array","NA_character_",{"dim":["dim","cnts"]},{"dimnames":["list","NULL",["levels","tf"]]}]],["if",["all",["<=","cnts","1L"]],["{",["<-",["[","out",["cbind","nums","tf"]],"vals"],["<-","out",["as.data.frame","out",{"stringsAsFactors":"FALSE"}]]],["{",["<-","levs",["==",["colSums",[">","cnts","1L"]],"0L"]],["if",["any","levs"],["{",["<-","inds",["%in%","tf",["[",["levels","tf"],"levs"]]],["<-",["[","out",["cbind",["[","nums","inds"],["[","tf","inds"]]],["[","vals","inds"]]]],["<-","out",["as.data.frame","out",{"stringsAsFactors":"FALSE"}]],["for","l",["[",["levels","tf"],["!","levs"]],["{",["<-",["[[","out","l"],["rep.int",["list","NA_character_"],["nrow","cnts"]]],["<-","i",["==","tf","l"]],["<-",["[",["[[","out","l"],["unique",["[","nums","i"]]],["split",["[","vals","i"],["[","nums","i"]]]]]]],"out"]]],["<-","ctype",["Sys.getlocale","\"LC_CTYPE\""]],["on.exit",["Sys.setlocale","\"LC_CTYPE\"","ctype"],{"add":"TRUE"}],["Sys.setlocale","\"LC_CTYPE\"","\"C\""],["<-","lines",["readLines","file",{"skipNul":"TRUE"}]],["<-","ind",["grep","\"^[^[:blank:]][^:]*$\"","lines"]],["if",["length","ind"],["{",["<-","lines",["strtrim",["[","lines","ind"],["*","0.7",["getOption","\"width\""]]]],["stop",["gettextf","\"Invalid DCF format.\\nRegular lines must have a tag.\\nOffending lines start with:\\n%s\"",["paste0","\"  \"","lines",{"collapse":"\"\\n\""}]],{"domain":"NA"}]]],["<-","line_is_not_empty",["!",["grepl","\"^[[:space:]]*$\"","lines"]]],["<-","nums",["cumsum",[">",["diff",[">",["c","FALSE","line_is_not_empty"],"0L"]],"0L"]]],["<-","nums",["[","nums","line_is_not_empty"]],["<-","lines",["[","lines","line_is_not_empty"]],["<-","line_is_escaped_blank",["grepl","\"^[[:space:]]+\\\\.[[:space:]]*$\"","lines"]],["if",["any","line_is_escaped_blank"],["<-",["[","lines","line_is_escaped_blank"],"\"\""]],["<-","line_has_tag",["grepl","\"^[^[:blank:]][^:]*:\"","lines"]],["<-","pos",["+",["which",[">",["diff","nums"],"0L"]],"1L"]],["<-","ind",["!",["[","line_has_tag","pos"]]],["if",["any","ind"],["{",["<-","lines",["strtrim",["[","lines",["[","pos","ind"]],["*","0.7",["getOption","\"width\""]]]],["stop",["gettextf","\"Invalid DCF format.\\nContinuation lines must not start a record.\\nOffending lines start with:\\n%s\"",["paste0","\"  \"","lines",{"collapse":"\"\\n\""}]],{"domain":"NA"}]]],["<-","lengths",["$",["rle",["cumsum","line_has_tag"]],"lengths"]],["<-","pos",["cumsum","lengths"]],["<-","tags",["sub","\":.*\"","\"\"",["[","lines","line_has_tag"]]],["<-",["[","lines","line_has_tag"],["sub","\"[^:]*:[[:space:]]*\"","\"\"",["[","lines","line_has_tag"]]],["<-","fold",["is.na",["match","tags","keep.white"]]],["<-","foldable",["rep.int","fold","lengths"]],["<-",["[","lines","foldable"],["sub","\"^[[:space:]]*\"","\"\"",["[","lines","foldable"]]],["<-",["[","lines","foldable"],["sub","\"[[:space:]]*$\"","\"\"",["[","lines","foldable"]]],["<-","vals",["mapply",["function",[{"from":"","to":""}],["paste",["[","lines",[":","from","to"]],{"collapse":"\"\\n\""}]],["c","1L",["+",["[","pos",["-",["length","pos"]]],"1L"]],"pos"]],["<-",["[","vals","fold"],["trimws",["[","vals","fold"]]],["<-","out",[".assemble_things_into_a_data_frame","tags","vals",["[","nums","pos"]]],["if",["!",["is.null","fields"]],["<-","out",["[","out","fields"]]],"out"]]],["<-","write.dcf",["function",[{"x":"","file":"\"\"","append":"FALSE","useBytes":"FALSE","indent":["*","0.1",["getOption","\"width\""]],"width":["*","0.9",["getOption","\"width\""]],"keep.white":"NULL"}],["{",["if",["==","file","\"\""],["<-","file",["stdout",{}]],["if",["is.character","file"],["{",["<-","file",["file","file",["if","append","\"a\"","\"w\""]]],["on.exit",["close","file"]]]]],["if",["!",["inherits","file","\"connection\""]],["stop","\"'file' must be a character string or connection\""]],["<-","escape_paragraphs",["function",[{"s":""}],["gsub","\"\\n \\\\.([^\\n])\"","\"\\n  .\\\\1\"",["gsub","\"\\n[ \\t]*\\n\"","\"\\n .\\n \"","s",{"perl":"TRUE"},{"useBytes":"TRUE"}],{"perl":"TRUE"},{"useBytes":"TRUE"}]]],["<-","fmt",["function",[{"tag":"","val":"","fold":"TRUE"}],["{",["<-","s",["if","fold",["formatDL",["rep.int","tag",["length","val"]],"val",{"style":"\"list\""},{"width":"width"},{"indent":"indent"}],["{",["sprintf","\"%s: %s\"","tag",["gsub","\"\\n([^[:blank:]])\"","\"\\n \\\\1\"","val"]]]]],["escape_paragraphs","s"]]]],["if",["!",["is.data.frame","x"]],["<-","x",["as.data.frame","x",{"stringsAsFactors":"FALSE"}]]],["<-","nmx",["names","x"]],["<-","out",["matrix","\"\"",["nrow","x"],["ncol","x"]]],["<-","foldable",["is.na",["match","nmx","keep.white"]]],["for","j",["seq_along","x"],["{",["<-","xj",["[[","x","j"]],["if",["is.atomic","xj"],["{",["<-","i",["!",["is.na","xj"]]],["<-",["[","out","i","j"],["fmt",["[","nmx","j"],["[","xj","i"],["[","foldable","j"]]]],["{",["<-","nmxj",["[","nmx","j"]],["<-","fold",["[","foldable","j"]],["<-","i",["!",["vapply","xj",["function",[{"s":""}],["&&",["(",["==",["length","s"],"1L"]],["is.na","s"]]],"NA"]]],["<-",["[","out","i","j"],["vapply",["[","xj","i"],["function",[{"s":""}],["{",["paste",["fmt","nmxj","s","fold"],{"collapse":"\"\\n\""}]]],"\"\""]]]]]],["<-","out",["t","out"]],["<-","is_not_empty",["nzchar","out"]],["<-","eor",["character",["sum","is_not_empty"]]],["if",["length","eor"],["{",["<-",["[","eor",["which",[">=",["diff",["[",["c",["col","out"]],"is_not_empty"]],"1L"]]],"\"\\n\""]]],["writeLines",["paste0",["c",["[","out","is_not_empty"]],"eor"],"file",{"useBytes":"useBytes"}]]]]]
