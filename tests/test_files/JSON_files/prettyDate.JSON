[[],["<-","prettyDate",["function",[{"x":"","n":"5","min.n":["%/%","n","2"],"sep":"\" \"","...":""}],["{",["stopifnot",["<=","min.n","n"]],["<-","isDate",["inherits","x","\"Date\""]],["<-","x",["as.POSIXct","x"]],["if","isDate",["<-",["attr","x","\"tzone\""],"\"GMT\""]],["<-","zz",["<-","rx",["range","x",{"na.rm":"TRUE"}]]],["<-","D",["diff",["<-","nzz",["as.numeric","zz"]]]],["<-","MIN","60"],["<-","HOUR",["*","MIN","60"]],["<-","DAY",["*","HOUR","24"]],["<-","YEAR",["*","DAY","365.25"]],["<-","MONTH",["/","YEAR","12"]],["<-","makeOutput",["function",[{"at":"","s":"","round":"TRUE","do":""}],["{",["structure",["if","isDate",["if","round",["as.Date",["round","at",{"units":"\"days\""}]],"at"],["as.POSIXct","at"]],{"labels":["format","at",["$","s","format"]]}]]]],["if",["&&","isDate",["<=","D",["*","n","DAY"]]],["{",["<-","zz",["as.Date","zz"]],["<-","r",["round",["-","n",["/","D","DAY"]]]],["<-","m",["max","0",["%/%","r","2"]]],["<-","m2",["+","m",["(",["%%","r","2"]]]],["while",["<",["length",["<-","dd",["seq.Date",["-",["[","zz","1"],"m"],["+",["[","zz","2"],"m2"],{"by":"\"1 day\""}]]],["+","min.n","1"]],["if",["<","m","m2"],["<-","m",["+","m","1"]],["<-","m2",["+","m2","1"]]]],["return",["makeOutput","dd",{"round":"FALSE"},["list",{"format":["paste","\"%b\"","\"%d\"",{"sep":"sep"}]}]]]],["if",["<","D","1"],["{",["<-","m",["min","30",["max",["==","D","0"],["/","n","2"]]]],["<-","zz",["structure",["c",["floor",["-",["[","nzz","1"],"m"]],["ceiling",["+",["[","nzz","2"],"m"]]],{"class":["class","x"]},{"tzone":["attr","x","\"tzone\""]}]]]]],["<-","xspan",["as.numeric",["diff","zz"],{"units":"\"secs\""}]],["<-","steps",["list",{"\"1 sec\"":["list","1",{"format":"\"%S\""},{"start":"\"mins\""}]},{"\"2 secs\"":["list","2"]},{"\"5 secs\"":["list","5"]},{"\"10 secs\"":["list","10"]},{"\"15 secs\"":["list","15"]},{"\"30 secs\"":["list","30",{"format":"\"%H:%M:%S\""}]},{"\"1 min\"":["list",["*","1","MIN"],{"format":"\"%H:%M\""}]},{"\"2 mins\"":["list",["*","2","MIN"],{"start":"\"hours\""}]},{"\"5 mins\"":["list",["*","5","MIN"]]},{"\"10 mins\"":["list",["*","10","MIN"]]},{"\"15 mins\"":["list",["*","15","MIN"]]},{"\"30 mins\"":["list",["*","30","MIN"]]},{"\"1 hour\"":["list",["*","1","HOUR"],{"format":["if",["<=","xspan","DAY"],"\"%H:%M\"",["paste","\"%b %d\"","\"%H:%M\"",{"sep":"sep"}]]}]},{"\"3 hours\"":["list",["*","3","HOUR"],{"start":"\"days\""}]},{"\"6 hours\"":["list",["*","6","HOUR"],{"format":["paste","\"%b %d\"","\"%H:%M\"",{"sep":"sep"}]}]},{"\"12 hours\"":["list",["*","12","HOUR"]]},{"\"1 DSTday\"":["list",["*","1","DAY"],{"format":["paste","\"%b\"","\"%d\"",{"sep":"sep"}]}]},{"\"2 DSTdays\"":["list",["*","2","DAY"]]},{"\"1 week\"":["list",["*","7","DAY"],{"start":"\"weeks\""}]},{"\"halfmonth\"":["list",["/","MONTH","2"],{"start":"\"months\""}]},{"\"1 month\"":["list",["*","1","MONTH"],{"format":["if",["<","xspan","YEAR"],"\"%b\"",["paste","\"%b\"","\"%Y\"",{"sep":"sep"}]]}]},{"\"3 months\"":["list",["*","3","MONTH"],{"start":"\"years\""}]},{"\"6 months\"":["list",["*","6","MONTH"],{"format":"\"%Y-%m\""}]},{"\"1 year\"":["list",["*","1","YEAR"],{"format":"\"%Y\""}]},{"\"2 years\"":["list",["*","2","YEAR"],{"start":"\"decades\""}]},{"\"5 years\"":["list",["*","5","YEAR"]]},{"\"10 years\"":["list",["*","10","YEAR"]]},{"\"20 years\"":["list",["*","20","YEAR"],{"start":"\"centuries\""}]},{"\"50 years\"":["list",["*","50","YEAR"]]},{"\"100 years\"":["list",["*","100","YEAR"]]},{"\"200 years\"":["list",["*","200","YEAR"]]},{"\"500 years\"":["list",["*","500","YEAR"]]},{"\"1000 years\"":["list",["*","1000","YEAR"]]}]],["for","i",["seq_along","steps"],["{",["if",["is.null",["$",["[[","steps","i"],"format"]],["<-",["$",["[[","steps","i"],"format"],["$",["[[","steps",["-","i","1"]],"format"]]],["if",["is.null",["$",["[[","steps","i"],"start"]],["<-",["$",["[[","steps","i"],"start"],["$",["[[","steps",["-","i","1"]],"start"]]],["<-",["$",["[[","steps","i"],"spec"],["[",["names","steps"],"i"]]]],["<-","nsteps",["/","xspan",["vapply","steps","`[[`",["numeric","1"],"1L",{"USE.NAMES":"FALSE"}]]],["<-","init.i",["<-","init.i0",["which.min",["abs",["-","nsteps","n"]]]]],["<-","calcSteps",["function",[{"s":"","lim":["range","zz"]}],["{",["<-","startTime",["trunc_POSIXt",["[","lim","1"],{"units":["$","s","start"]}]],["<-","at",["seqDtime","startTime",{"end":["[","lim","2"]},{"by":["$","s","spec"]}]],["if",["anyNA","at"],["{",["<-","at",["[","at",["!",["is.na","at"]]]],["if",["!",["length","at"]],["return","at"]]]],["<-","r1",["sum",["<=","at",["[","lim","1"]]]],["<-","r2",["-",["+",["length","at"],"1"],["sum",[">=","at",["[","lim","2"]]]]],["if",["==","r2",["+",["length","at"],"1"]],["{",["<-","nat",["[",["seqDtime",["[","at",["length","at"]],{"by":["$","s","spec"]},{"length":"2"}],"2"]],["if",["||",["is.na","nat"],["!",["(",[">","nat",["[","at",["length","at"]]]]]],["<-","r2",["length","at"]],["<-",["[","at","r2"],"nat"]]]],["[","at",[":","r1","r2"]]]]],["<-","init.at",["calcSteps",["<-","st.i",["[[","steps","init.i"]]]],["<-","R","TRUE"],["<-","L.fail",["<-","R.fail","FALSE"]],["while",["<",["(",["<-","init.n",["-",["length","init.at"],"1L"]]],"min.n"],["{",["if",["==","init.i","1L"],["{",["if","R",["{",["<-","nat",["[",["seqDtime",["[","init.at",["length","init.at"]],{"by":["$","st.i","spec"]},{"length":"2"}],"2"]],["<-","R.fail",["||",["is.na","nat"],["!",["(",[">","nat",["[","init.at",["length","init.at"]]]]]]],["if",["!","R.fail"],["<-",["[","init.at",["+",["length","init.at"],"1"]],"nat"]]],["{",["<-","nat",["[",["seqDtime",["[","init.at","1"],{"by":["paste0","\"-\"",["$","st.i","spec"]]},{"length":"2"}],"2"]],["<-","L.fail",["||",["is.na","nat"],["!",["(",["<","nat",["[","init.at","1"]]]]]],["if",["!","L.fail"],["{",["<-",["[","init.at",["+",["seq_along","init.at"],"1"]],"init.at"],["<-",["[","init.at","1"],"nat"]]]]],["if",["&&","R.fail","L.fail"],["stop","\"failed to add more ticks; 'min.n' too large?\""]],["<-","R",["!","R"]]],["{",["<-","init.i",["-","init.i","1L"]],["<-","init.at",["calcSteps",["<-","st.i",["[[","steps","init.i"]]]]]]]],["if",["==","init.n","n"],["return",["makeOutput","init.at","st.i"]]],["<-","dn",["-","init.n","n"]],["if",[">","dn","0L"],["{",["<-","nl",["-",["sum",["<=","init.at",["[","rx","1"]]],"1L"]],["<-","nr",["-",["sum",[">=","init.at",["[","rx","2"]]],"1L"]],["if",["||",[">","nl","0L"],[">","nr","0L"]],["{",["<-","n.c",["+","nl","nr"]],["if",["<","dn","n.c"],["{",["<-","nl",["round",["/",["*","dn","nl"],"n.c"]]],["<-","nr",["-","dn","nl"]]]],["<-","init.at",["[","init.at",["-",["c",["seq_len","nl"],["-",["+",["length","init.at"],"1L"],["seq_len","nr"]]]]]]]]],["{"]],["if",["||",["||",["==",["(",["<-","dn",["-",["-",["length","init.at"],"1L"],"n"]]],"0L"],["(",["&&",[">","dn","0L"],["<","init.i","init.i0"]]]],["(",["&&",["<","dn","0L"],["==","init.i","1"]]]],["return",["makeOutput","init.at","st.i"]]],["<-","new.i",["if",[">","dn","0L"],["min",["+","init.i","1L"],["length","steps"]],["-","init.i","1L"]]],["<-","new.at",["calcSteps",["[[","steps","new.i"]]],["<-","new.n",["-",["length","new.at"],"1L"]],["if",["<","new.n","min.n"],["<-","new.n",["-","Inf"]]],["if",["<",["abs",["-","new.n","n"]],["abs","dn"]],["makeOutput","new.at",["[[","steps","new.i"]],["makeOutput","init.at","st.i"]]]]],["<-","seqDtime",["function",[{"beg":"","end":"","by":"","length":"NULL"}],["{",["if",["||",["missing","by"],["!",["identical","by","\"halfmonth\""]]],["return",["seq","beg","end",{"by":"by"},{"length.out":"length"}]]],["if",["is.null","length"],["{",["<-","l2","NULL"],["<-","i","TRUE"]],["{",["<-","l2",["ceiling",["/","length","2"]]],["<-","i",["seq_len","length"]]]],["<-","at",["seq","beg","end",{"by":"\"months\""},{"length.out":"l2"}]],["<-","at2",["as.POSIXlt","at"]],["stopifnot",["==",["length",["<-","md",["unique",["$","at2","mday"]]]],"1"]],["<-","at",["as.POSIXct","at"]],["if",["==","md","1"],["{",["<-",["$","at2","mday"],"15L"]],["if",[">=","md","15"],["{",["<-",["$","at2","mday"],"1L"],["<-",["$","at2","mon"],["+",["$","at2","mon"],"1L"]]],["if",["<","md","15"],["{",["<-",["$","at2","mday"],["+","md","14L"]]]]]],["<-",["$","at2","isdst"],["-","1L"]],["<-","at2",["rbind","at",["as.POSIXct","at2"],{"deparse.level":"0L"}]],["structure",["[","at2","i"],{"class":["class","at"]},{"tzone":["attr","at","\"tzone\""]}]]]],["<-","trunc_POSIXt",["function",[{"x":"","units":["c","\"secs\"","\"mins\"","\"hours\"","\"days\"","\"weeks\"","\"months\"","\"years\"","\"decades\"","\"centuries\""],"start.on.monday":"TRUE"}],["{",["<-","x",["as.POSIXlt","x"]],["if",["%in%","units",["c","\"secs\"","\"mins\"","\"hours\"","\"days\""]],["return",["trunc.POSIXt","x","units"]]],["<-","x",["trunc.POSIXt","x","\"days\""]],["if",["length",["$","x","sec"]],["switch","units",{"weeks":["{",["<-",["$","x","mday"],["-",["$","x","mday"],["$","x","wday"]]],["if","start.on.monday",["<-",["$","x","mday"],["+",["$","x","mday"],["ifelse",[">",["$","x","wday"],"0L"],"1L",["-","6L"]]]]]]},{"months":["{",["<-",["$","x","mday"],"1"]]},{"years":["{",["<-",["$","x","mday"],"1"],["<-",["$","x","mon"],"0"]]},{"decades":["{",["<-",["$","x","mday"],"1"],["<-",["$","x","mon"],"0"],["<-",["$","x","year"],["*",["(",["%/%",["$","x","year"],"10"]],"10"]]]},{"centuries":["{",["<-",["$","x","mday"],"1"],["<-",["$","x","mon"],"0"],["<-",["$","x","year"],["*",["(",["%/%",["$","x","year"],"100"]],"100"]]]}]],"x"]]]]
