[[],[["::","utils","globalVariables"],"\"n\"",{"add":"TRUE"}],["<-","glm",["function",[{"formula":"","family":"gaussian","data":"","weights":"","subset":"","na.action":"","start":"NULL","etastart":"","mustart":"","offset":"","control":["list","..."],"model":"TRUE","method":"\"glm.fit\"","x":"FALSE","y":"TRUE","singular.ok":"TRUE","contrasts":"NULL","...":""}],["{",["<-","call",["match.call",{}]],["if",["is.character","family"],["<-","family",["get","family",{"mode":"\"function\""},{"envir":["parent.frame",{}]}]]],["if",["is.function","family"],["<-","family",["family",{}]]],["if",["is.null",["$","family","family"]],["{",["print","family"],["stop","\"'family' not recognized\""]]],["if",["missing","data"],["<-","data",["environment","formula"]]],["<-","mf",["match.call",{"expand.dots":"FALSE"}]],["<-","m",["match",["c","\"formula\"","\"data\"","\"subset\"","\"weights\"","\"na.action\"","\"etastart\"","\"mustart\"","\"offset\""],["names","mf"],"0L"]],["<-","mf",["[","mf",["c","1L","m"]]],["<-",["$","mf","drop.unused.levels"],"TRUE"],["<-",["[[","mf","1L"],["quote",["::","stats","model.frame"]]],["<-","mf",["eval","mf",["parent.frame",{}]]],["if",["identical","method","\"model.frame\""],["return","mf"]],["if",["&&",["!",["is.character","method"]],["!",["is.function","method"]]],["stop","\"invalid 'method' argument\""]],["if",["identical","method","\"glm.fit\""],["<-","control",["do.call","\"glm.control\"","control"]]],["<-","mt",["attr","mf","\"terms\""]],["<-","Y",["model.response","mf","\"any\""]],["if",["==",["length",["dim","Y"]],"1L"],["{",["<-","nm",["rownames","Y"]],["<-",["dim","Y"],"NULL"],["if",["!",["is.null","nm"]],["<-",["names","Y"],"nm"]]]],["<-","X",["if",["!",["is.empty.model","mt"]],["model.matrix","mt","mf","contrasts"],["matrix",{},["NROW","Y"],"0L"]]],["<-","weights",["as.vector",["model.weights","mf"]]],["if",["&&",["!",["is.null","weights"]],["!",["is.numeric","weights"]]],["stop","\"'weights' must be a numeric vector\""]],["if",["&&",["!",["is.null","weights"]],["any",["<","weights","0"]]],["stop","\"negative weights not allowed\""]],["<-","offset",["as.vector",["model.offset","mf"]]],["if",["!",["is.null","offset"]],["{",["if",["!=",["length","offset"],["NROW","Y"]],["stop",["gettextf","\"number of offsets is %d should equal %d (number of observations)\"",["length","offset"],["NROW","Y"]],{"domain":"NA"}]]]],["<-","mustart",["model.extract","mf","\"mustart\""]],["<-","etastart",["model.extract","mf","\"etastart\""]],["<-","fit",["eval",["call",["if",["is.function","method"],"\"method\"","method"],{"x":"X"},{"y":"Y"},{"weights":"weights"},{"start":"start"},{"etastart":"etastart"},{"mustart":"mustart"},{"offset":"offset"},{"family":"family"},{"control":"control"},{"intercept":[">",["attr","mt","\"intercept\""],"0L"]},{"singular.ok":"singular.ok"}]]],["if",["&&",["length","offset"],[">",["attr","mt","\"intercept\""],"0L"]],["{",["<-","fit2",["eval",["call",["if",["is.function","method"],"\"method\"","method"],{"x":["[","X",{},"\"(Intercept)\"",{"drop":"FALSE"}]},{"y":"Y"},{"weights":"weights"},{"offset":"offset"},{"family":"family"},{"control":"control"},{"intercept":"TRUE"}]]],["if",["!",["$","fit2","converged"]],["warning","\"fitting to calculate the null deviance did not converge -- increase 'maxit'?\""]],["<-",["$","fit","null.deviance"],["$","fit2","deviance"]]]],["if","model",["<-",["$","fit","model"],"mf"]],["<-",["$","fit","na.action"],["attr","mf","\"na.action\""]],["if","x",["<-",["$","fit","x"],"X"]],["if",["!","y"],["<-",["$","fit","y"],"NULL"]],["<-","fit",["c","fit",["list",{"call":"call"},{"formula":"formula"},{"terms":"mt"},{"data":"data"},{"offset":"offset"},{"control":"control"},{"method":"method"},{"contrasts":["attr","X","\"contrasts\""]},{"xlevels":[".getXlevels","mt","mf"]}]]],["<-",["class","fit"],["c",["$","fit","class"],["c","\"glm\"","\"lm\""]]],"fit"]]],["<-","glm.control",["function",[{"epsilon":"1e-8","maxit":"25","trace":"FALSE"}],["{",["if",["||",["!",["is.numeric","epsilon"]],["<=","epsilon","0"]],["stop","\"value of 'epsilon' must be > 0\""]],["if",["||",["!",["is.numeric","maxit"]],["<=","maxit","0"]],["stop","\"maximum number of iterations must be > 0\""]],["list",{"epsilon":"epsilon"},{"maxit":"maxit"},{"trace":"trace"}]]]],["<-","glm.fit",["function",[{"x":"","y":"","weights":["rep","1","nobs"],"start":"NULL","etastart":"NULL","mustart":"NULL","offset":["rep","0","nobs"],"family":["gaussian",{}],"control":["list",{}],"intercept":"TRUE","singular.ok":"TRUE"}],["{",["<-","control",["do.call","\"glm.control\"","control"]],["<-","x",["as.matrix","x"]],["<-","xnames",["[[",["dimnames","x"],"2L"]],["<-","ynames",["if",["is.matrix","y"],["rownames","y"],["names","y"]]],["<-","conv","FALSE"],["<-","nobs",["NROW","y"]],["<-","nvars",["ncol","x"]],["<-","EMPTY",["==","nvars","0"]],["if",["is.null","weights"],["<-","weights",["rep.int","1","nobs"]]],["if",["is.null","offset"],["<-","offset",["rep.int","0","nobs"]]],["<-","variance",["$","family","variance"]],["<-","linkinv",["$","family","linkinv"]],["if",["||",["!",["is.function","variance"]],["!",["is.function","linkinv"]]],["stop","\"'family' argument seems not to be a valid family object\"",{"call.":"FALSE"}]],["<-","dev.resids",["$","family","dev.resids"]],["<-","aic",["$","family","aic"]],["<-","mu.eta",["$","family","mu.eta"]],["<-","unless.null",["function",[{"x":"","if.null":""}],["if",["is.null","x"],"if.null","x"]]],["<-","valideta",["unless.null",["$","family","valideta"],["function",[{"eta":""}],"TRUE"]]],["<-","validmu",["unless.null",["$","family","validmu"],["function",[{"mu":""}],"TRUE"]]],["if",["is.null","mustart"],["{",["eval",["$","family","initialize"]]],["{",["<-","mukeep","mustart"],["eval",["$","family","initialize"]],["<-","mustart","mukeep"]]],["if","EMPTY",["{",["<-","eta",["+",["rep.int","0","nobs"],"offset"]],["if",["!",["valideta","eta"]],["stop","\"invalid linear predictor values in empty model\"",{"call.":"FALSE"}]],["<-","mu",["linkinv","eta"]],["if",["!",["validmu","mu"]],["stop","\"invalid fitted means in empty model\"",{"call.":"FALSE"}]],["<-","dev",["sum",["dev.resids","y","mu","weights"]]],["<-","w",["sqrt",["/",["(",["*","weights",["^",["mu.eta","eta"],"2"]]],["variance","mu"]]]],["<-","residuals",["/",["(",["-","y","mu"]],["mu.eta","eta"]]],["<-","good",["rep_len","TRUE",["length","residuals"]]],["<-","boundary",["<-","conv","TRUE"]],["<-","coef",["numeric",{}]],["<-","iter","0L"]],["{",["<-","coefold","NULL"],["<-","eta",["if",["!",["is.null","etastart"]],"etastart",["if",["!",["is.null","start"]],["if",["!=",["length","start"],"nvars"],["stop",["gettextf","\"length of 'start' should equal %d and correspond to initial coefs for %s\"","nvars",["paste",["deparse","xnames"],{"collapse":"\", \""}]],{"domain":"NA"}],["{",["<-","coefold","start"],["+","offset",["as.vector",["if",["==",["NCOL","x"],"1L"],["*","x","start"],["%*%","x","start"]]]]]],[["$","family","linkfun"],"mustart"]]]],["<-","mu",["linkinv","eta"]],["if",["!",["(",["&&",["validmu","mu"],["valideta","eta"]]]],["stop","\"cannot find valid starting values: please specify some\"",{"call.":"FALSE"}]],["<-","devold",["sum",["dev.resids","y","mu","weights"]]],["<-","boundary",["<-","conv","FALSE"]],["for","iter",[":","1L",["$","control","maxit"]],["{",["<-","good",[">","weights","0"]],["<-","varmu",["[",["variance","mu"],"good"]],["if",["anyNA","varmu"],["stop","\"NAs in V(mu)\""]],["if",["any",["==","varmu","0"]],["stop","\"0s in V(mu)\""]],["<-","mu.eta.val",["mu.eta","eta"]],["if",["any",["is.na",["[","mu.eta.val","good"]]],["stop","\"NAs in d(mu)/d(eta)\""]],["<-","good",["&",["(",[">","weights","0"]],["(",["!=","mu.eta.val","0"]]]],["if",["all",["!","good"]],["{",["<-","conv","FALSE"],["warning",["gettextf","\"no observations informative at iteration %d\"","iter"],{"domain":"NA"}],["break"]]],["<-","z",["+",["[",["(",["-","eta","offset"]],"good"],["/",["[",["(",["-","y","mu"]],"good"],["[","mu.eta.val","good"]]]],["<-","w",["sqrt",["/",["(",["*",["[","weights","good"],["^",["[","mu.eta.val","good"],"2"]]],["[",["variance","mu"],"good"]]]],["<-","fit",[".Call","C_Cdqrls",["*",["[","x","good",{},{"drop":"FALSE"}],"w"],["*","z","w"],["min","1e-7",["/",["$","control","epsilon"],"1000"]],{"check":"FALSE"}]],["if",["any",["!",["is.finite",["$","fit","coefficients"]]]],["{",["<-","conv","FALSE"],["warning",["gettextf","\"non-finite coefficients at iteration %d\"","iter"],{"domain":"NA"}],["break"]]],["if",["<","nobs",["$","fit","rank"]],["stop",["sprintf",["ngettext","nobs","\"X matrix has rank %d, but only %d observation\"","\"X matrix has rank %d, but only %d observations\""],["$","fit","rank"],"nobs"],{"domain":"NA"}]],["if",["&&",["!","singular.ok"],["<",["$","fit","rank"],"nvars"]],["stop","\"singular fit encountered\""]],["<-",["[","start",["$","fit","pivot"]],["$","fit","coefficients"]],["<-","eta",["drop",["%*%","x","start"]]],["<-","mu",["linkinv",["<-","eta",["+","eta","offset"]]]],["<-","dev",["sum",["dev.resids","y","mu","weights"]]],["if",["$","control","trace"],["cat","\"Deviance = \"","dev","\" Iterations - \"","iter","\"\\n\"",{"sep":"\"\""}]],["<-","boundary","FALSE"],["if",["!",["is.finite","dev"]],["{",["if",["is.null","coefold"],["stop","\"no valid set of coefficients has been found: please supply starting values\"",{"call.":"FALSE"}]],["warning","\"step size truncated due to divergence\"",{"call.":"FALSE"}],["<-","ii","1"],["while",["!",["is.finite","dev"]],["{",["if",[">","ii",["$","control","maxit"]],["stop","\"inner loop 1; cannot correct step size\"",{"call.":"FALSE"}]],["<-","ii",["+","ii","1"]],["<-","start",["/",["(",["+","start","coefold"]],"2"]],["<-","eta",["drop",["%*%","x","start"]]],["<-","mu",["linkinv",["<-","eta",["+","eta","offset"]]]],["<-","dev",["sum",["dev.resids","y","mu","weights"]]]]],["<-","boundary","TRUE"],["if",["$","control","trace"],["cat","\"Step halved: new deviance = \"","dev","\"\\n\"",{"sep":"\"\""}]]]],["if",["!",["(",["&&",["valideta","eta"],["validmu","mu"]]]],["{",["if",["is.null","coefold"],["stop","\"no valid set of coefficients has been found: please supply starting values\"",{"call.":"FALSE"}]],["warning","\"step size truncated: out of bounds\"",{"call.":"FALSE"}],["<-","ii","1"],["while",["!",["(",["&&",["valideta","eta"],["validmu","mu"]]]],["{",["if",[">","ii",["$","control","maxit"]],["stop","\"inner loop 2; cannot correct step size\"",{"call.":"FALSE"}]],["<-","ii",["+","ii","1"]],["<-","start",["/",["(",["+","start","coefold"]],"2"]],["<-","eta",["drop",["%*%","x","start"]]],["<-","mu",["linkinv",["<-","eta",["+","eta","offset"]]]]]],["<-","boundary","TRUE"],["<-","dev",["sum",["dev.resids","y","mu","weights"]]],["if",["$","control","trace"],["cat","\"Step halved: new deviance = \"","dev","\"\\n\"",{"sep":"\"\""}]]]],["if",["<",["/",["abs",["-","dev","devold"]],["(",["+","0.1",["abs","dev"]]]],["$","control","epsilon"]],["{",["<-","conv","TRUE"],["<-","coef","start"],["break"]],["{",["<-","devold","dev"],["<-","coef",["<-","coefold","start"]]]]]],["if",["!","conv"],["warning","\"glm.fit: algorithm did not converge\"",{"call.":"FALSE"}]],["if","boundary",["warning","\"glm.fit: algorithm stopped at boundary value\"",{"call.":"FALSE"}]],["<-","eps",["*","10",["$",".Machine","double.eps"]]],["if",["==",["$","family","family"],"\"binomial\""],["{",["if",["||",["any",[">","mu",["-","1","eps"]]],["any",["<","mu","eps"]]],["warning","\"glm.fit: fitted probabilities numerically 0 or 1 occurred\"",{"call.":"FALSE"}]]]],["if",["==",["$","family","family"],"\"poisson\""],["{",["if",["any",["<","mu","eps"]],["warning","\"glm.fit: fitted rates numerically 0 occurred\"",{"call.":"FALSE"}]]]],["if",["<",["$","fit","rank"],"nvars"],["<-",["[",["[","coef",["$","fit","pivot"]],["seq.int",["+",["$","fit","rank"],"1"],"nvars"]],"NA"]],["<-","xxnames",["[","xnames",["$","fit","pivot"]]],["<-","residuals",["/",["(",["-","y","mu"]],["mu.eta","eta"]]],["<-",["$","fit","qr"],["as.matrix",["$","fit","qr"]]],["<-","nr",["min",["sum","good"],"nvars"]],["if",["<","nr","nvars"],["{",["<-","Rmat",["diag","nvars"]],["<-",["[","Rmat",[":","1L","nr"],[":","1L","nvars"]],["[",["$","fit","qr"],[":","1L","nr"],[":","1L","nvars"]]]],["<-","Rmat",["[",["$","fit","qr"],[":","1L","nvars"],[":","1L","nvars"]]]],["<-","Rmat",["as.matrix","Rmat"]],["<-",["[","Rmat",[">",["row","Rmat"],["col","Rmat"]]],"0"],["<-",["names","coef"],"xnames"],["<-",["colnames",["$","fit","qr"]],"xxnames"],["<-",["dimnames","Rmat"],["list","xxnames","xxnames"]]]],["<-",["names","residuals"],"ynames"],["<-",["names","mu"],"ynames"],["<-",["names","eta"],"ynames"],["<-","wt",["rep.int","0","nobs"]],["<-",["[","wt","good"],["^","w","2"]],["<-",["names","wt"],"ynames"],["<-",["names","weights"],"ynames"],["<-",["names","y"],"ynames"],["if",["!","EMPTY"],["<-",["names",["$","fit","effects"]],["c",["[","xxnames",["seq_len",["$","fit","rank"]]],["rep.int","\"\"",["-",["sum","good"],["$","fit","rank"]]]]]],["<-","wtdmu",["if","intercept",["/",["sum",["*","weights","y"]],["sum","weights"]],["linkinv","offset"]]],["<-","nulldev",["sum",["dev.resids","y","wtdmu","weights"]]],["<-","n.ok",["-","nobs",["sum",["==","weights","0"]]]],["<-","nulldf",["-","n.ok",["as.integer","intercept"]]],["<-","rank",["if","EMPTY","0",["$","fit","rank"]]],["<-","resdf",["-","n.ok","rank"]],["<-","aic.model",["+",["aic","y","n","mu","weights","dev"],["*","2","rank"]]],["list",{"coefficients":"coef"},{"residuals":"residuals"},{"fitted.values":"mu"},{"effects":["if",["!","EMPTY"],["$","fit","effects"]]},{"R":["if",["!","EMPTY"],"Rmat"]},{"rank":"rank"},{"qr":["if",["!","EMPTY"],["structure",["[","fit",["c","\"qr\"","\"rank\"","\"qraux\"","\"pivot\"","\"tol\""]],{"class":"\"qr\""}]]},{"family":"family"},{"linear.predictors":"eta"},{"deviance":"dev"},{"aic":"aic.model"},{"null.deviance":"nulldev"},{"iter":"iter"},{"weights":"wt"},{"prior.weights":"weights"},{"df.residual":"resdf"},{"df.null":"nulldf"},{"y":"y"},{"converged":"conv"},{"boundary":"boundary"}]]]],["<-","print.glm",["function",[{"x":"","digits":["max","3L",["-",["getOption","\"digits\""],"3L"]],"...":""}],["{",["cat","\"\\nCall:  \"",["paste",["deparse",["$","x","call"]],{"sep":"\"\\n\""},{"collapse":"\"\\n\""}],"\"\\n\\n\"",{"sep":"\"\""}],["if",["length",["coef","x"]],["{",["cat","\"Coefficients\""],["if",["is.character",["<-","co",["$","x","contrasts"]]],["cat","\"  [contrasts: \"",["apply",["cbind",["names","co"],"co"],"1L","paste",{"collapse":"\"=\""}],"\"]\""]],["cat","\":\\n\""],["print.default",["format",["$","x","coefficients"],{"digits":"digits"}],{"print.gap":"2"},{"quote":"FALSE"}]],["cat","\"No coefficients\\n\\n\""]],["cat","\"\\nDegrees of Freedom:\"",["$","x","df.null"],"\"Total (i.e. Null); \"",["$","x","df.residual"],"\"Residual\\n\""],["if",["nzchar",["<-","mess",["naprint",["$","x","na.action"]]]],["cat","\"  (\"","mess","\")\\n\"",{"sep":"\"\""}]],["cat","\"Null Deviance:\t   \"",["format",["signif",["$","x","null.deviance"],"digits"]],"\"\\nResidual Deviance:\"",["format",["signif",["$","x","deviance"],"digits"]],"\"\\tAIC:\"",["format",["signif",["$","x","aic"],"digits"]]],["cat","\"\\n\""],["invisible","x"]]]],["<-","anova.glm",["function",[{"object":"","...":"","dispersion":"NULL","test":"NULL"}],["{",["<-","dotargs",["list","..."]],["<-","named",["if",["is.null",["names","dotargs"]],["rep_len","FALSE",["length","dotargs"]],["(",["!=",["names","dotargs"],"\"\""]]]],["if",["any","named"],["warning","\"the following arguments to 'anova.glm' are invalid and dropped: \"",["paste",["deparse",["[","dotargs","named"]],{"collapse":"\", \""}]]],["<-","dotargs",["[","dotargs",["!","named"]]],["<-","is.glm",["vapply","dotargs",["function",[{"x":""}],["inherits","x","\"glm\""]],"NA"]],["<-","dotargs",["[","dotargs","is.glm"]],["if",["length","dotargs"],["return",["anova.glmlist",["c",["list","object"],"dotargs"],{"dispersion":"dispersion"},{"test":"test"}]]],["<-","doscore",["&&",["!",["is.null","test"]],["==","test","\"Rao\""]]],["<-","varlist",["attr",["$","object","terms"],"\"variables\""]],["<-","x",["if",["<-","n",["match","\"x\"",["names","object"],"0L"]],["[[","object","n"],["model.matrix","object"]]],["<-","varseq",["attr","x","\"assign\""]],["<-","nvars",["max","0","varseq"]],["<-","resdev",["<-","resdf","NULL"]],["if","doscore",["{",["<-","score",["numeric","nvars"]],["<-","method",["$","object","method"]],["<-","y",["$","object","y"]],["<-","fit",["eval",["call",["if",["is.function","method"],"\"method\"","method"],{"x":["[","x",{},["==","varseq","0"],{"drop":"FALSE"}]},{"y":"y"},{"weights":["$","object","prior.weights"]},{"start":["$","object","start"]},{"offset":["$","object","offset"]},{"family":["$","object","family"]},{"control":["$","object","control"]}]]],["<-","r",["$","fit","residuals"]],["<-","w",["$","fit","weights"]]]],["if",["||",[">","nvars","1"],"doscore"],["{",["<-","method",["$","object","method"]],["<-","y",["$","object","y"]],["if",["is.null","y"],["{",["<-","mu.eta",["$",["$","object","family"],"mu.eta"]],["<-","eta",["$","object","linear.predictors"]],["<-","y",["+",["$","object","fitted.values"],["*",["$","object","residuals"],["mu.eta","eta"]]]]]],["for","i",["seq_len",["-","nvars","1L"]],["{",["<-","fit",["eval",["call",["if",["is.function","method"],"\"method\"","method"],{"x":["[","x",{},["<=","varseq","i"],{"drop":"FALSE"}]},{"y":"y"},{"weights":["$","object","prior.weights"]},{"start":["$","object","start"]},{"offset":["$","object","offset"]},{"family":["$","object","family"]},{"control":["$","object","control"]}]]],["if","doscore",["{",["<-","zz",["eval",["call",["if",["is.function","method"],"\"method\"","method"],{"x":["[","x",{},["<=","varseq","i"],{"drop":"FALSE"}]},{"y":"r"},{"weights":"w"}]]],["<-",["[","score","i"],["-",["$","zz","null.deviance"],["$","zz","deviance"]]],["<-","r",["$","fit","residuals"]],["<-","w",["$","fit","weights"]]]],["<-","resdev",["c","resdev",["$","fit","deviance"]]],["<-","resdf",["c","resdf",["$","fit","df.residual"]]]]],["if","doscore",["{",["<-","zz",["eval",["call",["if",["is.function","method"],"\"method\"","method"],{"x":"x"},{"y":"r"},{"weights":"w"}]]],["<-",["[","score","nvars"],["-",["$","zz","null.deviance"],["$","zz","deviance"]]]]]]],["<-","resdf",["c",["$","object","df.null"],"resdf",["$","object","df.residual"]]],["<-","resdev",["c",["$","object","null.deviance"],"resdev",["$","object","deviance"]]],["<-","table",["data.frame",["c","NA",["-",["diff","resdf"]]],["c","NA",["pmax","0",["-",["diff","resdev"]]]],"resdf","resdev"]],["<-","tl",["attr",["$","object","terms"],"\"term.labels\""]],["if",["==",["length","tl"],"0L"],["<-","table",["[","table","1",{},{"drop":"FALSE"}]]],["<-",["dimnames","table"],["list",["c","\"NULL\"","tl"],["c","\"Df\"","\"Deviance\"","\"Resid. Df\"","\"Resid. Dev\""]]],["if","doscore",["<-","table",["cbind","table",{"Rao":["c","NA","score"]}]]],["<-","title",["paste0","\"Analysis of Deviance Table\"","\"\\n\\nModel: \"",["$",["$","object","family"],"family"],"\", link: \"",["$",["$","object","family"],"link"],"\"\\n\\nResponse: \"",["[",["as.character",["[","varlist",["-","1L"]]],"1L"],"\"\\n\\nTerms added sequentially (first to last)\\n\\n\""]],["<-","df.dispersion","Inf"],["if",["is.null","dispersion"],["{",["<-","dispersion",["$",["summary","object",{"dispersion":"dispersion"}],"dispersion"]],["<-","df.dispersion",["if",["==","dispersion","1"],"Inf",["$","object","df.residual"]]]]],["if",["!",["is.null","test"]],["{",["if",["&&",["==","test","\"F\""],["==","df.dispersion","Inf"]],["{",["<-","fam",["$",["$","object","family"],"family"]],["if",["||",["==","fam","\"binomial\""],["==","fam","\"poisson\""]],["warning",["gettextf","\"using F test with a '%s' family is inappropriate\"","fam"],{"domain":"NA"}],["warning","\"using F test with a fixed dispersion is inappropriate\""]]]],["<-","table",["stat.anova",{"table":"table"},{"test":"test"},{"scale":"dispersion"},{"df.scale":"df.dispersion"},{"n":["NROW","x"]}]]]],["structure","table",{"heading":"title"},{"class":["c","\"anova\"","\"data.frame\""]}]]]],["<-","anova.glmlist",["function",[{"object":"","...":"","dispersion":"NULL","test":"NULL"}],["{",["<-","doscore",["&&",["!",["is.null","test"]],["==","test","\"Rao\""]]],["<-","responses",["as.character",["lapply","object",["function",[{"x":""}],["{",["deparse",["[[",["formula","x"],"2L"]]]]]]],["<-","sameresp",["==","responses",["[","responses","1L"]]],["if",["!",["all","sameresp"]],["{",["<-","object",["[","object","sameresp"]],["warning",["gettextf","\"models with response %s removed because response differs from model 1\"",["sQuote",["deparse",["[","responses",["!","sameresp"]]]]],{"domain":"NA"}]]],["<-","ns",["sapply","object",["function",[{"x":""}],["length",["$","x","residuals"]]]]],["if",["any",["!=","ns",["[","ns","1L"]]],["stop","\"models were not all fitted to the same size of dataset\""]],["<-","nmodels",["length","object"]],["if",["==","nmodels","1"],["return",["anova.glm",["[[","object","1L"],{"dispersion":"dispersion"},{"test":"test"}]]],["<-","resdf",["as.numeric",["lapply","object",["function",[{"x":""}],["$","x","df.residual"]]]]],["<-","resdev",["as.numeric",["lapply","object",["function",[{"x":""}],["$","x","deviance"]]]]],["if","doscore",["{",["<-","score",["numeric","nmodels"]],["<-",["[","score","1"],"NA"],["<-","df",["-",["diff","resdf"]]],["for","i",["seq_len",["-","nmodels","1"]],["{",["<-","m1",["if",[">",["[","df","i"],"0"],["[[","object","i"],["[[","object",["+","i","1"]]]],["<-","m2",["if",[">",["[","df","i"],"0"],["[[","object",["+","i","1"]],["[[","object","i"]]],["<-","r",["$","m1","residuals"]],["<-","w",["$","m1","weights"]],["<-","method",["$","m2","method"]],["<-","zz",["eval",["call",["if",["is.function","method"],"\"method\"","method"],{"x":["model.matrix","m2"]},{"y":"r"},{"weights":"w"}]]],["<-",["[","score",["+","i","1"]],["-",["$","zz","null.deviance"],["$","zz","deviance"]]],["if",["<","df","0"],["<-",["[","score",["+","i","1"]],["-",["[","score",["+","i","1"]]]]]]]]],["<-","table",["data.frame","resdf","resdev",["c","NA",["-",["diff","resdf"]]],["c","NA",["-",["diff","resdev"]]]]],["<-","variables",["lapply","object",["function",[{"x":""}],["paste",["deparse",["formula","x"]],{"collapse":"\"\\n\""}]]]],["<-",["dimnames","table"],["list",[":","1L","nmodels"],["c","\"Resid. Df\"","\"Resid. Dev\"","\"Df\"","\"Deviance\""]]],["if","doscore",["<-","table",["cbind","table",{"Rao":"score"}]]],["<-","title","\"Analysis of Deviance Table\\n\""],["<-","topnote",["paste0","\"Model \"",["format",[":","1L","nmodels"]],"\": \"","variables",{"collapse":"\"\\n\""}]],["if",["!",["is.null","test"]],["{",["<-","bigmodel",["[[","object",["[",["order","resdf"],"1L"]]],["<-","dispersion",["$",["summary","bigmodel",{"dispersion":"dispersion"}],"dispersion"]],["<-","df.dispersion",["if",["==","dispersion","1"],"Inf",["min","resdf"]]],["if",["&&",["==","test","\"F\""],["==","df.dispersion","Inf"]],["{",["<-","fam",["$",["$","bigmodel","family"],"family"]],["if",["||",["==","fam","\"binomial\""],["==","fam","\"poisson\""]],["warning",["gettextf","\"using F test with a '%s' family is inappropriate\"","fam"],{"domain":"NA"},{"call.":"FALSE"}],["warning","\"using F test with a fixed dispersion is inappropriate\""]]]],["<-","table",["stat.anova",{"table":"table"},{"test":"test"},{"scale":"dispersion"},{"df.scale":"df.dispersion"},{"n":["length",["$","bigmodel","residuals"]]}]]]],["structure","table",{"heading":["c","title","topnote"]},{"class":["c","\"anova\"","\"data.frame\""]}]]]],["<-","summary.glm",["function",[{"object":"","dispersion":"NULL","correlation":"FALSE","symbolic.cor":"FALSE","...":""}],["{",["<-","est.disp","FALSE"],["<-","df.r",["$","object","df.residual"]],["if",["is.null","dispersion"],["<-","dispersion",["if",["%in%",["$",["$","object","family"],"family"],["c","\"poisson\"","\"binomial\""]],"1",["if",[">","df.r","0"],["{",["<-","est.disp","TRUE"],["if",["any",["==",["$","object","weights"],"0"]],["warning","\"observations with zero weight not used for calculating dispersion\""]],["/",["sum",["[",["(",["*",["$","object","weights"],["^",["$","object","residuals"],"2"]]],[">",["$","object","weights"],"0"]]],"df.r"]],["{",["<-","est.disp","TRUE"],"NaN"]]]]],["<-","aliased",["is.na",["coef","object"]]],["<-","p",["$","object","rank"]],["if",[">","p","0"],["{",["<-","p1",[":","1L","p"]],["<-","Qr",["qr.lm","object"]],["<-","coef.p",["[",["$","object","coefficients"],["[",["$","Qr","pivot"],"p1"]]],["<-","covmat.unscaled",["chol2inv",["[",["$","Qr","qr"],"p1","p1",{"drop":"FALSE"}]]],["<-",["dimnames","covmat.unscaled"],["list",["names","coef.p"],["names","coef.p"]]],["<-","covmat",["*","dispersion","covmat.unscaled"]],["<-","var.cf",["diag","covmat"]],["<-","s.err",["sqrt","var.cf"]],["<-","tvalue",["/","coef.p","s.err"]],["<-","dn",["c","\"Estimate\"","\"Std. Error\""]],["if",["!","est.disp"],["{",["<-","pvalue",["*","2",["pnorm",["-",["abs","tvalue"]]]]],["<-","coef.table",["cbind","coef.p","s.err","tvalue","pvalue"]],["<-",["dimnames","coef.table"],["list",["names","coef.p"],["c","dn","\"z value\"","\"Pr(>|z|)\""]]]],["if",[">","df.r","0"],["{",["<-","pvalue",["*","2",["pt",["-",["abs","tvalue"]],"df.r"]]],["<-","coef.table",["cbind","coef.p","s.err","tvalue","pvalue"]],["<-",["dimnames","coef.table"],["list",["names","coef.p"],["c","dn","\"t value\"","\"Pr(>|t|)\""]]]],["{",["<-","coef.table",["cbind","coef.p","NaN","NaN","NaN"]],["<-",["dimnames","coef.table"],["list",["names","coef.p"],["c","dn","\"t value\"","\"Pr(>|t|)\""]]]]]],["<-","df.f",["NCOL",["$","Qr","qr"]]]],["{",["<-","coef.table",["matrix",{},"0L","4L"]],["<-",["dimnames","coef.table"],["list","NULL",["c","\"Estimate\"","\"Std. Error\"","\"t value\"","\"Pr(>|t|)\""]]],["<-","covmat.unscaled",["<-","covmat",["matrix",{},"0L","0L"]]],["<-","df.f",["length","aliased"]]]],["<-","keep",["match",["c","\"call\"","\"terms\"","\"family\"","\"deviance\"","\"aic\"","\"contrasts\"","\"df.residual\"","\"null.deviance\"","\"df.null\"","\"iter\"","\"na.action\""],["names","object"],"0L"]],["<-","ans",["c",["[","object","keep"],["list",{"deviance.resid":["residuals","object",{"type":"\"deviance\""}]},{"coefficients":"coef.table"},{"aliased":"aliased"},{"dispersion":"dispersion"},{"df":["c",["$","object","rank"],"df.r","df.f"]},{"cov.unscaled":"covmat.unscaled"},{"cov.scaled":"covmat"}]]],["if",["&&","correlation",[">","p","0"]],["{",["<-","dd",["sqrt",["diag","covmat.unscaled"]]],["<-",["$","ans","correlation"],["/","covmat.unscaled",["outer","dd","dd"]]],["<-",["$","ans","symbolic.cor"],"symbolic.cor"]]],["<-",["class","ans"],"\"summary.glm\""],["return","ans"]]]],["<-","print.summary.glm",["function",[{"x":"","digits":["max","3L",["-",["getOption","\"digits\""],"3L"]],"symbolic.cor":["$","x","symbolic.cor"],"signif.stars":["getOption","\"show.signif.stars\""],"...":""}],["{",["cat","\"\\nCall:\\n\"",["paste",["deparse",["$","x","call"]],{"sep":"\"\\n\""},{"collapse":"\"\\n\""}],"\"\\n\\n\"",{"sep":"\"\""}],["cat","\"Deviance Residuals: \\n\""],["if",[">",["$","x","df.residual"],"5"],["{",["<-",["$","x","deviance.resid"],["setNames",["quantile",["$","x","deviance.resid"],{"na.rm":"TRUE"}],["c","\"Min\"","\"1Q\"","\"Median\"","\"3Q\"","\"Max\""]]]]],["<-","xx",["zapsmall",["$","x","deviance.resid"],["+","digits","1L"]]],["print.default","xx",{"digits":"digits"},{"na.print":"\"\""},{"print.gap":"2L"}],["if",["==",["length",["$","x","aliased"]],"0L"],["{",["cat","\"\\nNo Coefficients\\n\""]],["{",["<-","df",["if",["%in%","\"df\"",["names","x"]],["[[","x","\"df\""],"NULL"]],["if",["&&",["!",["is.null","df"]],["(",["<-","nsingular",["-",["[","df","3L"],["[","df","1L"]]]]],["cat","\"\\nCoefficients: (\"","nsingular","\" not defined because of singularities)\\n\"",{"sep":"\"\""}],["cat","\"\\nCoefficients:\\n\""]],["<-","coefs",["$","x","coefficients"]],["if",["&&",["!",["is.null",["<-","aliased",["$","x","aliased"]]]],["any","aliased"]],["{",["<-","cn",["names","aliased"]],["<-","coefs",["matrix","NA",["length","aliased"],"4L",{"dimnames":["list","cn",["colnames","coefs"]]}]],["<-",["[","coefs",["!","aliased"],{}],["$","x","coefficients"]]]],["printCoefmat","coefs",{"digits":"digits"},{"signif.stars":"signif.stars"},{"na.print":"\"NA\""},"..."]]],["cat","\"\\n(Dispersion parameter for \"",["$",["$","x","family"],"family"],"\" family taken to be \"",["format",["$","x","dispersion"]],"\")\\n\\n\"",["apply",["cbind",["paste",["format",["c","\"Null\"","\"Residual\""],{"justify":"\"right\""}],"\"deviance:\""],["format",["unlist",["[","x",["c","\"null.deviance\"","\"deviance\""]]],{"digits":["max","5L",["+","digits","1L"]]}],"\" on\"",["format",["unlist",["[","x",["c","\"df.null\"","\"df.residual\""]]]],"\" degrees of freedom\\n\""],"1L","paste",{"collapse":"\" \""}],{"sep":"\"\""}],["if",["nzchar",["<-","mess",["naprint",["$","x","na.action"]]]],["cat","\"  (\"","mess","\")\\n\"",{"sep":"\"\""}]],["cat","\"AIC: \"",["format",["$","x","aic"],{"digits":["max","4L",["+","digits","1L"]]}],"\"\\n\\n\"","\"Number of Fisher Scoring iterations: \"",["$","x","iter"],"\"\\n\"",{"sep":"\"\""}],["<-","correl",["$","x","correlation"]],["if",["!",["is.null","correl"]],["{",["<-","p",["NCOL","correl"]],["if",[">","p","1"],["{",["cat","\"\\nCorrelation of Coefficients:\\n\""],["if",["&&",["is.logical","symbolic.cor"],"symbolic.cor"],["{",["print",["symnum","correl",{"abbr.colnames":"NULL"}]]],["{",["<-","correl",["format",["round","correl","2L"],{"nsmall":"2L"},{"digits":"digits"}]],["<-",["[","correl",["!",["lower.tri","correl"]]],"\"\""],["print",["[","correl",["-","1"],["-","p"],{"drop":"FALSE"}],{"quote":"FALSE"}]]]]]]],["cat","\"\\n\""],["invisible","x"]]]],["<-","deviance.glm",["function",[{"object":"","...":""}],["$","object","deviance"]]],["<-","effects.glm",["function",[{"object":"","...":""}],["$","object","effects"]]],["<-","family.glm",["function",[{"object":"","...":""}],["$","object","family"]]],["<-","residuals.glm",["function",[{"object":"","type":["c","\"deviance\"","\"pearson\"","\"working\"","\"response\"","\"partial\""],"...":""}],["{",["<-","type",["match.arg","type"]],["<-","y",["$","object","y"]],["<-","r",["$","object","residuals"]],["<-","mu",["$","object","fitted.values"]],["<-","wts",["$","object","prior.weights"]],["switch","type",{"deviance":""},{"pearson":""},{"response":["if",["is.null","y"],["{",["<-","mu.eta",["$",["$","object","family"],"mu.eta"]],["<-","eta",["$","object","linear.predictors"]],["<-","y",["+","mu",["*","r",["mu.eta","eta"]]]]]]}],["<-","res",["switch","type",{"deviance":["if",[">",["$","object","df.residual"],"0"],["{",["<-","d.res",["sqrt",["pmax",[["(",["$",["$","object","family"],"dev.resids"]],"y","mu","wts"],"0"]]],["ifelse",[">","y","mu"],"d.res",["-","d.res"]]],["rep.int","0",["length","mu"]]]},{"pearson":["/",["*",["(",["-","y","mu"]],["sqrt","wts"]],["sqrt",[["$",["$","object","family"],"variance"],"mu"]]]},{"working":"r"},{"response":["-","y","mu"]},{"partial":"r"}]],["if",["!",["is.null",["$","object","na.action"]]],["<-","res",["naresid",["$","object","na.action"],"res"]]],["if",["==","type","\"partial\""],["<-","res",["+","res",["predict","object",{"type":"\"terms\""}]]]],"res"]]],["<-","model.frame.glm",["function",[{"formula":"","...":""}],["{",["<-","dots",["list","..."]],["<-","nargs",["[","dots",["match",["c","\"data\"","\"na.action\"","\"subset\""],["names","dots"],"0L"]]],["if",["||",["length","nargs"],["is.null",["$","formula","model"]]],["{",["<-","fcall",["$","formula","call"]],["<-",["$","fcall","method"],"\"model.frame\""],["<-",["[[","fcall","1L"],["quote",["::","stats","glm"]]],["<-",["[","fcall",["names","nargs"]],"nargs"],["<-","env",["environment",["$","formula","terms"]]],["if",["is.null","env"],["<-","env",["parent.frame",{}]]],["eval","fcall","env"]],["$","formula","model"]]]]],["<-","weights.glm",["function",[{"object":"","type":["c","\"prior\"","\"working\""],"...":""}],["{",["<-","type",["match.arg","type"]],["<-","res",["if",["==","type","\"prior\""],["$","object","prior.weights"],["$","object","weights"]]],["if",["is.null",["$","object","na.action"]],"res",["naresid",["$","object","na.action"],"res"]]]]],["<-","formula.glm",["function",[{"x":"","...":""}],["{",["<-","form",["$","x","formula"]],["if",["!",["is.null","form"]],["{",["<-","form",["formula",["$","x","terms"]]],["<-",["environment","form"],["environment",["$","x","formula"]]],"form"],["formula",["$","x","terms"]]]]]]]
