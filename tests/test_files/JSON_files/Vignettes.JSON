[[],["<-","vignette_is_tex",["function",[{"file":"","...":""}],["{",["(",["!=",["regexpr","\"[.]tex$\"","file",{"ignore.case":"TRUE"}],["-","1L"]]]]]],["<-","vignette_type",["function",[{"file":""}],["{",["<-","ext",["tolower",["file_ext","file"]]],["<-","type",["[",["c",{"pdf":"\"PDF\""},{"html":"\"HTML\""}],"ext"]],["if",["is.na","type"],["stop",["gettextf","\"Vignette product %s does not have a known filename extension (%s)\"",["sQuote","file"],["paste",["sQuote",["names","type"]],{"collapse":"\", \""}]],{"domain":"NA"}]],["unname","type"]]]],["<-","find_vignette_product",["function",[{"name":"","by":["c","\"weave\"","\"tangle\"","\"texi2pdf\""],"final":"FALSE","main":"TRUE","dir":"\".\"","engine":"","...":""}],["{",["stopifnot",["==",["length","name"],"1L"],["dir.exists","dir"]],["<-","by",["match.arg","by"]],["<-","exts",["switch","by",{"\"weave\"":["if","final",["c","\"pdf\"","\"html\""],["c","\"pdf\"","\"html\"","\"tex\""]]},{"\"tangle\"":["c","\"r\"","\"s\""]},{"\"texi2pdf\"":"\"pdf\""}]],["<-","exts",["c","exts",["toupper","exts"]]],["<-","pattern1",["sprintf","\"^%s[.](%s)$\"","name",["paste","exts",{"collapse":"\"|\""}]]],["<-","output0",["list.files",{"path":"dir"},{"all.files":"FALSE"},{"full.names":"FALSE"},{"no..":"TRUE"}]],["<-","output0",["[","output0",["file_test","\"-f\"",["file.path","dir","output0"]]]],["<-","output",["grep","pattern1","output0",{"value":"TRUE"}]],["if",["!","main"],["{",["<-","pattern2",["sprintf","\"^%s.*[.](%s)$\"","name",["paste","exts",{"collapse":"\"|\""}]]],["<-","output2",["grep","pattern2","output0",{"value":"TRUE"}]],["<-","output",["c","output",["setdiff","output2","output"]]]]],["if",["==","by","\"weave\""],["{",["if",["==",["length","output"],"0L"],["stop",["gettextf","\"Failed to locate the %s output file (by engine %s) for vignette with name %s. The following files exist in directory %s: %s\"",["sQuote","by"],["sQuote",["sprintf","\"%s::%s\"",["$","engine","package"],["$","engine","name"]]],["sQuote","name"],["sQuote","dir"],["paste",["sQuote","output0"],{"collapse":"\", \""}]],{"domain":"NA"}]],["if",["||",[">",["length","output"],"2L"],["(",["&&","final",[">",["length","output"],"1L"]]]],["stop",["gettextf","\"Located more than one %s output file (by engine %s) for vignette with name %s: %s\"",["sQuote","by"],["sQuote",["sprintf","\"%s::%s\"",["$","engine","package"],["$","engine","name"]]],["sQuote","name"],["paste",["sQuote","output"],{"collapse":"\", \""}]],{"domain":"NA"}]],["if",["==",["length","output"],"2L"],["{",["<-","idxs",["match",["tolower",["file_ext","output"]],"exts"]],["<-","output",["[","output",["order","idxs"]]],["if",["file_test","\"-nt\"",["[","output","2L"],["[","output","1L"]],["<-","output",["[","output","2L"]],["<-","output",["[","output","1L"]]]]]],["if",["==","by","\"tangle\""],["{",["if","main",["stopifnot",["<=",["length","output"],"1L"]]]],["if",["==","by","\"texi2pdf\""],["{",["if",["==",["length","output"],"0L"],["stop",["gettextf","\"Failed to locate the %s output file (by engine %s) for vignette with name %s. The following files exist in directory %s: %s\"",["sQuote","by"],["sQuote",["sprintf","\"%s::%s\"",["$","engine","package"],["$","engine","name"]]],["sQuote","name"],["sQuote","dir"],["paste",["sQuote","output0"],{"collapse":"\", \""}]],{"domain":"NA"}]],["if",[">",["length","output"],"1L"],["stop",["gettextf","\"Located more than one %s output file (by engine %s) for vignette with name %s: %s\"",["sQuote","by"],["sQuote",["sprintf","\"%s::%s\"",["$","engine","package"],["$","engine","name"]]],["sQuote","name"],["paste",["sQuote","output"],{"collapse":"\", \""}]],{"domain":"NA"}]]]]]],["if",[">",["length","output"],"0L"],["{",["if",["==","dir","\".\""],["basename","output"],["file.path","dir","output"]]]]]]],["<-","checkVignettes",["function",[{"package":"","dir":"","lib.loc":"NULL","tangle":"TRUE","weave":"TRUE","latex":"FALSE","workdir":["c","\"tmp\"","\"src\"","\"cur\""],"keepfiles":"FALSE"}],["{",["<-","vigns",["pkgVignettes",{"package":"package"},{"dir":"dir"},{"lib.loc":"lib.loc"}]],["if",["is.null","vigns"],["return","NULL"]],["<-","workdir",["match.arg","workdir"]],["<-","wd",["getwd",{}]],["if",["is.null","wd"],["stop","\"current working directory cannot be ascertained\""]],["if",["==","workdir","\"tmp\""],["{",["<-","tmpd",["tempfile","\"Sweave\""]],["if",["!",["dir.create","tmpd"]],["stop",["gettextf","\"unable to create temp directory %s \"",["sQuote","tmpd"]],{"domain":"NA"}]],["setwd","tmpd"]],["{",["<-","keepfiles","TRUE"],["if",["==","workdir","\"src\""],["setwd",["$","vigns","dir"]]]]],["on.exit",["{",["setwd","wd"],["if",["!","keepfiles"],["unlink","tmpd",{"recursive":"TRUE"}]]]],["file.create","\".check.timestamp\""],["<-","result",["list",{"tangle":["list",{}]},{"weave":["list",{}]},{"source":["list",{}]},{"latex":["list",{}]}]],["loadVignetteBuilder",["$","vigns","pkgdir"]],["<-","startdir",["getwd",{}]],["for","i",["seq_along",["$","vigns","docs"]],["{",["<-","file",["[",["$","vigns","docs"],"i"]],["<-","file",["basename","file"]],["<-","name",["[",["$","vigns","names"],"i"]],["<-","engine",["vignetteEngine",["[",["$","vigns","engines"],"i"]]],["<-","enc",["[",["$","vigns","encodings"],"i"]],["if",["==","enc","\"non-ASCII\""],["stop",["gettextf","\"Vignette '%s' is non-ASCII but has no declared encoding\"","name"],{"domain":"NA"}]],["if","tangle",["{",["message","\"  Running \"",["sQuote","file"]],[".eval_with_capture",["{",["<-",["[[",["$","result","tangle"],"file"],["tryCatch",["{",[["$","engine","tangle"],"file",{"quiet":"TRUE"},{"encoding":"enc"}],["setwd","startdir"],["find_vignette_product","name",{"by":"\"tangle\""},{"main":"FALSE"},{"engine":"engine"}]],{"error":["function",[{"e":""}],"e"]}]]]]]],["if","weave",["{",["setwd","startdir"],[".eval_with_capture",["{",["<-",["[[",["$","result","weave"],"file"],["tryCatch",["{",[["$","engine","weave"],"file",{"quiet":"TRUE"},{"encoding":"enc"}],["setwd","startdir"],["find_vignette_product","name",{"by":"\"weave\""},{"engine":"engine"}]],{"error":["function",[{"e":""}],"e"]}]]]]]],["setwd","startdir"]]],["for","name",["c","\"weave\"","\"tangle\""],["{",["<-","resultsT",["[[","result","name"]],["if",["<=",["length","resultsT"],"1L"],["next"]],["for","i",[":","1L",["(",["-",["length","resultsT"],"1L"]]],["{",["<-","outputsI",["[[","resultsT","i"]],["if",["inherits","outputsI","\"error\""],["next"]],["<-","outputsI",["normalizePath","outputsI"]],["for","j",[":",["(",["+","i","1L"]],["length","resultsT"]],["{",["<-","outputsJ",["[[","resultsT","j"]],["if",["inherits","outputsJ","\"error\""],["next"]],["<-","outputsJ",["normalizePath","outputsJ"]],["<-","bad",["intersect","outputsJ","outputsI"]],["if",[">",["length","bad"],"0L"],["{",["stop",["gettextf","\"Vignette %s overwrites the following %s output by vignette %s: %s\"",["sQuote",["basename",["[",["names","resultsT"],"j"]]],["sQuote","name"],["sQuote",["basename",["[",["names","resultsT"],"i"]]],["paste",["basename","bad"],{"collapse":"\", \""}]],{"domain":"NA"}]]]]]]]]],["if","tangle",["{",["<-","cwd",["getwd",{}]],["if",["is.null","cwd"],["stop","\"current working directory cannot be ascertained\""]],["for","i",["seq_along",["$","result","tangle"]],["{",["<-","sources",["[[",["$","result","tangle"],"i"]],["if",["inherits","sources","\"error\""],["next"]],["<-","sources",["[","sources",["file_test","\"-nt\"","sources","\".check.timestamp\""]]],["for","file","sources",["{",[".eval_with_capture",["{",["<-",["[[",["$","result","source"],"file"],["tryCatch",["{",["source","file"]],{"error":["function",[{"e":""}],"e"]}]]]],["setwd","startdir"]]]]]]],["if",["&&","weave","latex"],["{",["if",["%notin%","\"Makefile\"",["list.files",["$","vigns","dir"]]],["{",["for","i",["seq_along",["$","result","weave"]],["{",["<-","file",["[",["names",["$","result","weave"]],"i"]],["<-","output",["[",["$","result","weave"],"i"]],["if",["inherits","output","\"error\""],["next"]],["if",["!",["vignette_is_tex","output"]],["next"]],[".eval_with_capture",["{",["<-",["[[",["$","result","latex"],"file"],["tryCatch",["{",["texi2pdf",{"file":"output"},{"clean":"FALSE"},{"quiet":"TRUE"}],["find_vignette_product","name",{"by":"\"texi2pdf\""},{"engine":"engine"}]],{"error":["function",[{"e":""}],"e"]}]]]]]]]]]],["for","name",["c","\"tangle\"","\"weave\"","\"source\"","\"latex\""],["{",["<-","resultsT",["[[","result","name"]],["<-","resultsT",["lapply","resultsT",{"FUN":["function",[{"res":""}],["{",["if",["inherits","res","\"error\""],["conditionMessage","res"],"NULL"]]]}]],["<-","resultsT",["[","resultsT",["!",["vapply","resultsT","is.null","NA"]]]],["<-",["[[","result","name"],"resultsT"]]],["file.remove","\".check.timestamp\""],["<-",["class","result"],"\"checkVignettes\""],"result"]]],["<-","print.checkVignettes",["function",[{"x":"","...":""}],["{",["<-","mycat",["function",[{"y":"","title":""}],["{",["if",["length","y"],["{",["cat","\"\\n\"","title","\"\\n\\n\"",{"sep":"\"\""}],["for","k",["seq_along","y"],["{",["cat","\"File\"",["[",["names","y"],"k"],"\":\\n\""],["cat",["as.character",["[[","y","k"]],"\"\\n\""]]]]]]]],["mycat",["$","x","tangle"],"\"*** Tangle Errors ***\""],["mycat",["$","x","source"],"\"*** Source Errors ***\""],["mycat",["$","x","weave"],"\"*** Weave Errors ***\""],["mycat",["$","x","latex"],"\"*** PDFLaTeX Errors ***\""],["invisible","x"]]]],["<-","getVignetteEngine",["function",[{"filename":"","lines":["readLines","filename",{"warn":"FALSE"}]}],["{",["[",["c",[".get_vignette_metadata","lines","\"Engine\""],"\"utils::Sweave\""],"1L"]]]],["<-","engineMatches",["function",[{"regengine":"","vigengine":""}],["{",["if",["!",["grepl","\"::\"","vigengine"]],["<-","regengine",["sub","\"^.*::\"","\"\"","regengine"]]],["==","regengine","vigengine"]]]],["<-","pkgVignettes",["function",[{"package":"","dir":"","subdirs":"NULL","lib.loc":"NULL","output":"FALSE","source":"FALSE","check":"FALSE"}],["{",["if",["!",["missing","package"]],["{",["if",["!=",["length","package"],"1L"],["stop","\"argument 'package' must be of length 1\""]],["<-","dir",["find.package","package","lib.loc"]]]],["if",["missing","dir"],["stop","\"you must specify 'package' or 'dir'\""]],["if",["!",["dir.exists","dir"]],["stop",["gettextf","\"directory '%s' does not exist\"","dir"],{"domain":"NA"}],["{",["<-","dir",["file_path_as_absolute","dir"]],["if",["is.null","subdirs"],["<-","subdirs",["if",["missing","package"],"\"vignettes\"","\"doc\""]]],["for","subdir","subdirs",["{",["<-","docdir",["file.path","dir","subdir"]],["if",["dir.exists","docdir"],["break"]]]]]],["if",["!",["dir.exists","docdir"]],["return","NULL"]],["<-","buildPkgs",["loadVignetteBuilder","dir",{"mustwork":"FALSE"}]],["<-","engineList",["vignetteEngine",{"package":"buildPkgs"}]],["<-","docs",["<-","names",["<-","engines",["<-","patterns",["character",{}]]]]],["<-","allFiles",["list.files","docdir",{"all.files":"FALSE"},{"full.names":"TRUE"}]],["<-","exclude",["inRbuildignore",["sub",["paste0","dir","\"/\""],"\"\"","allFiles",{"fixed":"TRUE"}],"dir"]],["<-","allFiles",["[","allFiles",["!","exclude"]]],["<-","matchedPattern",["rep.int","FALSE",["length","allFiles"]]],["<-","msg",["character",{}]],["if",[">",["length","allFiles"],"0L"],["{",["for","name",["names","engineList"],["{",["<-","engine",["[[","engineList","name"]],["for","pattern",["$","engine","pattern"],["{",["<-","idxs",["grep","pattern","allFiles"]],["<-",["[","matchedPattern","idxs"],"TRUE"],["<-","keep",["vapply",["[","allFiles","idxs"],["function",[{".d.":""}],["engineMatches","name",["getVignetteEngine",".d."]]],"NA"]],["if",["any","keep"],["{",["<-","idxs",["[","idxs","keep"]],["if",["is.function",["$","engine","weave"]],["{",["<-","docsT",["[","allFiles","idxs"]],["<-","docs",["c","docs","docsT"]],["<-","names",["c","names",["gsub","pattern","\"\"",["basename","docsT"]]]],["<-","engines",["c","engines",["rep.int","name",["length","idxs"]]]],["<-","patterns",["c","patterns",["rep.int","pattern",["length","idxs"]]]]]],["<-","matchedPattern",["[","matchedPattern",["-","idxs"]]],["<-","allFiles",["[","allFiles",["-","idxs"]]],["if",["==",["length","allFiles"],"0L"],["break"]]]]]]]],["if",["&&","check",["any","matchedPattern"]],["{",["<-","files",["substring",["[","allFiles","matchedPattern"],["+",["nchar","dir"],"2"]]],["<-","msg",["c","\"Files named as vignettes but with no recognized vignette engine:\"",["paste","\"  \"",["sQuote","files"]],"\"(Is a VignetteBuilder field missing?)\""]]]]]],["stopifnot",["==",["length","names"],["length","docs"]],["==",["length","engines"],["length","docs"]],["==",["length","patterns"],["length","docs"]],["!",["anyDuplicated","docs"]]],["<-","defaultEncoding",["[",[".get_package_metadata","dir"],"\"Encoding\""]],["<-","encodings",["vapply","docs","getVignetteEncoding","\"\"",{"default":"defaultEncoding"}]],["<-","z",["list",{"docs":"docs"},{"names":"names"},{"engines":"engines"},{"patterns":"patterns"},{"encodings":"encodings"},{"dir":"docdir"},{"pkgdir":"dir"},{"msg":"msg"}]],["if","output",["{",["<-","outputs",["character",["length","docs"]]],["for","i",["seq_along","docs"],["{",["<-","file",["[","docs","i"]],["<-","name",["[","names","i"]],["<-","outputI",["find_vignette_product","name",{"by":"\"weave\""},{"dir":"docdir"},{"engine":"engine"}]],["<-",["[","outputs","i"],"outputI"]]],["<-",["$","z","outputs"],"outputs"]]],["if","source",["{",["<-","sources",["list",{}]],["for","i",["seq_along","docs"],["{",["<-","file",["[","docs","i"]],["<-","name",["[","names","i"]],["<-","sourcesI",["find_vignette_product","name",{"by":"\"tangle\""},{"main":"FALSE"},{"dir":"docdir"},{"engine":"engine"}]],["<-",["[[","sources","file"],"sourcesI"]]],["<-",["$","z","sources"],"sources"]]],["<-",["class","z"],"\"pkgVignettes\""],"z"]]],["<-","buildVignettes",["function",[{"package":"","dir":"","lib.loc":"NULL","quiet":"TRUE","clean":"TRUE","tangle":"FALSE","ser_elibs":"NULL"}],["{",["<-","separate",["!",["is.null","ser_elibs"]]],["if","separate",["<-","elibs",["readRDS","ser_elibs"]]],["<-","vigns",["pkgVignettes",{"package":"package"},{"dir":"dir"},{"lib.loc":"lib.loc"},{"check":"TRUE"}]],["if",["is.null","vigns"],["return",["invisible",{}]]],["if",["<=",["length",["$","vigns","docs"]],"1L"],["<-","separate","FALSE"]],["if",["length",["$","vigns","msg"]],["warning",["paste",["$","vigns","msg"],{"collapse":"\"\\n\""}],{"domain":"NA"}]],["<-","dups",["duplicated",["$","vigns","names"]]],["if",["any","dups"],["{",["<-","names",["unique",["[",["$","vigns","names"],"dups"]]],["<-","docs",["sort",["basename",["[",["$","vigns","docs"],["%in%",["$","vigns","names"],"names"]]]]],["stop",["gettextf","\"Detected vignette source files (%s) with shared names (%s) and therefore risking overwriting each other's output files\"",["paste",["sQuote","docs"],{"collapse":"\", \""}],["paste",["sQuote","names"],{"collapse":"\", \""}]],{"domain":"NA"}]]],["<-","titles",["character",{}]],["for","d",["$","vigns","docs"],["{",["<-","this",["[",["c",[".get_vignette_metadata",["readLines","d",{"warn":"FALSE"}],"\"IndexEntry\""],"\"\""],"1L"]],["<-","titles",["c","titles","this"]]]],["<-","have_dup_titles",["if",["any",["<-","dup",["duplicated","titles"]]],["{",["<-","dups",["unique",["[","titles","dup"]]],["message",["ngettext",["length","dups"],"\"duplicated vignette title:\"","\"duplicated vignette titles:\""]],["message",["paste",[".pretty_format","dups"],{"collapse":"\"\\n\""}]],["message",{}],"TRUE"],"FALSE"]],["Sys.unsetenv","\"SWEAVE_STYLEPATH_DEFAULT\""],["<-","op",["options",{"warn":"1"}]],["<-","wd",["getwd",{}]],["if",["is.null","wd"],["stop","\"current working directory cannot be ascertained\""]],["on.exit",["{",["setwd","wd"],["options","op"]]],["setwd",["$","vigns","dir"]],["<-","origfiles",["list.files",{"all.files":"TRUE"}]],["<-","have.makefile",["%in%","\"Makefile\"","origfiles"]],["file.create","\".build.timestamp\""],["<-","outputs",["character",{}]],["<-","sourceList",["list",{}]],["<-","startdir",["getwd",{}]],["<-","fails",["character",{}]],["for","i",["seq_along",["$","vigns","docs"]],["{",["<-","thisOK","TRUE"],["<-","file",["basename",["[",["$","vigns","docs"],"i"]]],["<-","enc",["[",["$","vigns","encodings"],"i"]],["if",["==","enc","\"non-ASCII\""],["{",["message",["gettextf","\"Error: Vignette '%s' is non-ASCII but has no declared encoding\"","file"]],["<-","fails",["c","fails","file"]],["next"]]],["<-","name",["[",["$","vigns","names"],"i"]],["<-","engine",["vignetteEngine",["[",["$","vigns","engines"],"i"]]],["if","separate",["{",["<-","tf2",["gsub","\"\\\\\"","\"/\"",["tempfile",{"fileext":"\".rds\""}],{"fixed":"TRUE"}]],["saveRDS","engine","tf2"],["<-","Rcmd",["sprintf","'tools:::.buildOneVignette(\"%s\", \"%s\", %s, %s, \"%s\", \"%s\", \"%s\")'","file",["$","vigns","pkgdir"],"quiet","have.makefile","name","enc","tf2"]],["<-","tlim",["get_timeout",["Sys.getenv","\"_R_CHECK_ONE_VIGNETTE_ELAPSED_TIMEOUT_\"",["Sys.getenv","\"_R_CHECK_ELAPSED_TIMEOUT_\""]]]],["<-","tf",["tempfile",{}]],["<-","status",["R_runR","Rcmd","\"--vanilla --slave\"","elibs",{"stdout":"tf"},{"stderr":"tf"},{"timeout":"tlim"}]],["unlink","tf2"],["if",["!","status"],["{",["<-","this",["readLines","tf"]],["<-","patt","\"^[+]-[+]\""],["<-","l",["grepl","patt","this"]],["<-","output",["gsub","patt","\"\"",["[","this","l"]]],["<-","outputs",["c","outputs","output"]],["cat",["[","this",["!","l"]],{"sep":"\"\\n\""}]],["{",["<-","fails",["c","fails","file"]],["cat",["readLines","tf"],{"sep":"\"\\n\""}]]],["unlink","tf"]],["{",["message",["gettextf","\"--- re-building %s using %s\"",["sQuote","file"],["$","engine","name"]]],["tryCatch",["{",[["$","engine","weave"],"file",{"quiet":"quiet"},{"encoding":"enc"}],["setwd","startdir"],["<-","output",["find_vignette_product","name",{"by":"\"weave\""},{"engine":"engine"}]],["if",["&&",["!","have.makefile"],["vignette_is_tex","output"]],["{",["texi2pdf",{"file":"output"},{"clean":"FALSE"},{"quiet":"quiet"}],["<-","output",["find_vignette_product","name",{"by":"\"texi2pdf\""},{"engine":"engine"}]]]],["<-","outputs",["c","outputs","output"]]],{"error":["function",[{"e":""}],["{",["<<-","thisOK","FALSE"],["<<-","fails",["c","fails","file"]],["message",["gettextf","\"Error: processing vignette '%s' failed with diagnostics:\\n%s\"","file",["conditionMessage","e"]]]]]}]]],["if",["&&","tangle",["!","separate"]],["{",["<-","output",["tryCatch",["{",[["$","engine","tangle"],"file",{"quiet":"quiet"},{"encoding":"enc"}],["setwd","startdir"],["find_vignette_product","name",{"by":"\"tangle\""},{"main":"FALSE"},{"engine":"engine"}]],{"error":["function",[{"e":""}],["{",["<<-","thisOK","FALSE"],["<<-","fails",["c","fails","file"]],["message",["gettextf","\"Error: tangling vignette '%s' failed with diagnostics:\\n%s\"","file",["conditionMessage","e"]]]]]}]],["<-",["[[","sourceList","file"],"output"]]],["if",["!","separate"],["{",["if","thisOK",["message",["gettextf","\"--- finished re-building %s\\n\"",["sQuote","file"]]],["message",["gettextf","\"--- failed re-building %s\\n\"",["sQuote","file"]]]]]]]],["if","have.makefile",["{",["<-","WINDOWS",["==",["$",".Platform","OS.type"],"\"windows\""]],["if","WINDOWS",["{",["<-","rhome",["chartr","\"\\\\\"","\"/\"",["R.home",{}]]],["Sys.setenv",{"R_HOME":"rhome"}]]],["<-","make",["Sys.getenv","\"MAKE\"","\"make\""]],["if",["!",["nzchar","make"]],["<-","make","\"make\""]],["<-","yy",["system","make"]],["if",[">","yy","0"],["stop","\"running 'make' failed\""]],["if",["&&","clean",["any",["startsWith",["readLines","\"Makefile\"",{"warn":"FALSE"}],"\"clean:\""]]],["system",["paste","make","\"clean\""]]]],["{",[["::","grDevices","graphics.off"],{}],["<-","keep",["c","outputs",["unlist","sourceList"]]],["if","clean",["{",["<-","f",["setdiff",["list.files",{"all.files":"TRUE"},{"no..":"TRUE"}],"keep"]],["<-","newer",["file_test","\"-nt\"","f","\".build.timestamp\""]],["unlink",["[","f","newer"],{"recursive":"TRUE"}],["<-","f",["setdiff",["list.files",{"all.files":"TRUE"},{"no..":"TRUE"}],["c","keep","origfiles"]]],["<-","f",["[","f",["file_test","\"-f\"","f"]]],["file.remove","f"]]]]],["if",["file.exists","\".build.timestamp\""],["file.remove","\".build.timestamp\""]],["if",["length","fails"],["{",["message",["ngettext",["length","fails"],"\"SUMMARY: processing the following file failed:\"","\"SUMMARY: processing the following files failed:\""]],["message",["paste",[".pretty_format","fails"],{"collapse":"\"\\n\""}]],["message",{}]]],["<-","msg2",["paste","\"Duplicate vignette titles.\"","\"  Ensure that the %\\\\VignetteIndexEntry lines in the vignette sources\"","\"  correspond to the vignette titles.\"",{"sep":"\"\\n\""}]],["if",["||",["length","fails"],["(",["!=",["length","outputs"],["length",["$","vigns","docs"]]]]],["{",["<-","msg","\"Vignette re-building failed.\""],["if","have_dup_titles",["<-","msg",["paste0","msg","\"\\nError: \"","msg2"]]],["stop","msg",{"domain":"NA"},{"call.":"FALSE"}]]],["if","have_dup_titles",["stop","msg2",{"domain":"NA"},{"call.":"FALSE"}]],["<-",["$","vigns","outputs"],"outputs"],["<-",["$","vigns","sources"],"sourceList"],["invisible","vigns"]]]],["<-","buildVignette",["function",[{"file":"","dir":"\".\"","weave":"TRUE","latex":"TRUE","tangle":"TRUE","quiet":"TRUE","clean":"TRUE","keep":["character",{}],"engine":"NULL","buildPkg":"NULL","encoding":["getVignetteEncoding","file"],"...":""}],["{",["if",["!",["file_test","\"-f\"","file"]],["stop",["gettextf","\"file '%s' not found\"","file"],{"domain":"NA"}]],["if",["!",["dir.exists","dir"]],["stop",["gettextf","\"directory '%s' does not exist\"","dir"],{"domain":"NA"}]],["if",["!",["is.null","buildPkg"]],["for","pkg","buildPkg",["suppressPackageStartupMessages",["loadNamespace","pkg"]]]],["if",["is.null","engine"],["<-","engine",["getVignetteEngine","file"]]],["if",["is.character","engine"],["<-","engine",["vignetteEngine","engine",{"package":"buildPkg"}]]],["<-","names",["sapply",["$","engine","pattern"],{"FUN":"sub"},"\"\"","file"]],["<-","name",["basename",["[",["[","names",["(",["!=","names","file"]]],"1L"]]],["if",["is.na","name"],["stop",["gettextf","\"vignette filename '%s' does not match any of the '%s' filename patterns\"","file",["paste",["$","engine","package"],["$","engine","name"],{"sep":"\"::\""}]],{"domain":"NA"}]],["if",["==","encoding","\"non-ASCII\""],["stop",["gettextf","\"Vignette '%s' is non-ASCII but has no declared encoding\"","name"]]],["<-","file",["file_path_as_absolute","file"]],["<-","olddir",["setwd","dir"]],["if",["!",["is.null","olddir"]],["on.exit",["setwd","olddir"]]],["if",["||",["is.na","clean"],"clean"],["{",["file.create","\".build.timestamp\""]]],["<-","tdir",["getwd",{}]],["<-","output","NULL"],["<-","final",["if","weave",["{",[["$","engine","weave"],"file",{"quiet":"quiet"},{"encoding":"encoding"},"..."],["setwd","tdir"],["<-","output",["find_vignette_product","name",{"by":"\"weave\""},{"engine":"engine"}]],["if",["&&","latex",["vignette_is_tex","output"]],["{",["texi2pdf",{"file":"output"},{"clean":"FALSE"},{"quiet":"quiet"}],["find_vignette_product","name",{"by":"\"texi2pdf\""},{"engine":"engine"}]],"output"]]]],["<-","sources",["if","tangle",["{",[["$","engine","tangle"],"file",{"quiet":"quiet"},{"encoding":"encoding"},"..."],["setwd","tdir"],["find_vignette_product","name",{"by":"\"tangle\""},{"main":"FALSE"},{"engine":"engine"}]]]],["<-","keep",["c","sources","final","keep"]],["if",["is.na","clean"],["{",["<-","keep",["c","keep","output"]],["<-","clean","TRUE"]]],["if","clean",["{",["<-","f",["setdiff",["list.files",{"all.files":"TRUE"},{"no..":"TRUE"}],"keep"]],["<-","newer",["file_test","\"-nt\"","f","\".build.timestamp\""]],["unlink",["[","f","newer"],{"recursive":"TRUE"}]]],["if",["&&",["(",["||",["is.na","clean"],"clean"]],["file.exists","\".build.timestamp\""]],["{",["file.remove","\".build.timestamp\""]]],["unique","keep"]]]],["<-",".buildOneVignette",["function",[{"file":"","pkgdir":"","quiet":"TRUE","have.makefile":"FALSE","name":"","enc":"","ser_engine":""}],["{",["<-","op",["options",{"warn":"1"}]],["<-","engine",["readRDS","ser_engine"]],["loadVignetteBuilder","pkgdir"],["<-","OK","TRUE"],["<-","startdir",["getwd",{}]],["<-","output",["character",{}]],["message",["gettextf","\"--- re-building %s using %s\"",["sQuote","file"],["$","engine","name"]]],["tryCatch",["{",[["$","engine","weave"],"file",{"quiet":"quiet"},{"encoding":"enc"}],["setwd","startdir"],["<-","output",["find_vignette_product","name",{"by":"\"weave\""},{"engine":"engine"}]],["if",["&&",["!","have.makefile"],["vignette_is_tex","output"]],["{",["texi2pdf",{"file":"output"},{"clean":"FALSE"},{"quiet":"quiet"}],["<-","output",["find_vignette_product","name",{"by":"\"texi2pdf\""},{"engine":"engine"}]]]]],{"error":["function",[{"e":""}],["{",["<<-","OK","FALSE"],["message",["gettextf","\"Error: processing vignette '%s' failed with diagnostics:\\n%s\"","file",["conditionMessage","e"]]]]]}],["if","OK",["message",["gettextf","\"--- finished re-building %s\\n\"",["sQuote","file"]]],["{",["message",["gettextf","\"--- failed re-building %s\\n\"",["sQuote","file"]]],["q","\"no\"",{"status":"9L"}]]],["message","\"+-+\"","output"],["invisible","output"]]]],["<-","getVignetteEncoding",["function",[{"file":"","...":""}],["{",["<-","lines",["readLines","file",{"warn":"FALSE"}]],[".getVignetteEncoding","lines","..."]]]],["<-",".getVignetteEncoding",["function",[{"lines":"","default":"NA"}],["{",["<-","res",["[",[".get_vignette_metadata","lines","\"Encoding\""],"1L"]],["if",["is.na","res"],["{",["<-","poss",["grep","\"^[[:space:]]*%+[[:space:]]*\\\\\\\\SweaveUTF8[[:space:]]*$\"","lines",{"useBytes":"TRUE"}]],["if",["length","poss"],"\"UTF-8\"",["{",["<-","poss",["grep","\"^[[:space:]]*\\\\\\\\usepackage\\\\[([[:alnum:]]+)\\\\]\\\\{inputen[cx]\\\\}\"","lines",{"useBytes":"TRUE"}]],["<-","start",["grep","\"^[[:space:]]*\\\\\\\\begin\\\\{document\\\\}\"","lines",{"useBytes":"TRUE"}]],["if",["length","start"],["<-","poss",["[","poss",["<","poss",["[","start","1L"]]]]],["if",["length","poss"],["{",["<-","poss",["[","lines",["[","poss","1L"]]],["<-","res",["gsub","\"^[[:space:]]*\\\\\\\\usepackage\\\\[([[:alnum:]]+)\\\\].*\"","\"\\\\1\"","poss"]],["switch","res",{"\"utf8\"":""},{"\"utf8x\"":"\"UTF-8\""},{"\"latin1\"":""},{"\"iso-8859-1\"":"\"latin1\""},{"\"latin2\"":""},{"\"iso-8859-2\"":"\"latin2\""},{"\"latin9\"":""},{"\"iso-8859-15\"":"\"latin-9\""},{"\"latin10\"":""},{"\"iso-8859-16\"":"\"latin10\""},{"\"cyrillic\"":""},{"\"iso-8859-5\"":"\"ISO-8859-5\""},{"\"koi8-r\"":"\"KOI8-R\""},{"\"arabic\"":"\"ISO-8859-6\""},{"\"greek\"":""},{"\"iso-8859-7\"":"\"ISO-8859-7\""},{"\"hebrew\"":""},{"\"iso-8859-8\"":"\"ISO-8859-8\""},{"\"ansinew\"":"\"CP1252\""},{"\"applemac\"":"\"macroman\""},{"\"cp1250\"":"\"CP1250\""},{"\"cp1252\"":"\"CP1252\""},{"\"cp1257\"":"\"CP1257\""},"\"unknown\""]],["if",["!",["is.na","default"]],["{","default"],["{",["<-","asc",["iconv","lines","\"latin1\"","\"ASCII\""]],["if",["||",["anyNA","asc"],["any",["!=","asc","lines"]]],"\"non-ASCII\"","\"\""]]]]]]],"res"]]]],["<-",".get_vignette_metadata",["function",[{"lines":"","tag":""}],["{",["<-","meta_RE",["paste0","\"[[:space:]]*%+[[:space:]]*\\\\\\\\Vignette\"","tag","\"\\\\{([^}]*(\\\\{[^}]*\\\\})*[^}]*)\\\\}.*\""]],["<-","meta",["grep","meta_RE","lines",{"value":"TRUE"},{"useBytes":"TRUE"}]],["trimws",["gsub","meta_RE","\"\\\\1\"","meta"]]]]],["<-","vignetteInfo",["function",[{"file":""}],["{",["<-","lines",["readLines","file",{"warn":"FALSE"}]],["<-",["[","lines",["is.na",["nchar","lines","\"c\"","TRUE"]]],"\"\""],["<-","title",["[",["c",[".get_vignette_metadata","lines","\"IndexEntry\""],"\"\""],"1L"]],["<-","depends",[".get_vignette_metadata","lines","\"Depends\""]],["if",["length","depends"],["<-","depends",["unlist",["strsplit",["[","depends","1L"],"\", *\""]]]],["<-","keywords",[".get_vignette_metadata","lines","\"Keywords\""]],["<-","keywords",["if",["!",["length","keywords"]],["{",[".get_vignette_metadata","lines","\"Keyword\""]],["unlist",["strsplit",["[","keywords","1L"],"\", *\""]]]],["<-","engine",["getVignetteEngine",{"lines":"lines"}]],["list",{"file":["basename","file"]},{"title":"title"},{"depends":"depends"},{"keywords":"keywords"},{"engine":"engine"}]]]],["<-",".build_vignette_index",["function",[{"vigns":""}],["{",["stopifnot",["inherits","vigns","\"pkgVignettes\""]],["<-","files",["$","vigns","docs"]],["<-","names",["$","vigns","names"]],["<-","dir",["$","vigns","dir"]],["<-","sources",["$","vigns","sources"]],["if",["!",["dir.exists","dir"]],["stop",["gettextf","\"directory '%s' does not exist\"","dir"],{"domain":"NA"}]],["<-","nvigns",["length","files"]],["if",["==","nvigns","0L"],["{",["<-","out",["data.frame",{"File":["character",{}]},{"Title":["character",{}]},{"PDF":["character",{}]},{"R":["character",{}]},{"stringsAsFactors":"FALSE"}]],["<-",["$","out","Depends"],["list",{}]],["<-",["$","out","Keywords"],["list",{}]],["return","out"]]],["if",["any",["<-","dups",["duplicated","names"]]],["{",["<-","dupname",["[",["[","names","dups"],"1L"]],["<-","dup",["basename",["[",["[","files","dups"],"1L"]]],["<-","orig",["basename",["[",["[","files",["==","names","dupname"]],"1L"]]],["stop",["gettextf","\"In '%s' vignettes '%s' and '%s' have the same vignette name\"",["basename",["dirname","dir"]],"orig","dup"],{"domain":"NA"}]]],["<-","contents",["vector","\"list\"",{"length":["*","nvigns","5L"]}]],["<-",["dim","contents"],["c","nvigns","5L"]],["for","i",["seq_along","files"],["<-",["[","contents","i",{}],["vignetteInfo",["[","files","i"]]]],["<-",["colnames","contents"],["c","\"File\"","\"Title\"","\"Depends\"","\"Keywords\"","\"Engine\""]],["<-","outputs",["$","vigns","outputs"]],["<-","outputs",["if",["!",["is.null","outputs"]],["basename","outputs"],["character","nvigns"]]],["<-","out",["data.frame",{"File":["unlist",["[","contents",{},"\"File\""]]},{"Title":["unlist",["[","contents",{},"\"Title\""]]},{"PDF":"outputs"},{"R":"\"\""},{"row.names":"NULL"},{"stringsAsFactors":"FALSE"}]],["for","i",["seq_along","sources"],["if",["length",["<-","s",["[[","sources","i"]]],["<-",["[",["$","out","R"],["which",["==",["[",["names","sources"],"i"],"files"]]],["basename",["[","s","1L"]]]]],["<-",["$","out","Depends"],["[","contents",{},"\"Depends\""]],["<-",["$","out","Keywords"],["[","contents",{},"\"Keywords\""]],["stopifnot",["==",["NROW","out"],"nvigns"]],"out"]]],["<-",".check_vignette_index",["function",[{"vignetteDir":"","pkgdir":"\".\""}],["{",["<-","dir",["file.path","pkgdir","vignetteDir"]],["if",["!",["dir.exists","dir"]],["stop",["gettextf","\"directory '%s' does not exist\"","dir"],{"domain":"NA"}]],["<-","subdir",["gsub","pkgdir","\"\"","dir",{"fixed":"TRUE"}]],["<-","vigns",["pkgVignettes",{"dir":"pkgdir"},{"subdirs":"subdir"}]],["<-","vignetteIndex",[".build_vignette_index","vigns"]],["<-","badEntries",["[","vignetteIndex",["grep","\"^[[:space:]]*$\"",["[","vignetteIndex",{},"\"Title\""]],"\"File\""]],["<-",["class","badEntries"],"\"check_vignette_index\""],"badEntries"]]],["<-","print.check_vignette_index",["function",[{"x":"","...":""}],["{",["if",["length","x"],["{",["writeLines",["c","\"Vignettes with missing or empty \\\\VignetteIndexEntry:\"",["paste0","\"  \"",["basename",["unclass","x"]]]]]]],["invisible","x"]]]],["<-",".writeVignetteHtmlIndex",["function",[{"pkg":"","con":"","vignetteIndex":"NULL"}],["{",["<-","html",["c",["HTMLheader","\"Vignettes and other documentation\""],["paste0","\"<h2>Vignettes from package '\"","pkg","\"'</h2>\""],["if",["==",["NROW","vignetteIndex"],"0L"],"\"The package contains no vignette meta-information.\"",["{",["<-","vignetteIndex",["cbind",{"Package":"pkg"},["as.matrix",["[","vignetteIndex",{},["c","\"File\"","\"Title\"","\"PDF\"","\"R\""]]]]],["makeVignetteTable","vignetteIndex",{"depth":"3L"}]]]]],["<-","otherfiles",["list.files",["system.file","\"doc\"",{"package":"pkg"}]]],["if",["NROW","vignetteIndex"],["<-","otherfiles",["setdiff","otherfiles",["c",["[","vignetteIndex",{},["c","\"PDF\"","\"File\"","\"R\""]],"\"index.html\""]]]],["if",["length","otherfiles"],["{",["<-","otherfiles",["ifelse",["dir.exists",["system.file",["file.path","\"doc\"","otherfiles"],{"package":"pkg"}]],["paste0","otherfiles","\"/\""],"otherfiles"]],["<-","urls",["paste0","'<a href=\"'","otherfiles","'\">'","otherfiles","'</a>'"]],["<-","html",["c","html","'<h2>Other files in the <span class=\"samp\">doc</span> directory</h2>'","'<table width=\"100%\">'","'<col style=\"width: 24%;\" />'","'<col style=\"width: 50%;\" />'","'<col style=\"width: 24%;\" />'",["paste0","'<tr><td></td><td><span class=\"samp\">'",["iconv","urls","\"\"","\"UTF-8\""],"\"</span></td></tr>\""],"\"</table>\""]]]],["<-","html",["c","html","\"</body></html>\""]],["writeLines","html",{"con":"con"}]]]],["<-","getVigDepMtrx",["function",[{"vigDeps":""}],["{",["if",["length","vigDeps"],["{",["<-","z",["unlist",["strsplit","vigDeps","\",\"",{"fixed":"TRUE"}]]],["<-","z",["sub","\"^[[:space:]]*(.*)\"","\"\\\\1\"","z"]],["<-","z",["sub","\"(.*)[[:space:]]*$\"","\"\\\\1\"","z"]],["<-","pat","\"^([^\\\\([:space:]]+)[[:space:]]*\\\\(([^\\\\)]+)\\\\).*\""],["<-","depMtrx",["cbind",["sub","pat","\"\\\\1\"","z"],["sub","pat","\"\\\\2\"","z"],"NA"]],["<-","noversion",["==",["[","depMtrx",{},"1L"],["[","depMtrx",{},"2L"]]],["<-",["[","depMtrx","noversion","2L"],"NA"],["<-","pat","\"[[:space:]]*([[<>=]+)[[:space:]]+(.*)\""],["<-",["[","depMtrx",["!","noversion"],[":","2","3"]],["c",["sub","pat","\"\\\\1\"",["[","depMtrx",["!","noversion"],"2L"]],["sub","pat","\"\\\\2\"",["[","depMtrx",["!","noversion"],"2L"]]]],"depMtrx"],"NA"]]]],["<-",".run_one_vignette",["function",[{"vig_name":"","docDir":"","encoding":"\"\"","pkgdir":""}],["{",["<-","td",["tempfile",{}]],["dir.create","td"],["file.copy","docDir","td",{"recursive":"TRUE"}],["setwd",["file.path","td",["basename","docDir"]]],["<-","subdir",["gsub","pkgdir","\"\"","docDir",{"fixed":"TRUE"}]],["<-","vigns",["pkgVignettes",{"dir":"pkgdir"},{"subdirs":"subdir"}]],["if",["is.null","vigns"],["{",["cat","\"\\n  When running vignette \"",["sQuote","vig_name"],"\":\\n\"",{"sep":"\"\""}],["stop","\"No vignettes available\"",{"call.":"FALSE"},{"domain":"NA"}]]],["<-","i",["which",["==",["basename",["$","vigns","docs"]],"vig_name"]]],["if",["==",["length","i"],"0L"],["{",["cat","\"\\n  When running vignette \"",["sQuote","vig_name"],"\":\\n\"",{"sep":"\"\""}],["stop","\"No such vignette \"",["sQuote","vig_name"],{"call.":"FALSE"},{"domain":"NA"}]]],["stopifnot",["==",["length","i"],"1L"]],["loadVignetteBuilder","pkgdir"],["<-","file",["basename",["[",["$","vigns","docs"],"i"]]],["<-","name",["[",["$","vigns","names"],"i"]],["<-","engine",["vignetteEngine",["[",["$","vigns","engines"],"i"]]],["<-","output",["tryCatch",["{",[["$","engine","tangle"],"file",{"quiet":"TRUE"},{"encoding":"encoding"}],["find_vignette_product","name",{"by":"\"tangle\""},{"engine":"engine"}]],{"error":["function",[{"e":""}],["{",["cat","\"\\n  When tangling \"",["sQuote","file"],"\":\\n\"",{"sep":"\"\""}],["stop",["conditionMessage","e"],{"call.":"FALSE"},{"domain":"NA"}]]]}]],["if",["==",["length","output"],"1L"],["{",["tryCatch",["{",["source","output",{"echo":"TRUE"}]],{"error":["function",[{"e":""}],["{",["cat","\"\\n  When sourcing \"",["sQuote","output"],"\":\\n\"",{"sep":"\"\""}],["stop",["conditionMessage","e"],{"call.":"FALSE"},{"domain":"NA"}]]]}]]],["cat","\"\\n *** Run successfully completed ***\\n\""]]]],["<-","vignetteEngine",["local",["{",["<-","registry",["new.env",{"parent":["emptyenv",{}]}]],["<-","engineKey",["function",[{"name":"","package":""}],["{",["<-","key",["[[",["strsplit","name",{"split":"\"::\""},{"fixed":"TRUE"}],"1L"]],["if",["==",["length","key"],"1L"],["{",["if",["missing","package"],["stop","\"Vignette engine package not specified\"",{"call.":"FALSE"}]],["<-",["[","key","2L"],["[","key","1L"]],["<-",["[","key","1L"],"package"]],["if",["!=",["length","key"],"2L"],["{",["stop","\"Unsupported engine name \"",["sQuote","name"]]]]],"key"]]],["<-","getEngine",["function",[{"name":"","package":""}],["{",["if",["missing","name"],["{",["<-","result",["as.list","registry"]],["if",["&&",[">",["length","result"],"0L"],["!",["is.null","package"]]],["{",["<-","package",["unique","package"]],["<-","pkgs",["sapply","result",["function",[{"engine":""}],["$","engine","package"]]]],["<-","keep",["is.element","pkgs","package"]],["if",["!",["any","keep"]],["{",["stop",["gettextf","\"None of packages %s have registered vignette engines\"",["paste",["sQuote","package"],{"collapse":"\", \""}]],{"domain":"NA"}]]],["<-","result",["[","result","keep"]],["<-","pkgs",["[","pkgs","keep"]],["if",[">",["length","package"],"1L"],["{",["<-","result",["[","result",["order",["match","pkgs","package"]]]]]]]]],["{",["<-","result","NULL"],["if",["is.null","package"],["{",["if",["==","name","\"Sweave\""],["{",["<-","key",["engineKey","name",{"package":"\"utils\""}]]],["{",["<-","key",["engineKey","name"]]]],["suppressPackageStartupMessages",["loadNamespace",["[","key","1"]]],["<-","name",["paste","key",{"collapse":"\"::\""}]],["<-","result",["[[","registry","name"]],["if",["is.null","result"],["stop",["gettextf","\"Vignette engine %s is not registered\"",["sQuote","name"]],{"domain":"NA"}]]],["{",["for","pkg","package",["{",["<-","key",["engineKey","name","pkg"]],["try",["suppressPackageStartupMessages",["loadNamespace",["[","key","1"]]],{"silent":"TRUE"}],["<-","nameT",["paste","key",{"collapse":"\"::\""}]],["<-","result",["[[","registry","nameT"]],["if",["!",["is.null","result"]],["break"]]]],["if",["is.null","result"],["stop",["gettextf","\"Vignette engine %s is not registered by any of the packages %s\"",["sQuote","name"],["paste",["sQuote","package"],{"collapse":"\", \""}]],{"domain":"NA"}]]]],["if",["&&",["!",["is.null","package"]],["!",["is.element",["$","result","package"],"package"]]],["stop",["gettextf","\"Vignette engine %s is not registered by any of the packages %s\"",["sQuote","name"],["paste",["sQuote","package"],{"collapse":"\", \""}]],{"domain":"NA"}]]]],"result"]]],["<-","setEngine",["function",[{"name":"","package":"","pattern":"","weave":"","tangle":"","aspell":["list",{}]}],["{",["<-","key",["engineKey","name","package"]],["if",["&&",["!",["is.null","package"]],["!=",["[","key","1L"],"package"]],["stop",["gettextf","\"Engine name %s and package %s do not match\"",["sQuote","name"],["sQuote","package"]],{"domain":"NA"}]],["<-","rname",["paste","key",{"collapse":"\"::\""}]],["if",["is.null","weave"],["{",["<-","result","NULL"],["if",["exists","rname",{"envir":"registry"}],["rm",{"list":"rname"},{"envir":"registry"}]]],["{",["if",["&&",["!",["is.function","weave"]],["is.na","weave"]],["{",["if",["missing","tangle"],["<-","tangle","NA"]]],["{",["if",["!",["is.function","weave"]],["stop",["gettextf","\"Argument %s must be a function and not %s\"",["sQuote","\"weave\""],["sQuote",["[",["class","weave"],"1L"]]],{"domain":"NA"}]],["if",["!",["is.function","tangle"]],["stop",["gettextf","\"Argument %s must be a function and not %s\"",["sQuote","\"tangle\""],["sQuote",["[",["class","tangle"],"1L"]]],{"domain":"NA"}]]]],["if",["is.null","pattern"],["<-","pattern","\"[.][rRsS](nw|tex)$\""],["if",["!",["is.character","pattern"]],["stop",["gettextf","\"Argument %s must be a character vector or NULL and not %s\"",["sQuote","\"pattern\""],["sQuote",["[",["class","pattern"],"1L"]]],{"domain":"NA"}]]],["<-","result",["list",{"name":["[","key","2L"]},{"package":["[","key","1L"]},{"pattern":"pattern"},{"weave":"weave"},{"tangle":"tangle"},{"aspell":"aspell"}]],["assign","rname","result","registry"]]],"result"]]],["setEngine",{"name":"\"Sweave\""},{"package":"\"utils\""},{"pattern":"NULL"},{"weave":["function",[{"...":""}],[["::","utils","Sweave"],"..."]]},{"tangle":["function",[{"...":""}],[["::","utils","Stangle"],"..."]]},{"aspell":["list",{"filter":"\"Sweave\""},{"control":"\"-t\""}]}],["function",[{"name":"","weave":"","tangle":"","pattern":"NULL","package":"NULL","aspell":["list",{}]}],["{",["if",["missing","weave"],["{",["getEngine","name","package"]],["{",["if",["is.element","name",["c","\"Sweave\"","\"utils::Sweave\""]],["{",["stop",["gettextf","\"Cannot change the %s engine or use an engine of that name\"",["sQuote","\"Sweave\""]],{"domain":"NA"}]]],["if",["missing","package"],["<-","package",[["::","utils","packageName"],["parent.frame",{}]]]],["<-","result",["setEngine","name","package",{"pattern":"pattern"},{"weave":"weave"},{"tangle":"tangle"},{"aspell":"aspell"}]],["invisible","result"]]]]]]]],["<-","loadVignetteBuilder",["function",[{"pkgdir":"","mustwork":"TRUE"}],["{",["<-","pkgs",["[",[".get_package_metadata","pkgdir"],"\"VignetteBuilder\""]],["if",["is.na","pkgs"],["<-","pkgs","NULL"],["if",["length","pkgs"],["{",["<-","pkgs",["unlist",["strsplit","pkgs","\",\""]]],["<-","pkgs",["gsub","'[[:space:]]'","''","pkgs"]]]]],["<-","pkgs",["unique",["c","pkgs","\"utils\""]]],["for","pkg","pkgs",["{",["<-","res",["tryCatch",["suppressPackageStartupMessages",["loadNamespace","pkg"]],{"error":"identity"}]],["if",["&&","mustwork",["inherits","res","\"error\""]],["stop",["gettextf","\"vignette builder '%s' not found\"","pkg"],{"domain":"NA"}]]]],"pkgs"]]],["<-","getVignetteInfo",["function",[{"package":"NULL","lib.loc":"NULL","all":"TRUE"}],["{",["<-","paths",["if",["is.null","package"],["{",["<-","package",[".packages",{"all.available":"all"},"lib.loc"]],["find.package","package","lib.loc",{"quiet":"TRUE"}]],["find.package","package","lib.loc"]]],["<-","paths",["[","paths",["dir.exists",["file.path","paths","\"doc\""]]]],["<-","empty",["cbind",{"Package":["character","0"]},{"Dir":["character","0"]},{"Topic":["character","0"]},{"File":["character","0"]},{"Title":["character","0"]},{"R":["character","0"]},{"PDF":["character","0"]}]],["<-","getVinfo",["function",[{"dir":""}],["{",["<-","entries","NULL"],["if",["file.exists",["<-","INDEX",["file.path","dir","\"Meta\"","\"vignette.rds\""]]],["<-","entries",["readRDS","INDEX"]]],["if",[">",["NROW","entries"],"0"],["{",["<-","R",["if",["is.null",["$","entries","R"]],["rep.int","\"\"",["NROW","entries"]],["$","entries","R"]]],["<-","file",["basename",["$","entries","File"]]],["<-","pdf",["$","entries","PDF"]],["<-","topic",["file_path_sans_ext",["ifelse",["==","R","\"\""],["ifelse",["==","pdf","\"\""],"file","pdf"],"R"]]],["[",["cbind",{"Package":["basename","dir"]},{"Dir":"dir"},{"Topic":"topic"},{"File":"file"},{"Title":["$","entries","Title"]},{"R":"R"},{"PDF":"pdf"}],["order",["$","entries","Title"]],{},{"drop":"FALSE"}]],"empty"]]]],["if",["length","paths"],["do.call","rbind",["lapply","paths","getVinfo"]],"empty"]]]]]
