[[],["<-","diag",["function",[{"x":"1","nrow":"","ncol":"","names":"TRUE"}],["{",["if",["is.matrix","x"],["{",["if",["&&",[">",["nargs",{}],"1L"],["(",["||",[">",["nargs",{}],"2L"],["any",["%in%",["names",["match.call",{}]],["c","\"nrow\"","\"ncol\""]]]]]],["stop","\"'nrow' or 'ncol' cannot be specified when 'x' is a matrix\""]],["if",["==",["(",["<-","m",["min",["dim","x"]]]],"0L"],["return",["vector",["typeof","x"],"0L"]]],["<-","y",["[","x",["+","1",["*",[":","0L",["(",["-","m","1L"]]],["(",["+",["[",["dim","x"],"1L"],"1"]]]]]],["if","names",["{",["<-","nms",["dimnames","x"]],["if",["&&",["&&",["is.list","nms"],["!",["any",["vapply","nms","is.null","NA"]]]],["identical",["(",["<-","nm",["[",["[[","nms","1L"],["seq_len","m"]]]],["[",["[[","nms","2L"],["seq_len","m"]]]],["<-",["names","y"],"nm"]]]],["return","y"]]],["if",["&&",["is.array","x"],["!=",["length",["dim","x"]],"1L"]],["stop","\"'x' is an array, but not one-dimensional.\""]],["if",["missing","x"],["<-","n","nrow"],["if",["&&",["==",["length","x"],"1L"],["==",["nargs",{}],"1L"]],["{",["<-","n",["as.integer","x"]],["<-","x","1"]],["<-","n",["length","x"]]]],["if",["!",["missing","nrow"]],["<-","n","nrow"]],["if",["missing","ncol"],["<-","ncol","n"]],[".Internal",["diag","x","n","ncol"]]]]],["<-","`diag<-`",["function",[{"x":"","value":""}],["{",["<-","dx",["dim","x"]],["if",["!=",["length","dx"],"2L"],["stop","\"only matrix diagonals can be replaced\""]],["<-","len.i",["min","dx"]],["<-","len.v",["length","value"]],["if",["&&",["!=","len.v","1L"],["!=","len.v","len.i"]],["stop","\"replacement diagonal has wrong length\""]],["if","len.i",["{",["<-","i",["seq_len","len.i"]],["<-",["[","x",["cbind","i","i"]],"value"]]],"x"]]]]
