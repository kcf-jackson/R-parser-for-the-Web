[[],["<-","addmargins",["function",[{"A":"","margin":["seq_along",["dim","A"]],"FUN":"sum","quiet":"FALSE"}],["{",["if",["is.null",["dim","A"]],["stop","\"'A' must be an array or table\""]],["<-","n.sid",["length","margin"]],["<-","miss.FUN",["missing","FUN"]],["if",["&&",["==",["length","FUN"],"1"],["!",["is.list","FUN"]]],["{",["<-","fname",["if",["!","miss.FUN"],["deparse",["substitute","FUN"]],"\"Sum\""]],["<-","FUN",["setNames",["list","FUN"],"fname"]]]],["if",["!","miss.FUN"],["{",["<-","add.names",["function",[{"thelist":""}],["{",["<-","n",["names","thelist"]],["if",["is.null","n"],["<-","n",["rep","\"\"",["length","thelist"]]]],["for","i",["[",["seq_along","thelist"],["-","1L"]],["{",["if",["!",["is.call",["[[","thelist","i"]]],["{",["if",["==",["[","n","i"],"\"\""],["<-",["[","n","i"],["as.character",["[[","thelist","i"]]]]],["if",["==",["as.character",["[[",["[[","thelist","i"],"1L"]],"\"list\""],["<-",["[[","thelist","i"],["add.names",["[[","thelist","i"]]]]]]],["<-",["names","thelist"],"n"],"thelist"]]],["if",["==",["mode",["substitute","FUN"]],"\"call\""],["<-","FUN",["eval",["add.names",["substitute","FUN"]]]]],["if",["is.null",["names","FUN"]],["<-",["names","FUN"],["rep","\"\"",["length","FUN"]]]]]],["if",["!=",["length","FUN"],"n.sid"],["{",["if",["==",["length","FUN"],"1L"],["<-","FUN",["rep","FUN","n.sid"]],["stop",["gettextf","\"length of FUN, %d,\\n does not match the length of the margins, %d\"",["length","FUN"],"n.sid"],{"domain":"NA"}]]]],["<-","fnames",["vector","\"list\"","n.sid"]],["for","i",["seq_along","FUN"],["{",["<-",["[[","fnames","i"],["[",["names","FUN"],"i"]],["if",["is.list",["[[","FUN","i"]],["{",["<-","topname",["[[","fnames","i"]],["<-",["[[","fnames","i"],["names",["[[","FUN","i"]]],["<-","blank",["==",["[[","fnames","i"],"\"\""]],["<-",["[",["[[","fnames","i"],"blank"],["[",["seq_along","blank"],"blank"]],["if",["==","topname","\"\""],["{",["<-",["[",["[[","fnames","i"],"blank"],["paste0","\"Margin \"",["[","margin","i"],"\".\"",["[",["[[","fnames","i"],"blank"]]]],["{",["<-",["[[","fnames","i"],["paste0","topname","\".\"",["[[","fnames","i"]]]]]],["if",["==",["[[","fnames","i"],"\"\""],["<-",["[[","fnames","i"],["paste","\"Margin\"",["[","margin","i"]]]]]]],["<-","expand.one",["function",[{"A":"","margin":"","FUN":"","fnames":""}],["{",["if",["!",["inherits","FUN","\"list\""]],["<-","FUN",["list","FUN"]]],["<-","d",["dim","A"]],["<-","n.dim",["length","d"]],["<-","n.mar",["length","FUN"]],["<-","newdim","d"],["<-",["[","newdim","margin"],["+",["[","newdim","margin"],"n.mar"]],["if",["is.null",["<-","dnA",["dimnames","A"]]],["<-","dnA",["vector","\"list\"","n.dim"]]],["<-",["[[","dnA","margin"],["c",["if",["is.null",["[[","dnA","margin"]],["rep","\"\"",["[[","d","margin"]],["[[","dnA","margin"]],"fnames"]],["<-","n.new",["prod","newdim"]],["<-","skip",["prod",["[","d",[":","1L","margin"]]]],["<-","runl",["/","skip",["[","d","margin"]]],["<-","apos",["rep",["c",["rep_len","TRUE","skip"],["rep_len","FALSE",["*","n.mar","runl"]]],["/","n.new",["(",["+","skip",["*","n.mar","runl"]]]]]],["<-","values",["double",["length","apos"]]],["<-",["[","values","apos"],["as.vector","A"]],["for","i",[":","1L","n.mar"],["{",["<-","mtab",["if",[">","n.dim","1"],["apply","A",["[",["(",[":","1L","n.dim"]],["-","margin"]],["[[","FUN","i"]],[["[[","FUN","i"],"A"]]],["<-","select",["rep_len","FALSE","n.mar"]],["<-",["[","select","i"],"TRUE"],["<-","mpos",["rep",["c",["rep_len","FALSE","skip"],["rep","select",{"each":"runl"}]],["/",["prod",["dim","A"]],"skip"]]],["<-",["[","values","mpos"],["as.vector","mtab"]]]],["array","values",{"dim":"newdim"},{"dimnames":"dnA"}]]]],["<-","new.A","A"],["for","i",[":","1L","n.sid"],["<-","new.A",["expand.one",{"A":"new.A"},{"margin":["[","margin","i"]},{"FUN":["[[","FUN","i"]},{"fnames":["[[","fnames","i"]}]]],["if",["inherits","A","\"table\""],["<-",["class","new.A"],["c","\"table\"",["class","new.A"]]]],["if",["&&",["&&",["!","quiet"],["!","miss.FUN"]],[">","n.sid","1"]],["{",["cat","\"Margins computed over dimensions\\nin the following order:\\n\""],["for","i",["seq_len","n.sid"],["cat",["paste","i"],"\": \"",["[",["names",["dimnames","A"]],["[","margin","i"]],"\"\\n\"",{"sep":"\"\""}]]]],"new.A"]]]]
