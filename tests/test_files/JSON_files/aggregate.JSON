[[],["<-","aggregate",["function",[{"x":"","...":""}],["UseMethod","\"aggregate\""]]],["<-","aggregate.default",["function",[{"x":"","...":""}],["{",["if",["is.ts","x"],["aggregate.ts",["as.ts","x"],"..."],["aggregate.data.frame",["as.data.frame","x"],"..."]]]]],["<-","aggregate.data.frame",["function",[{"x":"","by":"","FUN":"","...":"","simplify":"TRUE","drop":"TRUE"}],["{",["if",["!",["is.data.frame","x"]],["<-","x",["as.data.frame","x"]]],["<-","FUN",["match.fun","FUN"]],["if",["==",["NROW","x"],"0L"],["stop","\"no rows to aggregate\""]],["if",["==",["NCOL","x"],"0L"],["{",["<-","x",["data.frame",{"x":["rep","1",["NROW","x"]]}]],["return",["[",["aggregate.data.frame","x","by",["function",[{"x":""}],"0L"]],["seq_along","by"]]]]],["if",["!",["is.list","by"]],["stop","\"'by' must be a list\""]],["if",["&&",["is.null",["names","by"]],["length","by"]],["<-",["names","by"],["paste0","\"Group.\"",["seq_along","by"]]],["{",["<-","nam",["names","by"]],["<-","ind",["which",["!",["nzchar","nam"]]]],["<-",["[",["names","by"],"ind"],["paste0","\"Group.\"","ind"]]]],["if",["any",["!=",["lengths","by"],["NROW","x"]]],["stop","\"arguments must have same length\""]],["<-","y",["as.data.frame","by",{"stringsAsFactors":"FALSE"}]],["<-","keep",["complete.cases","by"]],["<-","y",["[","y","keep",{},{"drop":"FALSE"}]],["<-","x",["[","x","keep",{},{"drop":"FALSE"}]],["<-","nrx",["NROW","x"]],["<-","ident",["function",[{"x":""}],["{",["<-","y",["as.factor","x"]],["<-","l",["length",["levels","y"]]],["<-","s",["as.character",["seq_len","l"]]],["<-","n",["nchar","s"]],["<-",["levels","y"],["paste0",["strrep","\"0\"",["-",["[","n","l"],"n"]],"s"]],"y"]]],["<-","grp",["lapply","y","ident"]],["<-","multi.y",["&&",["!","drop"],["ncol","y"]]],["if","multi.y",["{",["<-","lev",["lapply","grp","levels"]],["<-","y",["as.list","y"]],["for","i",["seq_along","y"],["{",["<-","z",["[",["[[","y","i"],["match",["[[","lev","i"],["[[","grp","i"]]]],["if",["&&",["is.factor","z"],["any",["<-","keep",["is.na","z"]]]],["<-",["[","z","keep"],["[",["levels","z"],"keep"]]],["<-",["[[","y","i"],"z"]]],["<-","eGrid",["function",[{"L":""}],["expand.grid","L",{"KEEP.OUT.ATTRS":"FALSE"},{"stringsAsFactors":"FALSE"}]]],["<-","y",["eGrid","y"]]]],["<-","grp",["if",["ncol","y"],["{",["<-",["names","grp"],"NULL"],["do.call","paste",["c",["rev","grp"],["list",{"sep":"\".\""}]]]],["integer","nrx"]]],["if","multi.y",["{",["<-","lev",["as.list",["eGrid","lev"]]],["<-",["names","lev"],"NULL"],["<-","lev",["do.call","paste",["c",["rev","lev"],["list",{"sep":"\".\""}]]]]],["<-","y",["[","y",["match",["sort",["unique","grp"]],"grp","0L"],{},{"drop":"FALSE"}]]],["<-","z",["lapply","x",["function",[{"e":""}],["{",["<-","ans",["lapply",{"X":["unname",["split","e","grp"]]},{"FUN":"FUN"},"..."]],["if",["&&","simplify",["==",["length",["<-","len",["unique",["lengths","ans"]]]],"1L"]],["{",["if",["==","len","1L"],["{",["<-","cl",["lapply","ans","oldClass"]],["<-","cl1",["[[","cl","1L"]],["<-","ans",["unlist","ans",{"recursive":"FALSE"},{"use.names":"FALSE"}]],["if",["&&",["!",["is.null","cl1"]],["all",["vapply","cl","identical","NA",{"y":"cl1"}]]],["<-",["class","ans"],"cl1"]]],["if",[">","len","1L"],["<-","ans",["matrix",["unlist","ans",{"recursive":"FALSE"},{"use.names":"FALSE"}],{"ncol":"len"},{"byrow":"TRUE"},{"dimnames":["if",["!",["is.null",["<-","nms",["names",["[[","ans","1L"]]]]],["list","NULL","nms"]]}]]]]]],"ans"]]]],["<-","len",["length","y"]],["if","multi.y",["{",["<-","keep",["match","lev",["sort",["unique","grp"]]]],["for","i",["seq_along","z"],["<-",["[[","y",["+","len","i"]],["if",["is.matrix",["[[","z","i"]],["[",["[[","z","i"],"keep",{},{"drop":"FALSE"}],["[",["[[","z","i"],"keep"]]]]],["for","i",["seq_along","z"],["<-",["[[","y",["+","len","i"]],["[[","z","i"]]]],["<-",["names","y"],["c",["names","by"],["names","x"]]],["<-",["row.names","y"],"NULL"],"y"]]],["<-","aggregate.formula",["function",[{"formula":"","data":"","FUN":"","...":"","subset":"","na.action":"na.omit"}],["{",["if",["||",["missing","formula"],["!",["inherits","formula","\"formula\""]]],["stop","\"'formula' missing or incorrect\""]],["if",["!=",["length","formula"],"3L"],["stop","\"'formula' must have both left and right hand sides\""]],["<-","m",["match.call",{"expand.dots":"FALSE"}]],["if",["is.matrix",["eval",["$","m","data"],["parent.frame",{}]]],["<-",["$","m","data"],["as.data.frame","data"]]],["<-",["$","m","..."],["<-",["$","m","FUN"],"NULL"]],["<-",["[[","m","1L"],["quote",["::","stats","model.frame"]]],["if",["==",["[[","formula","2L"],"\".\""],["{",["<-","rhs",["as.list",["[",["attr",["terms",["[","formula",["-","2L"]]],"\"variables\""],["-","1"]]]],["<-","lhs",["as.call",["c",["quote","cbind"],["setdiff",["lapply",["names","data"],"as.name"],"rhs"]]]],["<-",["[[","formula","2L"],"lhs"],["<-",["[[","m","2L"],"formula"]]],["<-","mf",["eval","m",["parent.frame",{}]]],["if",["is.matrix",["[[","mf","1L"]],["{",["<-","lhs",["as.data.frame",["[[","mf","1L"]]],["aggregate.data.frame","lhs",["[","mf",["-","1L"]],{"FUN":"FUN"},"..."]],["aggregate.data.frame",["[","mf","1L"],["[","mf",["-","1L"]],{"FUN":"FUN"},"..."]]]]],["<-","aggregate.ts",["function",[{"x":"","nfrequency":"1","FUN":"sum","ndeltat":"1","ts.eps":["getOption","\"ts.eps\""],"...":""}],["{",["<-","x",["as.ts","x"]],["<-","ofrequency",["[",["tsp","x"],"3L"]],["<-","FUN",["match.fun","FUN"]],["if",["missing","nfrequency"],["<-","nfrequency",["/","1","ndeltat"]]],["if",["&&",["(",[">","nfrequency","1"]],["(",["<",["abs",["-","nfrequency",["round","nfrequency"]]],"ts.eps"]]],["<-","nfrequency",["round","nfrequency"]]],["if",["==","nfrequency","ofrequency"],["return","x"]],["<-","ratio",["/","ofrequency","nfrequency"]],["if",[">",["abs",["-","ratio",["round","ratio"]]],"ts.eps"],["stop",["gettextf","\"cannot change frequency from %g to %g\"","ofrequency","nfrequency"],{"domain":"NA"}]],["<-","len",["trunc",["+",["(",["/","ofrequency","nfrequency"]],"ts.eps"]]],["<-","mat",["is.matrix","x"]],["if","mat",["<-","cn",["colnames","x"]]],["<-","nstart",["[",["tsp","x"],"1L"]],["<-","x",["as.matrix","x"]],["<-","nend",["*",["floor",["/",["nrow","x"],"len"]],"len"]],["<-","x",["apply",["array",["c",["[","x",[":","1","nend"],{}]],{"dim":["c","len",["/","nend","len"],["ncol","x"]]}],{"MARGIN":["c","2L","3L"]},{"FUN":"FUN"},"..."]],["if",["!","mat"],["<-","x",["as.vector","x"]],["<-",["colnames","x"],"cn"]],["ts","x",{"start":"nstart"},{"frequency":"nfrequency"}]]]]]
