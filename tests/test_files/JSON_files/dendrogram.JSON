[[],["<-","as.dendrogram",["function",[{"object":"","...":""}],["UseMethod","\"as.dendrogram\""]]],["<-","as.dendrogram.dendrogram",["function",[{"object":"","...":""}],"object"]],["<-","as.dendrogram.hclust",["function",[{"object":"","hang":["-","1"],"check":"TRUE","...":""}],["{",["<-","nolabels",["is.null",["$","object","labels"]]],["<-","merge",["$","object","merge"]],["if",["&&","check",["!",["isTRUE",["<-","msg",[".validity.hclust","object","merge",{"order":"nolabels"}]]]]],["stop","msg"]],["if","nolabels",["<-",["$","object","labels"],["seq_along",["$","object","order"]]]],["<-","z",["list",{}]],["<-","nMerge",["length",["<-","oHgt",["$","object","height"]]]],["<-","hMax",["[","oHgt","nMerge"]],["for","k",[":","1L","nMerge"],["{",["<-","x",["[","merge","k",{}]],["if",["any",["<-","neg",["<","x","0"]]],["<-","h0",["if",["<","hang","0"],"0",["max","0",["-",["[","oHgt","k"],["*","hang","hMax"]]]]]],["if",["all","neg"],["{",["<-","zk",["as.list",["-","x"]]],["<-",["attr","zk","\"members\""],"2L"],["<-",["attr","zk","\"midpoint\""],"0.5"],["<-","objlabels",["[",["$","object","labels"],["-","x"]]],["<-",["attr",["[[","zk","1L"],"\"label\""],["[","objlabels","1L"]],["<-",["attr",["[[","zk","2L"],"\"label\""],["[","objlabels","2L"]],["<-",["attr",["[[","zk","1L"],"\"members\""],["<-",["attr",["[[","zk","2L"],"\"members\""],"1L"]],["<-",["attr",["[[","zk","1L"],"\"height\""],["<-",["attr",["[[","zk","2L"],"\"height\""],"h0"]],["<-",["attr",["[[","zk","1L"],"\"leaf\""],["<-",["attr",["[[","zk","2L"],"\"leaf\""],"TRUE"]]],["if",["any","neg"],["{",["<-","X",["as.character","x"]],["<-","isL",["<",["[","x","1L"],"0"]],["<-","zk",["if","isL",["list",["-",["[","x","1L"]],["[[","z",["[","X","2L"]]],["list",["[[","z",["[","X","1L"]],["-",["[","x","2L"]]]]],["<-",["attr","zk","\"members\""],["+",["attr",["[[","z",["[","X",["+","1","isL"]]],"\"members\""],"1L"]],["<-",["attr","zk","\"midpoint\""],["/",["(",["+",[".memberDend",["[[","zk","1L"]],["attr",["[[","z",["[","X",["+","1","isL"]]],"\"midpoint\""]]],"2"]],["<-",["attr",["[[","zk",["-","2","isL"]],"\"members\""],"1L"],["<-",["attr",["[[","zk",["-","2","isL"]],"\"height\""],"h0"],["<-",["attr",["[[","zk",["-","2","isL"]],"\"label\""],["[",["$","object","labels"],["-",["[","x",["-","2","isL"]]]]],["<-",["attr",["[[","zk",["-","2","isL"]],"\"leaf\""],"TRUE"],["<-",["[[","z",["[","X",["+","1","isL"]]],"NULL"]],["{",["<-","x",["as.character","x"]],["<-","zk",["list",["[[","z",["[","x","1L"]],["[[","z",["[","x","2L"]]]],["<-",["attr","zk","\"members\""],["+",["attr",["[[","z",["[","x","1L"]],"\"members\""],["attr",["[[","z",["[","x","2L"]],"\"members\""]]],["<-",["attr","zk","\"midpoint\""],["/",["(",["+",["+",["attr",["[[","z",["[","x","1L"]],"\"members\""],["attr",["[[","z",["[","x","1L"]],"\"midpoint\""]],["attr",["[[","z",["[","x","2L"]],"\"midpoint\""]]],"2"]],["<-",["[[","z",["[","x","1L"]],["<-",["[[","z",["[","x","2L"]],"NULL"]]]]],["<-",["attr","zk","\"height\""],["[","oHgt","k"]],["<-",["[[","z",["as.character","k"]],"zk"]]],["structure",["[[","z",["as.character","k"]],{"class":"\"dendrogram\""}]]]],["<-","nleaves",["function",[{"node":""}],["{",["if",["is.leaf","node"],["return","1L"]],["<-","todo","NULL"],["<-","count","0L"],["repeat",["{",["while",["length","node"],["{",["<-","child",["[[","node","1L"]],["<-","node",["[","node",["-","1L"]]],["if",["is.leaf","child"],["{",["<-","count",["+","count","1L"]]],["{",["<-","todo",["list",{"node":"child"},{"todo":"todo"}]]]]]],["if",["is.null","todo"],["{",["break"]],["{",["<-","node",["$","todo","node"]],["<-","todo",["$","todo","todo"]]]]]],"count"]]],["<-","as.hclust.dendrogram",["function",[{"x":"","...":""}],["{",["stopifnot",["is.list","x"],["==",["length","x"],"2L"]],["<-","n",["nleaves","x"]],["stopifnot",["==","n",["attr","x","\"members\""]]],["<-","ord",["integer","n"]],["<-","labsu",["character","n"]],["<-","n.h",["-","n","1L"]],["<-","height",["numeric","n.h"]],["<-","myIdx",["matrix","NA_integer_","2L","n.h"]],["<-","merge",["matrix","NA_integer_","2L","n.h"]],["<-","position","0L"],["<-","stack","NULL"],["<-","leafCount","0L"],["<-","nodeCount","0L"],["repeat",["{",["while",["length","x"],["{",["if",["==","position","0L"],["{",["<-","nodeCount",["+","nodeCount","1L"]],["<-","myNodeIndex","nodeCount"],["if",["!=","nodeCount","1L"],["{",["<-",["[","myIdx",{},"nodeCount"],["c",["$","stack","position"],["$","stack","myNodeIndex"]]]]],["<-",["[","height","nodeCount"],["attr","x","\"height\""]]]],["<-","position",["+","position","1L"]],["<-","child",["[[","x","1L"]],["<-","x",["[","x",["-","1L"]]],["if",["is.leaf","child"],["{",["<-","leafCount",["+","leafCount","1L"]],["<-",["[","labsu","leafCount"],["attr","child","'label'"]],["<-",["[","ord","leafCount"],["as.integer","child"]],["<-",["[","merge","position","myNodeIndex"],["-",["[","ord","leafCount"]]]],["{",["stopifnot",["==",["length","child"],"2L"]],["<-","stack",["list",{"node":"x"},{"position":"position"},{"myNodeIndex":"myNodeIndex"},{"stack":"stack"}]],["<-","x","child"],["<-","position","0L"]]]]],["if",["is.null","stack"],["{",["break"]]],["<-","position",["$","stack","position"]],["<-","x",["$","stack","node"]],["<-","myNodeIndex",["$","stack","myNodeIndex"]],["<-","stack",["$","stack","stack"]]]],["<-","iOrd",["sort.list","ord"]],["if",["!",["identical",["[","ord","iOrd"],["seq_len","n"]]],["stop",["gettextf","\"dendrogram entries must be 1,2,..,%d (in any order), to be coercible to \\\"hclust\\\"\"","n"],{"domain":"NA"}]],["<-","ii",["[",["sort.list","height",{"decreasing":"TRUE"}],[":","n.h","1L"]]],["stopifnot",["==",["[","ii","n.h"],"1L"]],["<-","k",["seq_len",["-","n.h","1L"]]],["<-",["[","merge",["t",["[","myIdx",{},["[","ii","k"]]]],["+","k"]],["if",["getOption","\"as.hclust.dendr\"","FALSE"],["{",["for","k",["seq_len","n.h"],["{",["cat",["sprintf","\"ii[k=%2d]=%2d \"","k",["[","ii","k"]]],["cat","\"-> s=merge[[,ii[k]]]=\""],["str",["[","merge",{},["[","ii","k"]]]]]]],["structure",["list",{"merge":["t",["[","merge",{},"ii"]]},{"height":["[","height","ii"]},{"order":"ord"},{"labels":["[","labsu","iOrd"]},{"call":["match.call",{}]},{"method":"NA_character_"},{"dist.method":"NA_character_"}],{"class":"\"hclust\""}]]]],["<-",".memberDend",["function",[{"x":""}],["{",["<-","r",["attr","x","\"x.member\""]],["if",["is.null","r"],["{",["<-","r",["attr","x","\"members\""]],["if",["is.null","r"],["<-","r","1L"]]]],"r"]]],["<-",".midDend",["function",[{"x":""}],["if",["is.null",["<-","mp",["attr","x","\"midpoint\""]]],"0","mp"]]],["<-","midcache.dendrogram",["function",[{"x":"","type":"\"hclust\"","quiet":"FALSE"}],["{",["<-","type",["match.arg","type"]],["stopifnot",["inherits","x","\"dendrogram\""]],["<-","verbose",[">=",["getOption","\"verbose\"","0"],"2"]],["<-","setmid",["function",[{"d":"","type":""}],["{",["<-","depth","0L"],["<-","kk",["integer",{}]],["<-","jj",["integer",{}]],["<-","dd",["list",{}]],["repeat",["{",["if",["!",["is.leaf","d"]],["{",["<-","k",["length","d"]],["if",["<","k","1"],["stop","\"dendrogram node with non-positive #{branches}\""]],["<-","depth",["+","depth","1L"]],["if","verbose",["cat",["sprintf","\" depth(+)=%4d, k=%d\\n\"","depth","k"]]],["<-",["[","kk","depth"],"k"],["if",["!=",["storage.mode","jj"],["storage.mode","kk"]],["<-",["storage.mode","jj"],["storage.mode","kk"]]],["<-",["[[","dd","depth"],"d"],["<-","d",["[[","d",["<-",["[","jj","depth"],"1L"]]],["next"]]],["while","depth",["{",["<-","k",["[","kk","depth"]],["<-","j",["[","jj","depth"]],["<-","r",["[[","dd","depth"]],["<-",["[[","r","j"],["unclass","d"]],["if",["<","j","k"],["break"]],["<-","depth",["-","depth","1L"]],["if","verbose",["cat",["sprintf","\" depth(-)=%4d, k=%d\\n\"","depth","k"]]],["<-","midS",["sum",["vapply","r",".midDend","0"]]],["if",["&&",["&&",["!","quiet"],["==","type","\"hclust\""]],["!=","k","2"]],["warning","\"midcache() of non-binary dendrograms only partly implemented\""]],["<-",["attr","r","\"midpoint\""],["/",["(",["+",[".memberDend",["[[","r","1L"]],"midS"]],"2"]],["<-","d","r"]]],["if",["!","depth"],["break"]],["<-",["[[","dd","depth"],"r"],["<-","d",["[[","r",["<-",["[","jj","depth"],["+","j","1L"]]]]]],"d"]]],["setmid","x",{"type":"type"}]]]],["<-","print.dendrogram",["function",[{"x":"","digits":["getOption","\"digits\""],"...":""}],["{",["cat","\"'dendrogram' \""],["if",["is.leaf","x"],["cat","\"leaf '\"",["format",["attr","x","\"label\""],{"digits":"digits"}],"\"'\"",{"sep":"\"\""}],["cat","\"with\"",["length","x"],"\"branches and\"",["attr","x","\"members\""],"\"members total\""]],["cat","\", at height\"",["format",["attr","x","\"height\""],{"digits":"digits"}],"\"\\n\""],["invisible","x"]]]],["<-","str.dendrogram",["function",[{"object":"","max.level":"NA","digits.d":"3L","give.attr":"FALSE","wid":["getOption","\"width\""],"nest.lev":"0L","indent.str":"\"\"","last.str":["getOption","\"str.dendrogram.last\""],"stem":"\"--\"","...":""}],["{",["<-","pasteLis",["function",[{"lis":"","dropNam":"","sep":"\" = \""}],["{",["<-","lis",["[","lis",["!",["(",["%in%",["names","lis"],"dropNam"]]]]],["<-","fl",["sapply","lis","format",{"digits":"digits.d"}]],["paste",["paste",["names","fl"],"fl",{"sep":"sep"}],{"collapse":"\", \""}]]]],["<-","todo","NULL"],["repeat",["{",["<-","istr",["sub","\" $\"","last.str","indent.str"]],["cat","istr","stem",{"sep":"\"\""}],["<-","at",["attributes","object"]],["<-","memb",["[[","at","\"members\""]],["<-","hgt",["[[","at","\"height\""]],["if",["!",["is.leaf","object"]],["{",["<-","le",["length","object"]],["if","give.attr",["{",["if",["nzchar",["<-","at",["pasteLis","at",["c","\"class\"","\"height\"","\"members\""]]]],["<-","at",["paste","\",\"","at"]]]]],["cat","\"[dendrogram w/ \"","le","\" branches and \"","memb","\" members at h = \"",["format","hgt",{"digits":"digits.d"}],["if","give.attr","at"],"\"]\"",["if",["&&",["!",["is.na","max.level"]],["==","nest.lev","max.level"]],"\" ..\""],"\"\\n\"",{"sep":"\"\""}],["if",["||",["is.na","max.level"],["<","nest.lev","max.level"]],["{",["<-","nest.lev",["+","nest.lev","1L"]],["<-","todo",["list",{"object":["[[","object","le"]},{"nest.lev":"nest.lev"},{"indent.str":["paste","indent.str","\"  \""]},{"todo":"todo"}]],["<-","indent.str",["paste","indent.str","\" |\""]],["while",[">",["(",["<-","le",["-","le","1L"]]],"0L"],["{",["<-","todo",["list",{"object":["[[","object","le"]},{"nest.lev":"nest.lev"},{"indent.str":"indent.str"},{"todo":"todo"}]]]]]]],["{",["cat","\"leaf\"",["if",["is.character",["$","at","label"]],["paste","\"\"",["$","at","label"],"\"\"",{"sep":"'\"'"}],["format","object",{"digits":"digits.d"}]],"\"\""],["<-","any.at",["!=","hgt","0"]],["if","any.at",["cat","\"(h=\"",["format","hgt",{"digits":"digits.d"}]]],["if",["!=","memb","1"],["cat",["if","any.at","\", \"",["{",["<-","any.at","TRUE"],"\"(\""]],"\"memb= \"","memb",{"sep":"\"\""}]],["<-","at",["pasteLis","at",["c","\"class\"","\"height\"","\"members\"","\"leaf\"","\"label\""]]],["if",["||","any.at",["nzchar","at"]],["cat",["if",["!","any.at"],"\"(\""],"at","\")\""]],["cat","\"\\n\""]]],["if",["is.null","todo"],["{",["break"]],["{",["<-","object",["$","todo","object"]],["<-","nest.lev",["$","todo","nest.lev"]],["<-","indent.str",["$","todo","indent.str"]],["<-","todo",["$","todo","todo"]]]]]],["invisible",{}]]]],["<-","`[[.dendrogram`",["function",[{"x":"","...":"","drop":"TRUE"}],["{",["if",["!",["is.null",["<-","r",["NextMethod","\"[[\""]]]],["structure","r",{"class":"\"dendrogram\""}]]]]],["<-","nobs.dendrogram",["function",[{"object":"","...":""}],["attr","object","\"members\""]]],["<-","plot.dendrogram",["function",[{"x":"","type":["c","\"rectangle\"","\"triangle\""],"center":"FALSE","edge.root":["||",["is.leaf","x"],["!",["is.null",["attr","x","\"edgetext\""]]]],"nodePar":"NULL","edgePar":["list",{}],"leaflab":["c","\"perpendicular\"","\"textlike\"","\"none\""],"dLeaf":"NULL","xlab":"\"\"","ylab":"\"\"","xaxt":"\"n\"","yaxt":"\"s\"","horiz":"FALSE","frame.plot":"FALSE","xlim":"","ylim":"","...":""}],["{",["<-","type",["match.arg","type"]],["<-","leaflab",["match.arg","leaflab"]],["<-","hgt",["attr","x","\"height\""]],["if",["&&","edge.root",["is.logical","edge.root"]],["<-","edge.root",["*","0.0625",["if",["is.leaf","x"],"1","hgt"]]]],["<-","mem.x",[".memberDend","x"]],["<-","yTop",["+","hgt","edge.root"]],["if","center",["{",["<-","x1","0.5"],["<-","x2",["+","mem.x","0.5"]]],["{",["<-","x1","1"],["<-","x2","mem.x"]]],["<-","xl.",["c",["-","x1",["/","1","2"]],["+","x2",["/","1","2"]]]],["<-","yl.",["c","0","yTop"]],["if","horiz",["{",["<-","tmp","xl."],["<-","xl.",["rev","yl."]],["<-","yl.","tmp"],["<-","tmp","xaxt"],["<-","xaxt","yaxt"],["<-","yaxt","tmp"]]],["if",["||",["missing","xlim"],["is.null","xlim"]],["<-","xlim","xl."]],["if",["||",["missing","ylim"],["is.null","ylim"]],["<-","ylim","yl."]],["dev.hold",{}],["on.exit",["dev.flush",{}]],["plot","0",{"xlim":"xlim"},{"ylim":"ylim"},{"type":"\"n\""},{"xlab":"xlab"},{"ylab":"ylab"},{"xaxt":"xaxt"},{"yaxt":"yaxt"},{"frame.plot":"frame.plot"},"..."],["if",["is.null","dLeaf"],["<-","dLeaf",["*",".75",["(",["if","horiz",["strwidth","\"w\""],["strheight","\"x\""]]]]]],["if","edge.root",["{",["<-","x0",["$",["plotNodeLimit","x1","x2","x","center"],"x"]],["if","horiz",["segments","hgt","x0","yTop","x0"],["segments","x0","hgt","x0","yTop"]],["if",["!",["is.null",["<-","et",["attr","x","\"edgetext\""]]]],["{",["<-","my",["mean","hgt","yTop"]],["if","horiz",["text","my","x0","et"],["text","x0","my","et"]]]]]],["plotNode","x1","x2","x",{"type":"type"},{"center":"center"},{"leaflab":"leaflab"},{"dLeaf":"dLeaf"},{"nodePar":"nodePar"},{"edgePar":"edgePar"},{"horiz":"horiz"}]]]],["<-","plotNode",["function",[{"x1":"","x2":"","subtree":"","type":"","center":"","leaflab":"","dLeaf":"","nodePar":"","edgePar":"","horiz":"FALSE"}],["{",["<-","wholetree","subtree"],["<-","depth","0L"],["<-","llimit",["list",{}]],["<-","KK",["integer",{}]],["<-","kk",["integer",{}]],["repeat",["{",["<-","inner",["&&",["!",["is.leaf","subtree"]],["!=","x1","x2"]]],["<-","yTop",["attr","subtree","\"height\""]],["<-","bx",["plotNodeLimit","x1","x2","subtree","center"]],["<-","xTop",["$","bx","x"]],["<-","depth",["+","depth","1L"]],["<-",["[[","llimit","depth"],["$","bx","limit"]],["<-","hasP",["!",["is.null",["<-","nPar",["attr","subtree","\"nodePar\""]]]]],["if",["!","hasP"],["<-","nPar","nodePar"]],["if",["getOption","\"verbose\""],["{",["cat",["if","inner","\"inner node\"","\"leaf\""],"\":\""],["if",["!",["is.null","nPar"]],["{",["cat","\" with node pars\\n\""],["str","nPar"]]],["cat",["if","inner",["paste","\" height\"",["formatC","yTop"],"\"; \""]],"\"(x1,x2)= (\"",["formatC","x1",{"width":"4"}],"\",\"",["formatC","x2",{"width":"4"}],"\")\"","\"--> xTop=\"",["formatC","xTop",{"width":"8"}],"\"\\n\"",{"sep":"\"\""}]]],["<-","Xtract",["function",[{"nam":"","L":"","default":"","indx":""}],["[",["rep",["if",["%in%","nam",["names","L"]],["[[","L","nam"],"default"],{"length.out":"indx"}],"indx"]]],["<-","asTxt",["function",[{"x":""}],["if",["||",["||",["is.character","x"],["is.expression","x"]],["is.null","x"]],"x",["as.character","x"]]]],["<-","i",["if",["||","inner","hasP"],"1","2"]],["if",["!",["is.null","nPar"]],["{",["<-","pch",["Xtract","\"pch\"","nPar",{"default":[":","1L","2"]},"i"]],["<-","cex",["Xtract","\"cex\"","nPar",{"default":["c","1","1"]},"i"]],["<-","col",["Xtract","\"col\"","nPar",{"default":["par","\"col\""]},"i"]],["<-","bg",["Xtract","\"bg\"","nPar",{"default":["par","\"bg\""]},"i"]],["points",["if","horiz",["cbind","yTop","xTop"],["cbind","xTop","yTop"]],{"pch":"pch"},{"bg":"bg"},{"col":"col"},{"cex":"cex"}]]],["if",["==","leaflab","\"textlike\""],["<-","p.col",["Xtract","\"p.col\"","nPar",{"default":"\"white\""},"i"]]],["<-","lab.col",["Xtract","\"lab.col\"","nPar",{"default":["par","\"col\""]},"i"]],["<-","lab.cex",["Xtract","\"lab.cex\"","nPar",{"default":["c","1","1"]},"i"]],["<-","lab.font",["Xtract","\"lab.font\"","nPar",{"default":["par","\"font\""]},"i"]],["<-","lab.xpd",["Xtract","\"xpd\"","nPar",{"default":["c","TRUE","TRUE"]},"i"]],["if",["is.leaf","subtree"],["{",["if",["==","leaflab","\"perpendicular\""],["{",["if","horiz",["{",["<-","X",["+","yTop",["*","dLeaf","lab.cex"]]],["<-","Y","xTop"],["<-","srt","0"],["<-","adj",["c","0","0.5"]]],["{",["<-","Y",["-","yTop",["*","dLeaf","lab.cex"]]],["<-","X","xTop"],["<-","srt","90"],["<-","adj","1"]]],["<-","nodeText",["asTxt",["attr","subtree","\"label\""]]],["text","X","Y","nodeText",{"xpd":"lab.xpd"},{"srt":"srt"},{"adj":"adj"},{"cex":"lab.cex"},{"col":"lab.col"},{"font":"lab.font"}]]]],["if","inner",["{",["<-","segmentsHV",["function",[{"x0":"","y0":"","x1":"","y1":""}],["{",["if","horiz",["segments","y0","x0","y1","x1",{"col":"col"},{"lty":"lty"},{"lwd":"lwd"}],["segments","x0","y0","x1","y1",{"col":"col"},{"lty":"lty"},{"lwd":"lwd"}]]]]],["for","k",["seq_along","subtree"],["{",["<-","child",["[[","subtree","k"]],["<-","yBot",["attr","child","\"height\""]],["if",["getOption","\"verbose\""],["cat","\"ch.\"","k","\"@ h=\"","yBot","\"; \""]],["if",["is.null","yBot"],["<-","yBot","0"]],["<-","xBot",["if","center",["mean",["[",["$","bx","limit"],[":","k",["(",["+","k","1"]]]]],["+",["[",["$","bx","limit"],"k"],[".midDend","child"]]]],["<-","hasE",["!",["is.null",["<-","ePar",["attr","child","\"edgePar\""]]]]],["if",["!","hasE"],["<-","ePar","edgePar"]],["<-","i",["if",["||",["!",["is.leaf","child"]],"hasE"],"1","2"]],["<-","col",["Xtract","\"col\"","ePar",{"default":["par","\"col\""]},"i"]],["<-","lty",["Xtract","\"lty\"","ePar",{"default":["par","\"lty\""]},"i"]],["<-","lwd",["Xtract","\"lwd\"","ePar",{"default":["par","\"lwd\""]},"i"]],["if",["==","type","\"triangle\""],["{",["segmentsHV","xTop","yTop","xBot","yBot"]],["{",["segmentsHV","xTop","yTop","xBot","yTop"],["segmentsHV","xBot","yTop","xBot","yBot"]]],["<-","vln","NULL"],["if",["&&",["is.leaf","child"],["==","leaflab","\"textlike\""]],["{",["<-","nodeText",["asTxt",["attr","child","\"label\""]]],["if",["getOption","\"verbose\""],["cat","'-- with \"label\"'",["format","nodeText"]]],["<-","hln",["/",["*","0.6",["strwidth","nodeText",{"cex":"lab.cex"}]],"2"]],["<-","vln",["/",["*","1.5",["strheight","nodeText",{"cex":"lab.cex"}]],"2"]],["rect",["-","xBot","hln"],"yBot",["+","xBot","hln"],["+","yBot",["*","2","vln"]],{"col":"p.col"}],["text","xBot",["+","yBot","vln"],"nodeText",{"xpd":"lab.xpd"},{"cex":"lab.cex"},{"col":"lab.col"},{"font":"lab.font"}]]],["if",["!",["is.null",["attr","child","\"edgetext\""]]],["{",["<-","edgeText",["asTxt",["attr","child","\"edgetext\""]]],["if",["getOption","\"verbose\""],["cat","'-- with \"edgetext\"'",["format","edgeText"]]],["if",["!",["is.null","vln"]],["{",["<-","mx",["if",["==","type","\"triangle\""],["/",["(",["+",["+","xTop","xBot"],["*",["(",["/",["(",["-","xTop","xBot"]],["(",["-","yTop","yBot"]]]],"vln"]]],"2"],"xBot"]],["<-","my",["/",["(",["+",["+","yTop","yBot"],["*","2","vln"]]],"2"]]],["{",["<-","mx",["if",["==","type","\"triangle\""],["/",["(",["+","xTop","xBot"]],"2"],"xBot"]],["<-","my",["/",["(",["+","yTop","yBot"]],"2"]]]],["<-","p.col",["Xtract","\"p.col\"","ePar",{"default":"\"white\""},"i"]],["<-","p.border",["Xtract","\"p.border\"","ePar",{"default":["par","\"fg\""]},"i"]],["<-","p.lwd",["Xtract","\"p.lwd\"","ePar",{"default":"lwd"},"i"]],["<-","p.lty",["Xtract","\"p.lty\"","ePar",{"default":"lty"},"i"]],["<-","t.col",["Xtract","\"t.col\"","ePar",{"default":"col"},"i"]],["<-","t.cex",["Xtract","\"t.cex\"","ePar",{"default":"1"},"i"]],["<-","t.font",["Xtract","\"t.font\"","ePar",{"default":["par","\"font\""]},"i"]],["<-","vlm",["/",["strheight",["c","edgeText","\"h\""],{"cex":"t.cex"}],"2"]],["<-","hlm",["/",["strwidth",["c","edgeText","\"m\""],{"cex":"t.cex"}],"2"]],["<-","hl3",["c",["[","hlm","1L"],["+",["[","hlm","1L"],["[","hlm","2L"]],["[","hlm","1L"]]],["if","horiz",["{",["polygon",["+","my",["c",["-","hl3"],"hl3"]],["+","mx",["*",["sum","vlm"],["c",[":",["-","1L"],"1L"],[":","1L",["-","1L"]]]]],{"col":"p.col"},{"border":"p.border"},{"lty":"p.lty"},{"lwd":"p.lwd"}],["text","my","mx","edgeText",{"cex":"t.cex"},{"col":"t.col"},{"font":"t.font"}]],["{",["polygon",["+","mx",["c",["-","hl3"],"hl3"]],["+","my",["*",["sum","vlm"],["c",[":",["-","1L"],"1L"],[":","1L",["-","1L"]]]]],{"col":"p.col"},{"border":"p.border"},{"lty":"p.lty"},{"lwd":"p.lwd"}],["text","mx","my","edgeText",{"cex":"t.cex"},{"col":"t.col"},{"font":"t.font"}]]]]]]]]]],["if",["&&","inner",["length","subtree"]],["{",["<-",["[","KK","depth"],["length","subtree"]],["if",["!=",["storage.mode","kk"],["storage.mode","KK"]],["<-",["storage.mode","kk"],["storage.mode","KK"]]],["<-",["[","kk","depth"],"1L"],["<-","x1",["[",["$","bx","limit"],"1L"]],["<-","x2",["[",["$","bx","limit"],"2L"]],["<-","subtree",["[[","subtree","1L"]]],["{",["repeat",["{",["<-","depth",["-","depth","1L"]],["if",["||",["!","depth"],["<",["[","kk","depth"],["[","KK","depth"]]],["break"]]]],["if",["!","depth"],["break"]],["<-",["length","kk"],"depth"],["<-",["[","kk","depth"],["<-","k",["+",["[","kk","depth"],"1L"]]],["<-","x1",["[",["[[","llimit","depth"],"k"]],["<-","x2",["[",["[[","llimit","depth"],["+","k","1L"]]],["<-","subtree",["[[","wholetree","kk"]]]]]],["invisible",{}]]]],["<-","plotNodeLimit",["function",[{"x1":"","x2":"","subtree":"","center":""}],["{",["<-","inner",["&&",["!",["is.leaf","subtree"]],["!=","x1","x2"]]],["<-","limit",["c","x1",["if","inner",["{",["<-","K",["length","subtree"]],["<-","mTop",[".memberDend","subtree"]],["<-","limit",["integer","K"]],["<-","xx1","x1"],["for","k",[":","1L","K"],["{",["<-","m",[".memberDend",["[[","subtree","k"]]],["<-","xx1",["+","xx1",["(",["if","center",["/",["*",["(",["-","x2","x1"]],"m"],"mTop"],"m"]]]],["<-",["[","limit","k"],"xx1"]]],"limit"],"x2"]]],["<-","mid",["attr","subtree","\"midpoint\""]],["<-","center",["||","center",["(",["&&","inner",["!",["is.numeric","mid"]]]]]],["<-","x",["if","center",["mean",["c","x1","x2"]],["+","x1",["(",["if","inner","mid","0"]]]]],["list",{"x":"x"},{"limit":"limit"}]]]],["<-","cut.dendrogram",["function",[{"x":"","h":"","...":""}],["{",["<-","LOWER",["list",{}]],["<-","X","1"],["<-","assignNodes",["function",[{"subtree":"","h":""}],["{",["if",["!",["is.leaf","subtree"]],["{",["if",["!",["(",["<-","K",["length","subtree"]]]],["stop","\"non-leaf subtree of length 0\""]],["<-","new.mem","0L"],["for","k",[":","1L","K"],["{",["<-","sub",["[[","subtree","k"]],["if",["<=",["attr","sub","\"height\""],"h"],["{",["<-","at",["attributes","sub"]],["<-",["$","at","leaf"],"TRUE"],["<-",["$","at","class"],"NULL"],["<-",["$","at","x.member"],["$","at","members"]],["<-","new.mem",["+","new.mem",["(",["<-",["$","at","members"],"1L"]]]],["<-",["$","at","label"],["paste","\"Branch\"","X"]],["<-",["[[","subtree","k"],"X"],["<-",["attributes",["[[","subtree","k"]],"at"],["<-",["class","sub"],"\"dendrogram\""],["<<-",["[[","LOWER","X"],"sub"],["<<-","X",["+","X","1"]]],["{",["<-",["[[","subtree","k"],["assignNodes","sub","h"]],["<-","new.mem",["+","new.mem",["attr",["[[","subtree","k"],"\"members\""]]]]]]],["<-",["attr","subtree","\"x.member\""],["attr","subtree","\"members\""]],["<-",["attr","subtree","\"members\""],"new.mem"]]],"subtree"]]],["list",{"upper":["assignNodes","x","h"]},{"lower":"LOWER"}]]]],["<-","is.leaf",["function",[{"object":""}],["&&",["(",["is.logical",["<-","L",["attr","object","\"leaf\""]]]],"L"]]],["<-","order.dendrogram",["function",[{"x":""}],["{",["if",["!",["inherits","x","\"dendrogram\""]],["stop","\"'order.dendrogram' requires a dendrogram\""]],["if",["is.list","x"],["unlist","x"],["as.vector","x"]]]]],["<-","reorder",["function",[{"x":"","...":""}],["UseMethod","\"reorder\""]]],["<-","reorder.dendrogram",["function",[{"x":"","wts":"","agglo.FUN":"sum","...":""}],["{",["if",["!",["inherits","x","\"dendrogram\""]],["stop","\"'reorder.dendrogram' requires a dendrogram\""]],["<-","agglo.FUN",["match.fun","agglo.FUN"]],["<-","oV",["function",[{"x":"","wts":""}],["{",["<-","depth","0L"],["<-","kk",["<-","jj",["integer",{}]]],["<-","xx",["list",{}]],["repeat",["{",["if",["is.leaf","x"],["<-",["attr","x","\"value\""],["[","wts",["[","x","1L"]]],["{",["<-","k",["length","x"]],["if",["==","k","0L"],["stop","\"invalid (length 0) node in dendrogram\""]],["<-","depth",["+","depth","1L"]],["<-",["[","kk","depth"],"k"],["if",["!=",["storage.mode","jj"],["storage.mode","kk"]],["<-",["storage.mode","jj"],["storage.mode","kk"]]],["<-",["[[","xx","depth"],"x"],["<-","x",["[[","x",["<-",["[","jj","depth"],"1L"]]],["next"]]],["while","depth",["{",["<-","b","x"],["<-","x",["[[","xx","depth"]],["<-","j",["[","jj","depth"]],["<-",["[[","x","j"],"b"],["if",["<","j",["[","kk","depth"]],["break"]],["<-","depth",["-","depth","1L"]],["<-","vals",["vapply","x","attr",["numeric","1L"],{"which":"\"value\""}]],["<-","iOrd",["sort.list","vals"]],["<-",["attr","x","\"value\""],["agglo.FUN",["[","vals","iOrd"]]],["<-",["[","x",{}],["[","x","iOrd"]]]],["if",["!","depth"],["break"]],["<-",["[[","xx","depth"],"x"],["<-","x",["[[","x",["<-",["[","jj","depth"],["+","j","1L"]]]]]],"x"]]],["midcache.dendrogram",["oV","x","wts"]]]]],["<-","rev.dendrogram",["function",[{"x":""}],["{",["if",["is.leaf","x"],["return","x"]],["<-","k",["length","x"]],["if",["<","k","1"],["stop","\"dendrogram non-leaf node with non-positive #{branches}\""]],["<-","r","x"],["for","j",[":","1L","k"],["<-",["[[","r","j"],["rev",["[[","x",["-",["+","k","1"],"j"]]]]],["midcache.dendrogram","r"]]]],["<-","labels.dendrogram",["function",[{"object":"","...":""}],["{",["if",["is.list","object"],["rapply","object",["function",[{"n":""}],["attr","n","\"label\""]]],["attr","object","\"label\""]]]]],["<-","merge.dendrogram",["function",[{"x":"","y":"","...":"","height":"","adjust":["c","\"auto\"","\"add.max\"","\"none\""]}],["{",["stopifnot",["inherits","x","\"dendrogram\""],["inherits","y","\"dendrogram\""]],["if",["==",["(",["<-","adjust",["match.arg","adjust"]]],"\"auto\""],["<-","adjust",["if",["&&",["==",["min",["unlist","x"]],"1"],["==",["min",["unlist","y"]],"1"]],"\"add.max\"","\"none\""]]],["if",["==","adjust","\"add.max\""],["{",["<-","add.ifleaf",["function",[{"i":"","add":""}],["if",["is.leaf","i"],["+","i","add"],"i"]]],["<-","add",["max",["unlist","x"]]],["<-","y",["dendrapply","y","add.ifleaf",{"add":"add"}]]]],["<-","r",["list","x","y"]],["if",["length",["<-","xtr",["list","..."]]],["{",["if",["!",["all",["<-","is.d",["vapply","xtr","inherits","NA",{"what":"\"dendrogram\""}]]]],["{",["<-","xpr",["substitute",["c","..."]]],["<-","nms",["sapply",["[",["[","xpr",["-","1"]],["!","is.d"]],"deparse",{"nlines":"1L"}]],["<-","msg",["ngettext",["length","nms"],"\"extra argument %s is not of class \\\"%s\\\"\"","\"extra arguments %s are not of class \\\"%s\\\"s\""]],["stop",["sprintf","msg",["paste","nms",{"collapse":"\", \""}],"\"dendrogram\""],{"domain":"NA"}]]],["if",["==","adjust","\"add.max\""],["{",["<-","add",["max","add",["unlist","y"]]],["for","i",["seq_along","xtr"],["{",["if",[">","i","1L"],["<-","add",["max","add",["unlist",["[","xtr",["-","i","1L"]]]]]],["<-",["[[","xtr","i"],["dendrapply",["[[","xtr","i"],"add.ifleaf",{"add":"add"}]]]]]],["<-","r",["c","r","xtr"]]]],["<-",["attr","r","\"members\""],["sum",["vapply","r","attr","0L",{"which":"\"members\""}]]],["<-","h.max",["max",["vapply","r","attr","0.",{"which":"\"height\""}]]],["if",["||",["missing","height"],["is.null","height"]],["<-","height",["*","1.1","h.max"]],["if",["<","height","h.max"],["{",["<-","msg",["gettextf","\"'height' must be at least %g, the maximal height of its components\"","h.max"]],["stop","msg",{"domain":"NA"}]]]],["<-",["attr","r","\"height\""],"height"],["<-",["class","r"],"\"dendrogram\""],["midcache.dendrogram","r",{"quiet":"TRUE"}]]]],["<-","dendrapply",["function",[{"X":"","FUN":"","...":""}],["{",["<-","FUN",["match.fun","FUN"]],["if",["!",["inherits","X","\"dendrogram\""]],["stop","\"'X' is not a dendrogram\""]],["<-","Napply",["function",[{"d":""}],["{",["<-","r",["FUN","d","..."]],["if",["!",["is.leaf","d"]],["{",["if",["!",["is.list","r"]],["<-","r",["as.list","r"]]],["if",["<",["length","r"],["(",["<-","n",["length","d"]]]],["<-",["[","r",["seq_len","n"]],["vector","\"list\"","n"]]],["<-",["[","r",{}],["lapply","d","Napply"]]]],"r"]]],["Napply","X"]]]],["<-","heatmap",["function",[{"x":"","Rowv":"NULL","Colv":["if","symm","\"Rowv\"","NULL"],"distfun":"dist","hclustfun":"hclust","reorderfun":["function",[{"d":"","w":""}],["reorder","d","w"]],"add.expr":"","symm":"FALSE","revC":["identical","Colv","\"Rowv\""],"scale":["c","\"row\"","\"column\"","\"none\""],"na.rm":"TRUE","margins":["c","5","5"],"ColSideColors":"","RowSideColors":"","cexRow":["+","0.2",["/","1",["log10","nr"]]],"cexCol":["+","0.2",["/","1",["log10","nc"]]],"labRow":"NULL","labCol":"NULL","main":"NULL","xlab":"NULL","ylab":"NULL","keep.dendro":"FALSE","verbose":["getOption","\"verbose\""],"...":""}],["{",["<-","scale",["if",["&&","symm",["missing","scale"]],"\"none\"",["match.arg","scale"]]],["if",["||",["!=",["length",["<-","di",["dim","x"]]],"2"],["!",["is.numeric","x"]]],["stop","\"'x' must be a numeric matrix\""]],["<-","nr",["[","di","1L"]],["<-","nc",["[","di","2L"]],["if",["||",["<=","nr","1"],["<=","nc","1"]],["stop","\"'x' must have at least 2 rows and 2 columns\""]],["if",["||",["!",["is.numeric","margins"]],["!=",["length","margins"],"2L"]],["stop","\"'margins' must be a numeric vector of length 2\""]],["<-","doRdend",["!",["identical","Rowv","NA"]]],["<-","doCdend",["!",["identical","Colv","NA"]]],["if",["&&",["!","doRdend"],["identical","Colv","\"Rowv\""]],["<-","doCdend","FALSE"]],["if",["is.null","Rowv"],["<-","Rowv",["rowMeans","x",{"na.rm":"na.rm"}]]],["if",["is.null","Colv"],["<-","Colv",["colMeans","x",{"na.rm":"na.rm"}]]],["if","doRdend",["{",["if",["inherits","Rowv","\"dendrogram\""],["<-","ddr","Rowv"],["{",["<-","hcr",["hclustfun",["distfun","x"]]],["<-","ddr",["as.dendrogram","hcr"]],["if",["||",["!",["is.logical","Rowv"]],"Rowv"],["<-","ddr",["reorderfun","ddr","Rowv"]]]]],["if",["!=","nr",["length",["<-","rowInd",["order.dendrogram","ddr"]]]],["stop","\"row dendrogram ordering gave index of wrong length\""]]],["<-","rowInd",[":","1L","nr"]]],["if","doCdend",["{",["if",["inherits","Colv","\"dendrogram\""],["<-","ddc","Colv"],["if",["identical","Colv","\"Rowv\""],["{",["if",["!=","nr","nc"],["stop","'Colv = \"Rowv\" but nrow(x) != ncol(x)'"]],["<-","ddc","ddr"]],["{",["<-","hcc",["hclustfun",["distfun",["if","symm","x",["t","x"]]]]],["<-","ddc",["as.dendrogram","hcc"]],["if",["||",["!",["is.logical","Colv"]],"Colv"],["<-","ddc",["reorderfun","ddc","Colv"]]]]]],["if",["!=","nc",["length",["<-","colInd",["order.dendrogram","ddc"]]]],["stop","\"column dendrogram ordering gave index of wrong length\""]]],["<-","colInd",[":","1L","nc"]]],["<-","x",["[","x","rowInd","colInd"]],["<-","labRow",["if",["is.null","labRow"],["if",["is.null",["rownames","x"]],["[",["(",[":","1L","nr"]],"rowInd"],["rownames","x"]],["[","labRow","rowInd"]]],["<-","labCol",["if",["is.null","labCol"],["if",["is.null",["colnames","x"]],["[",["(",[":","1L","nc"]],"colInd"],["colnames","x"]],["[","labCol","colInd"]]],["if",["==","scale","\"row\""],["{",["<-","x",["sweep","x","1L",["rowMeans","x",{"na.rm":"na.rm"}],{"check.margin":"FALSE"}]],["<-","sx",["apply","x","1L","sd",{"na.rm":"na.rm"}]],["<-","x",["sweep","x","1L","sx","\"/\"",{"check.margin":"FALSE"}]]],["if",["==","scale","\"column\""],["{",["<-","x",["sweep","x","2L",["colMeans","x",{"na.rm":"na.rm"}],{"check.margin":"FALSE"}]],["<-","sx",["apply","x","2L","sd",{"na.rm":"na.rm"}]],["<-","x",["sweep","x","2L","sx","\"/\"",{"check.margin":"FALSE"}]]]]],["<-","lmat",["rbind",["c","NA","3"],[":","2","1"]]],["<-","lwid",["c",["if","doRdend","1","0.05"],"4"]],["<-","lhei",["c",["+",["(",["if","doCdend","1","0.05"]],["if",["!",["is.null","main"]],"0.2","0"]],"4"]],["if",["!",["missing","ColSideColors"]],["{",["if",["||",["!",["is.character","ColSideColors"]],["!=",["length","ColSideColors"],"nc"]],["stop","\"'ColSideColors' must be a character vector of length ncol(x)\""]],["<-","lmat",["rbind",["+",["[","lmat","1",{}],"1"],["c","NA","1"],["+",["[","lmat","2",{}],"1"]]],["<-","lhei",["c",["[","lhei","1L"],"0.2",["[","lhei","2L"]]]]],["if",["!",["missing","RowSideColors"]],["{",["if",["||",["!",["is.character","RowSideColors"]],["!=",["length","RowSideColors"],"nr"]],["stop","\"'RowSideColors' must be a character vector of length nrow(x)\""]],["<-","lmat",["cbind",["+",["[","lmat",{},"1"],"1"],["c",["rep","NA",["-",["nrow","lmat"],"1"]],"1"],["+",["[","lmat",{},"2"],"1"]]],["<-","lwid",["c",["[","lwid","1L"],"0.2",["[","lwid","2L"]]]]],["<-",["[","lmat",["is.na","lmat"]],"0"],["if","verbose",["{",["cat","\"layout: widths = \"","lwid","\", heights = \"","lhei","\"; lmat=\\n\""],["print","lmat"]]],["dev.hold",{}],["on.exit",["dev.flush",{}]],["<-","op",["par",{"no.readonly":"TRUE"}]],["on.exit",["par","op"],{"add":"TRUE"}],["layout","lmat",{"widths":"lwid"},{"heights":"lhei"},{"respect":"TRUE"}],["if",["!",["missing","RowSideColors"]],["{",["par",{"mar":["c",["[","margins","1L"],"0","0","0.5"]}],["image",["rbind",["if","revC",[":","nr","1L"],[":","1L","nr"]]],{"col":["[","RowSideColors","rowInd"]},{"axes":"FALSE"}]]],["if",["!",["missing","ColSideColors"]],["{",["par",{"mar":["c","0.5","0","0",["[","margins","2L"]]}],["image",["cbind",[":","1L","nc"]],{"col":["[","ColSideColors","colInd"]},{"axes":"FALSE"}]]],["par",{"mar":["c",["[","margins","1L"],"0","0",["[","margins","2L"]]}],["if",["||",["!","symm"],["!=","scale","\"none\""]],["<-","x",["t","x"]]],["if","revC",["{",["<-","iy",[":","nr","1"]],["if","doRdend",["<-","ddr",["rev","ddr"]]],["<-","x",["[","x",{},"iy"]]],["<-","iy",[":","1L","nr"]]],["image",[":","1L","nc"],[":","1L","nr"],"x",{"xlim":["+","0.5",["c","0","nc"]]},{"ylim":["+","0.5",["c","0","nr"]]},{"axes":"FALSE"},{"xlab":"\"\""},{"ylab":"\"\""},"..."],["axis","1",[":","1L","nc"],{"labels":"labCol"},{"las":"2"},{"line":["-","0.5"]},{"tick":"0"},{"cex.axis":"cexCol"}],["if",["!",["is.null","xlab"]],["mtext","xlab",{"side":"1"},{"line":["-",["[","margins","1L"],"1.25"]}]],["axis","4","iy",{"labels":"labRow"},{"las":"2"},{"line":["-","0.5"]},{"tick":"0"},{"cex.axis":"cexRow"}],["if",["!",["is.null","ylab"]],["mtext","ylab",{"side":"4"},{"line":["-",["[","margins","2L"],"1.25"]}]],["if",["!",["missing","add.expr"]],["eval.parent",["substitute","add.expr"]]],["par",{"mar":["c",["[","margins","1L"],"0","0","0"]}],["if","doRdend",["plot","ddr",{"horiz":"TRUE"},{"axes":"FALSE"},{"yaxs":"\"i\""},{"leaflab":"\"none\""}],["frame",{}]],["par",{"mar":["c","0","0",["if",["!",["is.null","main"]],"1","0"],["[","margins","2L"]]}],["if","doCdend",["plot","ddc",{"axes":"FALSE"},{"xaxs":"\"i\""},{"leaflab":"\"none\""}],["if",["!",["is.null","main"]],["frame",{}]]],["if",["!",["is.null","main"]],["{",["par",{"xpd":"NA"}],["title","main",{"cex.main":["*","1.5",["[[","op","\"cex.main\""]]}]]],["invisible",["list",{"rowInd":"rowInd"},{"colInd":"colInd"},{"Rowv":["if",["&&","keep.dendro","doRdend"],"ddr"]},{"Colv":["if",["&&","keep.dendro","doCdend"],"ddc"]}]]]]]]
