[[],["<-","formula",["function",[{"x":"","...":""}],["UseMethod","\"formula\""]]],["<-","formula.default",["function",[{"x":"NULL","env":["parent.frame",{}],"...":""}],["{",["<-","notAtomic",["!",["is.atomic","x"]]],["<-","notnull",["function",[{"z":""}],["&&","notAtomic",["!",["is.null","z"]]]]],["if",["notnull",["$","x","formula"]],["eval",["$","x","formula"]],["if",["notnull",["$","x","terms"]],["{",["<-","z",["$","x","terms"]],["<-",["oldClass","z"],"\"formula\""],"z"],["if",["notnull",["$",["$","x","call"],"formula"]],["eval",["$",["$","x","call"],"formula"]],["if",["!",["is.null",["attr","x","\"formula\""]]],["attr","x","\"formula\""],["{",["<-","form",["switch",["mode","x"],{"NULL":["structure",["list",{}],{"class":"\"formula\""}]},{"character":["formula",["eval",["[[",["parse",{"text":"x"},{"keep.source":"FALSE"}],"1L"]]]},{"call":["eval","x"]},["stop","\"invalid formula\""]]],["<-",["environment","form"],"env"],"form"]]]]]]]],["<-","formula.formula",["function",[{"x":"","...":""}],"x"]],["<-","formula.terms",["function",[{"x":"","...":""}],["{",["<-","env",["environment","x"]],["<-",["attributes","x"],["list",{"class":"\"formula\""}]],["<-",["environment","x"],["if",["is.null","env"],["globalenv",{}],"env"]],"x"]]],["<-","DF2formula",["function",[{"x":"","env":["parent.frame",{}]}],["{",["<-","nm",["unlist",["lapply",["names","x"],"as.name"]]],["if",[">",["length","nm"],"1L"],["{",["<-","rhs",["[","nm",["-","1L"]]],["<-","lhs",["[","nm","1L"]]],["if",["==",["length","nm"],"1L"],["{",["<-","rhs",["[","nm","1L"]],["<-","lhs","NULL"]],["stop","\"cannot create a formula from a zero-column data frame\""]]],["<-","ff",["parse",{"text":["paste","lhs",["paste","rhs",{"collapse":"\"+\""}],{"sep":"\"~\""}]},{"keep.source":"FALSE"}]],["<-","ff",["eval","ff"]],["<-",["environment","ff"],"env"],"ff"]]],["<-","formula.data.frame",["function",[{"x":"","...":""}],["{",["if",["&&",["length",["<-","tx",["attr","x","\"terms\""]]],["length",["<-","ff",["formula.terms","tx"]]]],"ff",["DF2formula","x",["parent.frame",{}]]]]]],["<-","formula.character",["function",[{"x":"","env":["parent.frame",{}],"...":""}],["{",["<-","ff",["formula",["eval",["[[",["parse",{"text":"x"},{"keep.source":"FALSE"}],"1L"]]]],["<-",["environment","ff"],"env"],"ff"]]],["<-","print.formula",["function",[{"x":"","showEnv":["!",["identical","e",".GlobalEnv"]],"...":""}],["{",["<-","e",["environment",["<-",".x","x"]]],["<-",["attr","x","\".Environment\""],"NULL"],["print.default",["unclass","x"],"..."],["if","showEnv",["print","e"]],["invisible",".x"]]]],["<-","`[.formula`",["function",[{"x":"","i":""}],["{",["<-","ans",["NextMethod","\"[\""]],["if",["||",["==",["length","ans"],"0L"],["==",["[",["as.character",["[[","ans","1L"]],"1L"],"\"~\""]],["{",["<-",["class","ans"],"\"formula\""],["<-",["environment","ans"],["environment","x"]]]],"ans"]]],["<-","as.formula",["function",[{"object":"","env":["parent.frame",{}]}],["{",["if",["inherits","object","\"formula\""],"object",["{",["<-","rval",["formula","object",{"env":["baseenv",{}]}]],["if",["||",["identical",["environment","rval"],["baseenv",{}]],["!",["missing","env"]]],["<-",["environment","rval"],"env"]],"rval"]]]]],["<-","terms",["function",[{"x":"","...":""}],["UseMethod","\"terms\""]]],["<-","terms.default",["function",[{"x":"","...":""}],["{",["<-","v",["$","x","terms"]],["if",["is.null","v"],["{",["<-","v",["attr","x","\"terms\""]],["if",["is.null","v"],["stop","\"no terms component nor attribute\""]]]],"v"]]],["<-","terms.terms",["function",[{"x":"","...":""}],"x"]],["<-","print.terms",["function",[{"x":"","...":""}],["{",["print.default",["unclass","x"],"..."],["invisible","x"]]]],["<-","labels.terms",["function",[{"object":"","...":""}],["attr","object","\"term.labels\""]]],["<-","delete.response",["function",[{"termobj":""}],["{",["<-","a",["attributes","termobj"]],["<-","y",["$","a","response"]],["if",["&&",["!",["is.null","y"]],"y"],["{",["<-",["[[","termobj","2L"],"NULL"],["<-",["$","a","response"],"0"],["<-",["$","a","variables"],["[",["$","a","variables"],["-",["(",["+","1","y"]]]]],["<-",["$","a","predvars"],["[",["$","a","predvars"],["-",["(",["+","1","y"]]]]],["if",["length",["$","a","factors"]],["<-",["$","a","factors"],["[",["$","a","factors"],["-","y"],{},{"drop":"FALSE"}]]],["if",["length",["$","a","offset"]],["<-",["$","a","offset"],["ifelse",[">",["$","a","offset"],"y"],["-",["$","a","offset"],"1"],["$","a","offset"]]]],["if",["length",["$","a","specials"]],["for","i",["seq_along",["$","a","specials"]],["{",["<-","b",["[[",["$","a","specials"],"i"]],["<-",["[[",["$","a","specials"],"i"],["ifelse",[">","b","y"],["-","b","1"],"b"]]]]],["<-",["attributes","termobj"],"a"]]],"termobj"]]],["<-","reformulate",["function",[{"termlabels":"","response":"NULL","intercept":"TRUE","env":["parent.frame",{}]}],["{",["<-","str2code",["function",[{"s":""}],["[[",["parse",{"text":"s"},{"keep.source":"FALSE"}],"1L"]]],["if",["||",["!",["is.character","termlabels"]],["!",["length","termlabels"]]],["stop","\"'termlabels' must be a character vector of length at least one\""]],["<-","termtext",["paste","termlabels",{"collapse":"\"+\""}]],["if",["!","intercept"],["<-","termtext",["paste","termtext","\"- 1\""]]],["<-","terms",["str2code","termtext"]],["<-","fexpr",["if",["is.null","response"],["call","\"~\"","terms"],["call","\"~\"",["if",["is.character","response"],["tryCatch",["str2code","response"],{"error":["function",[{"e":""}],["{",["<-","sc",["sys.calls",{}]],["<-","sc1",["lapply","sc","`[[`","1L"]],["<-","isF",["function",[{"cl":""}],["&&",["is.symbol","cl"],["==","cl",["quote","reformulate"]]]]],["<-","reformCall",["[[","sc",["match","TRUE",["vapply","sc1","isF","NA"]]]],["warning",["warningCondition",{"message":["paste",["sprintf","\"Unparseable 'response' \\\"%s\\\"; use is deprecated.  Use as.name(.) or `..`!\"","response"],["conditionMessage","e"],{"sep":"\"\\n\""}]},{"class":["c","\"reformulate\"","\"deprecatedWarning\""]},{"call":"reformCall"}]],["as.symbol","response"]]]}],"response"],"terms"]]],["formula","fexpr","env"]]]],["<-","drop.terms",["function",[{"termobj":"","dropx":"NULL","keep.response":"FALSE"}],["{",["if",["is.null","dropx"],"termobj",["{",["if",["!",["inherits","termobj","\"terms\""]],["stop",["gettextf","\"'termobj' must be a object of class %s\"",["dQuote","\"terms\""]],{"domain":"NA"}]],["<-","newformula",["reformulate",["[",["attr","termobj","\"term.labels\""],["-","dropx"]],{"response":["if","keep.response",["[[","termobj","2L"]]},{"intercept":["attr","termobj","\"intercept\""]},{"env":["environment","termobj"]}]],["<-","result",["terms","newformula",{"specials":["names",["attr","termobj","\"specials\""]]}]],["<-","response",["attr","termobj","\"response\""]],["<-","dropOpt",["if",["&&","response",["!","keep.response"]],["c","response",["+","dropx",["length","response"]]],["+","dropx",["max","response"]]]],["if",["!",["is.null",["<-","predvars",["attr","termobj","\"predvars\""]]]],["{",["<-",["attr","result","\"predvars\""],["[","predvars",["-",["(",["+","dropOpt","1"]]]]]]],["if",["!",["is.null",["<-","dataClasses",["attr","termobj","\"dataClasses\""]]]],["{",["<-",["attr","result","\"dataClasses\""],["[","dataClasses",["-","dropOpt"]]]]],"result"]]]]],["<-","`[.terms`",["function",[{"termobj":"","i":""}],["{",["<-","resp",["if",["attr","termobj","\"response\""],["[[","termobj","2L"]]],["<-","newformula",["[",["attr","termobj","\"term.labels\""],"i"]],["if",["==",["length","newformula"],"0L"],["<-","newformula","\"1\""]],["<-","newformula",["reformulate","newformula","resp",["attr","termobj","\"intercept\""],["environment","termobj"]]],["<-","result",["terms","newformula",{"specials":["names",["attr","termobj","\"specials\""]]}]],["<-","addindex",["function",[{"index":"","offset":""}],["ifelse",["<","index","0"],["-","index","offset"],["ifelse",["==","index","0"],"0",["+","index","offset"]]]]],["if",["is.logical","i"],["<-","i",["which",["rep_len","i",{"length.out":["length",["attr","termobj","\"term.labels\""]]}]]]],["<-","response",["attr","termobj","\"response\""]],["if","response",["<-","iOpt",["c",["if",[">",["max","i"],"0"],"response"],["addindex","i",["max","response"]]]],["<-","iOpt","i"]],["if",["!",["is.null",["<-","predvars",["attr","termobj","\"predvars\""]]]],["<-",["attr","result","\"predvars\""],["[","predvars",["c",["if",[">",["max","iOpt"],"0"],"1"],["addindex","iOpt","1"]]]]],["if",["!",["is.null",["<-","dataClasses",["attr","termobj","\"dataClasses\""]]]],["<-",["attr","result","\"dataClasses\""],["[","dataClasses","iOpt"]]],"result"]]],["<-","terms.formula",["function",[{"x":"","specials":"NULL","abb":"NULL","data":"NULL","neg.out":"TRUE","keep.order":"FALSE","simplify":"FALSE","...":"","allowDotAsName":"FALSE"}],["{",["<-","fixFormulaObject",["function",[{"object":""}],["{",["<-","Terms",["terms","object"]],["<-","tmp",["attr","Terms","\"term.labels\""]],["<-","ind",["grep","\"|\"","tmp",{"fixed":"TRUE"}]],["if",["length","ind"],["<-",["[","tmp","ind"],["paste","\"(\"",["[","tmp","ind"],"\")\""]]],["if",["length",["<-","ind",["attr","Terms","\"offset\""]]],["{",["<-","tmp2",["[",["as.character",["attr","Terms","\"variables\""]],["-","1L"]]],["<-","tmp",["c","tmp",["[","tmp2","ind"]]]]],["<-","rhs",["if",["length","tmp"],["paste","tmp",{"collapse":"\" + \""}],"\"1\""]],["if",["!",["attr","Terms","\"intercept\""]],["<-","rhs",["paste","rhs","\"- 1\""]]],["if",[">",["length",["<-","form",["formula","object"]]],"2L"],["{",["<-","res",["formula",["paste","\"lhs ~\"","rhs"]]],["<-",["[[","res","2L"],["[[","form","2L"]],"res"],["formula",["paste","\"~\"","rhs"]]]]]],["if",["&&",["&&",["!",["is.null","data"]],["!",["is.environment","data"]]],["!",["is.data.frame","data"]]],["<-","data",["as.data.frame","data",{"optional":"TRUE"}]]],["<-","terms",[".External","C_termsform","x","specials","data","keep.order","allowDotAsName"]],["if","simplify",["{",["<-","a",["attributes","terms"]],["<-","terms",["fixFormulaObject","terms"]],["<-",["attributes","terms"],"a"]]],["<-",["environment","terms"],["environment","x"]],["if",["!",["inherits","terms","\"formula\""]],["<-",["class","terms"],["c",["oldClass","terms"],"\"formula\""]]],"terms"]]],["<-","coef",["function",[{"object":"","...":""}],["UseMethod","\"coef\""]]],["<-","coef.default",["function",[{"object":"","complete":"TRUE","...":""}],["{",["<-","cf",["$","object","coefficients"]],["if","complete","cf",["[","cf",["!",["is.na","cf"]]]]]]],["<-","coef.aov","coef.default"],["<-",["[[",["formals","coef.aov"],"\"complete\""],"FALSE"],["<-","coefficients","coef"],["<-","residuals",["function",[{"object":"","...":""}],["UseMethod","\"residuals\""]]],["<-","residuals.default",["function",[{"object":"","...":""}],["naresid",["$","object","na.action"],["$","object","residuals"]]]],["<-","resid","residuals"],["<-","deviance",["function",[{"object":"","...":""}],["UseMethod","\"deviance\""]]],["<-","deviance.default",["function",[{"object":"","...":""}],["$","object","deviance"]]],["<-","fitted",["function",[{"object":"","...":""}],["UseMethod","\"fitted\""]]],["<-","fitted.default",["function",[{"object":"","...":""}],["{",["<-","xx",["if",["%in%","\"fitted.values\"",["names","object"]],["$","object","fitted.values"],["$","object","fitted"]]],["napredict",["$","object","na.action"],"xx"]]]],["<-","fitted.values","fitted"],["<-","anova",["function",[{"object":"","...":""}],["UseMethod","\"anova\""]]],["<-","effects",["function",[{"object":"","...":""}],["UseMethod","\"effects\""]]],["<-","weights",["function",[{"object":"","...":""}],["UseMethod","\"weights\""]]],["<-","weights.default",["function",[{"object":"","...":""}],["{",["<-","wts",["$","object","weights"]],["if",["is.null","wts"],"wts",["napredict",["$","object","na.action"],"wts"]]]]],["<-","df.residual",["function",[{"object":"","...":""}],["UseMethod","\"df.residual\""]]],["<-","df.residual.default",["function",[{"object":"","...":""}],["$","object","df.residual"]]],["<-","variable.names",["function",[{"object":"","...":""}],["UseMethod","\"variable.names\""]]],["<-","variable.names.default",["function",[{"object":"","...":""}],["colnames","object"]]],["<-","case.names",["function",[{"object":"","...":""}],["UseMethod","\"case.names\""]]],["<-","case.names.default",["function",[{"object":"","...":""}],["rownames","object"]]],["<-","simulate",["function",[{"object":"","nsim":"1","seed":"NULL","...":""}],["UseMethod","\"simulate\""]]],["<-","offset",["function",[{"object":""}],"object"]],["<-",".checkMFClasses",["function",[{"cl":"","m":"","ordNotOK":"FALSE"}],["{",["<-","new",["vapply","m",".MFclass","\"\""]],["<-","new",["[","new",["%in%",["names","new"],["names","cl"]]]],["if",["==",["length","new"],"0L"],["return",["invisible",{}]]],["<-","old",["[","cl",["names","new"]]],["if",["!","ordNotOK"],["{",["<-",["[","old",["==","old","\"ordered\""]],"\"factor\""],["<-",["[","new",["==","new","\"ordered\""]],"\"factor\""]]],["<-",["[","new",["&",["==","new","\"ordered\""],["==","old","\"factor\""]]],"\"factor\""],["<-",["[","new",["&",["==","new","\"factor\""],["==","old","\"character\""]]],"\"character\""],["if",["!",["identical","old","new"]],["{",["<-","wrong",["!=","old","new"]],["if",["==",["sum","wrong"],"1"],["stop",["gettextf","\"variable '%s' was fitted with type \\\"%s\\\" but type \\\"%s\\\" was supplied\"",["[",["names","old"],"wrong"],["[","old","wrong"],["[","new","wrong"]],{"call.":"FALSE"},{"domain":"NA"}],["stop",["gettextf","\"variables %s were specified with different types from the fit\"",["paste",["sQuote",["[",["names","old"],"wrong"]],{"collapse":"\", \""}]],{"call.":"FALSE"},{"domain":"NA"}]]],["invisible",{}]]]]],["<-",".MFclass",["function",[{"x":""}],["{",["if",["is.logical","x"],["return","\"logical\""]],["if",["is.ordered","x"],["return","\"ordered\""]],["if",["is.factor","x"],["return","\"factor\""]],["if",["is.character","x"],["return","\"character\""]],["if",["&&",["is.matrix","x"],["is.numeric","x"]],["return",["paste0","\"nmatrix.\"",["ncol","x"]]]],["if",["is.numeric","x"],["return","\"numeric\""]],["return","\"other\""]]]],["<-","deparse2",["function",[{"x":""}],["paste",["deparse","x",{"width.cutoff":"500L"},{"backtick":["&&",["!",["is.symbol","x"]],["is.language","x"]]}],{"collapse":"\" \""}]]],["<-","model.frame",["function",[{"formula":"","...":""}],["UseMethod","\"model.frame\""]]],["<-","model.frame.default",["function",[{"formula":"","data":"NULL","subset":"NULL","na.action":"na.fail","drop.unused.levels":"FALSE","xlev":"NULL","...":""}],["{",["<-","possible_newdata",["&&",["&&",["&&",["!",["missing","data"]],["is.data.frame","data"]],["identical",["substitute","data"],["quote","newdata"]]],[">",["(",["<-","nr",["nrow","data"]]],"0"]]],["if",["&&",["&&",["&&",["!",["missing","formula"]],["==",["nargs",{}],"1"]],["is.list","formula"]],["!",["is.null",["<-","m",["$","formula","model"]]]]],["return","m"]],["if",["&&",["&&",["&&",["!",["missing","formula"]],["==",["nargs",{}],"1"]],["is.list","formula"]],["all",["%in%",["c","\"terms\"","\"call\""],["names","formula"]]]],["{",["<-","fcall",["$","formula","call"]],["<-","m",["match",["c","\"formula\"","\"data\"","\"subset\"","\"weights\"","\"na.action\""],["names","fcall"],"0"]],["<-","fcall",["[","fcall",["c","1","m"]]],["<-",["[[","fcall","1L"],["quote",["::","stats","model.frame"]]],["<-","env",["environment",["$","formula","terms"]]],["if",["is.null","env"],["<-","env",["parent.frame",{}]]],["return",["eval","fcall","env"]]]],["if",["missing","formula"],["{",["if",["&&",["&&",["!",["missing","data"]],["inherits","data","\"data.frame\""]],["length",["attr","data","\"terms\""]]],["return","data"]],["<-","formula",["as.formula","data"]]],["if",["&&",["missing","data"],["inherits","formula","\"data.frame\""]],["{",["if",["length",["attr","formula","\"terms\""]],["return","formula"]],["<-","data","formula"],["<-","formula",["as.formula","data"]]],["<-","formula",["as.formula","formula"]]]],["if",["missing","na.action"],["{",["if",["&",["!",["is.null",["<-","naa",["attr","data","\"na.action\""]]]],["!=",["mode","naa"],"\"numeric\""]],["<-","na.action","naa"],["if",["!",["is.null",["<-","naa",["getOption","\"na.action\""]]]],["<-","na.action","naa"]]]]],["if",["missing","data"],["<-","data",["environment","formula"]],["if",["&&",["&&",["!",["is.data.frame","data"]],["!",["is.environment","data"]]],["!",["is.null",["attr","data","\"class\""]]]],["<-","data",["as.data.frame","data"]],["if",["is.array","data"],["stop","\"'data' must be a data.frame, not a matrix or an array\""]]]],["if",["!",["inherits","formula","\"terms\""]],["<-","formula",["terms","formula",{"data":"data"}]]],["<-","env",["environment","formula"]],["<-","rownames",[".row_names_info","data","0L"]],["<-","vars",["attr","formula","\"variables\""]],["<-","predvars",["attr","formula","\"predvars\""]],["if",["is.null","predvars"],["<-","predvars","vars"]],["<-","varnames",["[",["vapply","vars","deparse2","\" \""],["-","1L"]]],["<-","variables",["eval","predvars","data","env"]],["<-","resp",["attr","formula","\"response\""]],["if",["&&",["is.null","rownames"],[">","resp","0L"]],["{",["<-","lhs",["[[","variables","resp"]],["<-","rownames",["if",["is.matrix","lhs"],["rownames","lhs"],["names","lhs"]]]]],["if",["&&","possible_newdata",["length","variables"]],["{",["<-","nr2",["max",["sapply","variables","NROW"]]],["if",["!=","nr2","nr"],["warning",["sprintf",["paste0",["ngettext","nr","\"'newdata' had %d row\"","\"'newdata' had %d rows\""],"\" \"",["ngettext","nr2","\"but variable found had %d row\"","\"but variables found have %d rows\""]],"nr","nr2"],{"call.":"FALSE"},{"domain":"NA"}]]]],["if",["is.null",["attr","formula","\"predvars\""]],["{",["for","i",["seq_along","varnames"],["<-",["[[","predvars",["+","i","1L"]],["makepredictcall",["[[","variables","i"],["[[","vars",["+","i","1L"]]]]],["<-",["attr","formula","\"predvars\""],"predvars"]]],["<-","extras",["substitute",["list","..."]]],["<-","extranames",["names",["[","extras",["-","1L"]]]],["<-","extras",["eval","extras","data","env"]],["<-","subset",["eval",["substitute","subset"],"data","env"]],["<-","data",[".External2","C_modelframe","formula","rownames","variables","varnames","extras","extranames","subset","na.action"]],["if",["length","xlev"],["{",["for","nm",["names","xlev"],["if",["!",["is.null",["<-","xl",["[[","xlev","nm"]]]],["{",["<-","xi",["[[","data","nm"]],["if",["is.character","xi"],["<-","xi",["as.factor","xi"]]],["if",["||",["!",["is.factor","xi"]],["is.null",["<-","nxl",["levels","xi"]]]],["warning",["gettextf","\"variable '%s' is not a factor\"","nm"],{"domain":"NA"}],["{",["<-","ctr",["attr","xi","\"contrasts\""]],["<-","xi",["[","xi",{},{"drop":"TRUE"}]],["<-","nxl",["levels","xi"]],["if",["any",["<-","m",["is.na",["match","nxl","xl"]]]],["stop",["sprintf",["ngettext",["length","m"],"\"factor %s has new level %s\"","\"factor %s has new levels %s\""],"nm",["paste",["[","nxl","m"],{"collapse":"\", \""}]],{"domain":"NA"}]],["<-",["[[","data","nm"],["factor","xi",{"levels":"xl"},{"exclude":"NULL"}]],["if",["!",["identical",["attr",["[[","data","nm"],"\"contrasts\""],"ctr"]],["warning",["gettext",["sprintf","\"contrasts dropped from factor %s\"","nm"],{"domain":"NA"}],{"call.":"FALSE"}]]]]]]]],["if","drop.unused.levels",["{",["for","nm",["names","data"],["{",["<-","x",["[[","data","nm"]],["if",["&&",["is.factor","x"],["<",["length",["unique",["[","x",["!",["is.na","x"]]]]],["length",["levels","x"]]]],["{",["<-","ctr",["attr","x","\"contrasts\""]],["<-",["[[","data","nm"],["[","x",{},{"drop":"TRUE"}]],["if",["!",["identical",["attr",["[[","data","nm"],"\"contrasts\""],"ctr"]],["warning",["gettext",["sprintf","\"contrasts dropped from factor %s due to missing levels\"","nm"],{"domain":"NA"}],{"call.":"FALSE"}]]]]]]]]],["<-",["attr","formula","\"dataClasses\""],["vapply","data",".MFclass","\"\""]],["<-",["attr","data","\"terms\""],"formula"],"data"]]],["<-","model.weights",["function",[{"x":""}],["$","x","\"(weights)\""]]],["<-","model.offset",["function",[{"x":""}],["{",["<-","offsets",["attr",["attr","x","\"terms\""],"\"offset\""]],["if",["length","offsets"],["{",["<-","ans",["$","x","\"(offset)\""]],["if",["is.null","ans"],["<-","ans","0"]],["for","i","offsets",["<-","ans",["+","ans",["[[","x","i"]]]],"ans"],["<-","ans",["$","x","\"(offset)\""]]],["if",["&&",["!",["is.null","ans"]],["!",["is.numeric","ans"]]],["stop","\"'offset' must be numeric\""]],"ans"]]],["<-","model.matrix",["function",[{"object":"","...":""}],["UseMethod","\"model.matrix\""]]],["<-","model.matrix.default",["function",[{"object":"","data":["environment","object"],"contrasts.arg":"NULL","xlev":"NULL","...":""}],["{",["<-","t",["if",["missing","data"],["terms","object"],["terms","object",{"data":"data"}]]],["if",["is.null",["attr","data","\"terms\""]],["<-","data",["model.frame","object","data",{"xlev":"xlev"}]],["{",["<-","reorder",["match",["[",["vapply",["attr","t","\"variables\""],"deparse2","\"\""],["-","1L"]],["names","data"]]],["if",["anyNA","reorder"],["stop","\"model frame and formula mismatch in model.matrix()\""]],["if",["!",["identical","reorder",["seq_len",["ncol","data"]]]],["<-","data",["[","data",{},"reorder",{"drop":"FALSE"}]]]]],["<-","int",["attr","t","\"response\""]],["if",["length","data"],["{",["<-","contr.funs",["as.character",["getOption","\"contrasts\""]]],["<-","namD",["names","data"]],["for","i","namD",["if",["is.character",["[[","data","i"]],["<-",["[[","data","i"],["factor",["[[","data","i"]]]]],["<-","isF",["vapply","data",["function",[{"x":""}],["||",["is.factor","x"],["is.logical","x"]]],"NA"]],["<-",["[","isF","int"],"FALSE"],["<-","isOF",["vapply","data","is.ordered","NA"]],["for","nn",["[","namD","isF"],["if",["is.null",["attr",["[[","data","nn"],"\"contrasts\""]],["<-",["contrasts",["[[","data","nn"]],["[","contr.funs",["+","1",["[","isOF","nn"]]]]]],["if",["!",["is.null","contrasts.arg"]],["{",["if",["!",["is.list","contrasts.arg"]],["warning","\"non-list contrasts argument ignored\""],["{",["if",["is.null",["<-","namC",["names","contrasts.arg"]]],["stop","\"'contrasts.arg' argument must be named\""]],["for","nn","namC",["{",["if",["is.na",["<-","ni",["match","nn","namD"]]],["warning",["gettextf","\"variable '%s' is absent, its contrast will be ignored\"","nn"],{"domain":"NA"}],["{",["<-","ca",["[[","contrasts.arg","nn"]],["if",["is.matrix","ca"],["<-",["contrasts",["[[","data","ni"],["ncol","ca"]],"ca"],["<-",["contrasts",["[[","data","ni"]],["[[","contrasts.arg","nn"]]]]]]]]]]]],["{",["<-","isF","FALSE"],["<-",["[[","data","\"x\""],["raw",["nrow","data"]]]]],["<-","ans",[".External2","C_modelmatrix","t","data"]],["if",["any","isF"],["<-",["attr","ans","\"contrasts\""],["lapply",["[","data","isF"],"attr","\"contrasts\""]]],"ans"]]],["<-","model.response",["function",[{"data":"","type":"\"any\""}],["{",["if",["attr",["attr","data","\"terms\""],"\"response\""],["{",["if",["|",["is.list","data"],["is.data.frame","data"]],["{",["<-","v",["[[","data","1L"]],["if",["&&",["==","type","\"numeric\""],["is.factor","v"]],["{",["warning","'using type = \"numeric\" with a factor response will be ignored'"]],["if",["|",["==","type","\"numeric\""],["==","type","\"double\""]],["<-",["storage.mode","v"],"\"double\""],["if",["!=","type","\"any\""],["stop","\"invalid response type\""]]]],["if",["&&",["is.matrix","v"],["==",["ncol","v"],"1L"]],["<-",["dim","v"],"NULL"]],["<-","rows",["attr","data","\"row.names\""]],["if",["<-","nrows",["length","rows"]],["{",["if",["==",["length","v"],"nrows"],["<-",["names","v"],"rows"],["if",["==",["length",["<-","dd",["dim","v"]]],"2L"],["if",["&&",["==",["[","dd","1L"],"nrows"],["!",["length",["[[",["(",["<-","dn",["dimnames","v"]]],"1L"]]]],["<-",["dimnames","v"],["list","rows",["[[","dn","2L"]]]]]]]],["return","v"]],["stop","\"invalid 'data' argument\""]]],["return","NULL"]]]]],["<-","model.extract",["function",[{"frame":"","component":""}],["{",["<-","component",["as.character",["substitute","component"]]],["<-","rval",["switch","component",{"response":["model.response","frame"]},{"offset":["model.offset","frame"]},["[[","frame",["paste0","\"(\"","component","\")\""]]]],["if",["!",["is.null","rval"]],["{",["if",["==",["length","rval"],["nrow","frame"]],["<-",["names","rval"],["attr","frame","\"row.names\""]],["if",["&&",["is.matrix","rval"],["==",["nrow","rval"],["nrow","frame"]]],["{",["<-","t1",["dimnames","rval"]],["<-",["dimnames","rval"],["list",["attr","frame","\"row.names\""],["[[","t1","2L"]]]]]]]],"rval"]]],["<-","preplot",["function",[{"object":"","...":""}],["UseMethod","\"preplot\""]]],["<-","update",["function",[{"object":"","...":""}],["UseMethod","\"update\""]]],["<-","is.empty.model",["function",[{"x":""}],["{",["<-","tt",["terms","x"]],["&",["(",["==",["length",["attr","tt","\"factors\""]],"0L"]],["(",["==",["attr","tt","\"intercept\""],"0L"]]]]]],["<-","makepredictcall",["function",[{"var":"","call":""}],["UseMethod","\"makepredictcall\""]]],["<-","makepredictcall.default",["function",[{"var":"","call":""}],["{",["if",["!=",["[",["as.character","call"],"1L"],"\"scale\""],["return","call"]],["if",["!",["is.null",["<-","z",["attr","var","\"scaled:center\""]]]],["<-",["$","call","center"],"z"]],["if",["!",["is.null",["<-","z",["attr","var","\"scaled:scale\""]]]],["<-",["$","call","scale"],"z"]],"call"]]],["<-",".getXlevels",["function",[{"Terms":"","m":""}],["{",["<-","xvars",["[",["vapply",["attr","Terms","\"variables\""],"deparse2","\"\""],["-","1L"]]],["if",[">",["(",["<-","yvar",["attr","Terms","\"response\""]]],"0"],["<-","xvars",["[","xvars",["-","yvar"]]]],["if",["length","xvars"],["{",["<-","xlev",["lapply",["[","m","xvars"],["function",[{"x":""}],["if",["is.factor","x"],["levels","x"],["if",["is.character","x"],["levels",["as.factor","x"]]]]]]],["[","xlev",["!",["vapply","xlev","is.null","NA"]]]]]]]],["<-","get_all_vars",["function",[{"formula":"","data":"NULL","...":""}],["{",["if",["missing","formula"],["{",["if",["&&",["&&",["!",["missing","data"]],["inherits","data","\"data.frame\""]],["length",["attr","data","\"terms\""]]],["return","data"]],["<-","formula",["as.formula","data"]]],["if",["&&",["missing","data"],["inherits","formula","\"data.frame\""]],["{",["if",["length",["attr","formula","\"terms\""]],["return","formula"]],["<-","data","formula"],["<-","formula",["as.formula","data"]]]]],["<-","formula",["as.formula","formula"]],["if",["missing","data"],["<-","data",["environment","formula"]],["if",["&&",["&&",["!",["is.data.frame","data"]],["!",["is.environment","data"]]],["!",["is.null",["attr","data","\"class\""]]]],["<-","data",["as.data.frame","data"]],["if",["is.array","data"],["stop","\"'data' must be a data.frame, not a matrix or an array\""]]]],["if",["!",["inherits","formula","\"terms\""]],["<-","formula",["terms","formula",{"data":"data"}]]],["<-","env",["environment","formula"]],["<-","rownames",[".row_names_info","data","0L"]],["<-","varnames",["all.vars","formula"]],["<-","variables",["lapply",["lapply","varnames","as.name"],"eval","data","env"]],["if",["&&",["is.null","rownames"],[">",["(",["<-","resp",["attr","formula","\"response\""]]],"0"]],["{",["<-","lhs",["[[","variables","resp"]],["<-","rownames",["if",["&&",["!",["is.null",["<-","d",["dim","lhs"]]]],["==",["length","d"],"2L"]],["{",["if",["is.data.frame","lhs"],[".row_names_info","lhs","0L"],["rownames","lhs"]]],["names","lhs"]]]]],["<-","extras",["substitute",["list","..."]]],["<-","extranames",["names",["[","extras",["-","1L"]]]],["<-","extras",["eval","extras","data","env"]],["<-","x",["c","variables","extras"]],["if",["<-","anyM",["any",["<-","isM",["vapply","x",["function",[{"o":""}],["&&",["is.matrix","o"],["!",["inherits","o","\"AsIs\""]]]],"NA"]]]],["<-",["[","x","isM"],["lapply",["[","x","isM"],"I"]]],["<-","nms.x",["c","varnames","extranames"]],["if",["any",["vapply","x","is.data.frame","NA"]],["<-","nms.x",["unlist",["lapply",["seq_along","x"],["function",[{"i":""}],["if",["is.list",["[[","x","i"]],["names",["[[","x","i"]],["[[","nms.x","i"]]]]]]],["<-","x",["as.data.frame","x",{"optional":"TRUE"}]],["<-",["names","x"],"nms.x"],["if","anyM",["<-",["[","x","isM"],["lapply",["[","x","isM"],["function",[{"o":""}],["`class<-`","o",["[",["class","o"],["!=",["class","o"],"\"AsIs\""]]]]]]],["<-",["attr","x","\"row.names\""],["if",["is.null","rownames"],[".set_row_names",["max",["vapply","x","NROW",["integer","1"]]]],"rownames"]],"x"]]]]
